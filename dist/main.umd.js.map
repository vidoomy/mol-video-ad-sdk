{"version":3,"file":"main.umd.js","sources":["../node_modules/regenerator-runtime/runtime.js","../node_modules/regenerator-runtime/runtime-module.js","../node_modules/babel-runtime/regenerator/index.js","../src/adContainer/helpers/unique.js","../src/tracker/linearEvents.js","../src/tracker/nonLinearEvents.js","../node_modules/sane-domparser-error/index.js","../src/xml/helpers/xmlToJson.js","../src/xml/helpers/xmlSelectors.js","../src/xml/index.js","../src/xml/helpers/xml2js.js","../src/vastSelectors/helpers/parseTime.js","../src/vastSelectors/helpers/parseOffset.js","../src/vastSelectors/helpers/getLinearCreative.js","../src/vastSelectors/getLinearTrackingEvents.js","../src/vastSelectors/getNonLinearTrackingEvents.js","../src/vastSelectors/getIcons.js","../src/vastSelectors/index.js","../src/tracker/helpers/parseMacro.js","../src/tracker/helpers/pixelTracker.js","../src/tracker/helpers/trackError.js","../src/tracker/helpers/createVastEventTracker.js","../src/tracker/trackLinearEvent.js","../src/tracker/helpers/trackIconClick.js","../src/tracker/helpers/trackIconView.js","../src/tracker/helpers/trackProgress.js","../src/tracker/trackNonLinearEvent.js","../src/adContainer/helpers/loadScript.js","../src/adContainer/helpers/createAdVideoElement.js","../src/adContainer/helpers/createAdContainer.js","../src/adContainer/helpers/getContentDocument.js","../src/adContainer/helpers/supportsSrcdoc.js","../src/adContainer/helpers/createIframe.js","../src/adContainer/helpers/getOrigin.js","../src/adContainer/VideoAdContainer.js","../src/adContainer/createVideoAdContainer.js","../src/adUnit/helpers/media/canPlay.js","../src/adUnit/helpers/media/guessMimeType.js","../src/adUnit/helpers/media/findBestMedia.js","../src/adUnit/helpers/media/sortMediaByBestFit.js","../src/adUnit/helpers/dom/once.js","../src/adUnit/helpers/progress/getProgressEvents.js","../src/adUnit/helpers/safeCallback.js","../src/adUnit/helpers/metrics/handlers/onFullscreenChange.js","../src/adUnit/helpers/metrics/handlers/onPlayPause.js","../src/adUnit/helpers/metrics/handlers/onRewind.js","../src/adUnit/helpers/metrics/handlers/onSkip.js","../src/adUnit/helpers/metrics/handlers/onError.js","../src/adUnit/adUnitEvents.js","../src/adUnit/helpers/metrics/handlers/onTimeUpdate.js","../src/adUnit/helpers/metrics/handlers/onVolumeChange.js","../src/adUnit/helpers/metrics/handlers/onImpression.js","../src/adUnit/helpers/progress/toFixedDigits.js","../src/adUnit/helpers/metrics/handlers/onProgress.js","../src/adUnit/helpers/metrics/handlers/onClickThrough.js","../src/adUnit/helpers/metrics/handlers/index.js","../src/adUnit/helpers/progress/formatProgress.js","../src/adUnit/helpers/metrics/setupMetricHandlers.js","../src/adUnit/helpers/media/updateMedia.js","../node_modules/lodash.debounce/index.js","../src/adUnit/helpers/dom/elementObservers/helpers/MutationObserver.js","../src/adUnit/helpers/dom/elementObservers/onElementResize.js","../src/adUnit/helpers/dom/elementObservers/onElementVisibilityChange.js","../src/adUnit/helpers/dom/elementObservers/helpers/isElementVisible.js","../src/adUnit/helpers/dom/preventManualProgress.js","../src/adUnit/helpers/Emitter/index.js","../src/adUnit/helpers/resources/getResource.js","../src/adUnit/helpers/icons/retrieveIcons.js","../src/adUnit/helpers/dom/waitFor.js","../node_modules/whatwg-fetch/fetch.js","../src/adUnit/helpers/fetch/fetchHtml.js","../src/adUnit/helpers/resources/createResource.js","../src/adUnit/helpers/resources/createStaticResource.js","../src/adUnit/helpers/resources/createHtmlResource.js","../src/adUnit/helpers/resources/createIframeResource.js","../src/adUnit/helpers/resources/loadResource.js","../src/adUnit/helpers/icons/updateIcon.js","../src/adUnit/helpers/icons/canBeRendered.js","../src/adUnit/helpers/icons/renderIcon.js","../src/adUnit/helpers/icons/renderIcons.js","../src/adUnit/helpers/icons/canBeShown.js","../src/adUnit/helpers/icons/addIcons.js","../src/adUnit/helpers/vpaid/viewmode.js","../src/adUnit/VideoAdUnit.js","../src/adUnit/VastAdUnit.js","../src/adUnit/helpers/vpaid/isSupported.js","../src/adUnit/helpers/vpaid/loadCreative.js","../src/adUnit/helpers/vpaid/api.js","../src/adUnit/helpers/vpaid/waitFor.js","../src/adUnit/helpers/vpaid/callAndWait.js","../src/adUnit/helpers/vpaid/handshake.js","../src/adUnit/helpers/vpaid/initAd.js","../src/adUnit/VpaidAdUnit.js","../src/adUnit/createVideoAdUnit.js","../src/runner/helpers/startVideoAd.js","../src/runner/run.js","../src/vastRequest/helpers/fetch.js","../src/vastRequest/helpers/adUtils.js","../src/vastRequest/requestAd.js","../src/vastRequest/helpers/getNextAd.js","../src/vastRequest/requestNextAd.js","../src/runner/runWaterfall.js","../src/vastChain/getDetails.js","../src/utils/isIOS.js"],"sourcesContent":["/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n!(function(global) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  var inModule = typeof module === \"object\";\n  var runtime = global.regeneratorRuntime;\n  if (runtime) {\n    if (inModule) {\n      // If regeneratorRuntime is defined globally and we're in a module,\n      // make the exports object identical to regeneratorRuntime.\n      module.exports = runtime;\n    }\n    // Don't bother evaluating the rest of this file if the runtime was\n    // already defined globally.\n    return;\n  }\n\n  // Define the runtime globally (as expected by generated code) as either\n  // module.exports (if we're in a module) or a new, empty object.\n  runtime = global.regeneratorRuntime = inModule ? module.exports : {};\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  runtime.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  runtime.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  runtime.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = \"GeneratorFunction\";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  runtime.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return Promise.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return Promise.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration. If the Promise is rejected, however, the\n          // result for this iteration will be rejected with the same\n          // reason. Note that rejections of yielded Promises are not\n          // thrown back into the generator function, as is the case\n          // when an awaited Promise is rejected. This difference in\n          // behavior between yield and await is important, because it\n          // allows the consumer to decide what to do with the yielded\n          // rejection (swallow it and continue, manually .throw it back\n          // into the generator, abandon iteration, whatever). With\n          // await, by contrast, there is no opportunity to examine the\n          // rejection reason outside the generator function, so the\n          // only option is to throw it from the await expression, and\n          // let the generator function handle the exception.\n          result.value = unwrapped;\n          resolve(result);\n        }, reject);\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new Promise(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  runtime.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  runtime.async = function(innerFn, outerFn, self, tryLocsList) {\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList)\n    );\n\n    return runtime.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        if (delegate.iterator.return) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = \"Generator\";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  runtime.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  runtime.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n})(\n  // In sloppy mode, unbound `this` refers to the global object, fallback to\n  // Function constructor if we're in global strict mode. That is sadly a form\n  // of indirect eval which violates Content Security Policy.\n  (function() { return this })() || Function(\"return this\")()\n);\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n// This method of obtaining a reference to the global object needs to be\n// kept identical to the way it is obtained in runtime.js\nvar g = (function() { return this })() || Function(\"return this\")();\n\n// Use `getOwnPropertyNames` because not all browsers support calling\n// `hasOwnProperty` on the global `self` object in a worker. See #183.\nvar hadRuntime = g.regeneratorRuntime &&\n  Object.getOwnPropertyNames(g).indexOf(\"regeneratorRuntime\") >= 0;\n\n// Save the old regeneratorRuntime in case it needs to be restored later.\nvar oldRuntime = hadRuntime && g.regeneratorRuntime;\n\n// Force reevalutation of runtime.js.\ng.regeneratorRuntime = undefined;\n\nmodule.exports = require(\"./runtime\");\n\nif (hadRuntime) {\n  // Restore the original runtime.\n  g.regeneratorRuntime = oldRuntime;\n} else {\n  // Remove the global property added by runtime.js.\n  try {\n    delete g.regeneratorRuntime;\n  } catch(e) {\n    g.regeneratorRuntime = undefined;\n  }\n}\n","module.exports = require(\"regenerator-runtime\");\n","/**\n * unique will create a unique string every time is called, sequentially and namespaced\n *\n * @ignore\n * @param {string} namespace\n */\nconst unique = (namespace) => {\n  let count = -1;\n\n  return function () {\n    return namespace + '_' + ++count;\n  };\n};\n\nexport default unique;\n","/**\n * Interface for classes that may emit linear VAST events.\n *\n * @interface LinearEvents\n */\n\n/**\n * Fires when the the creative was played to the end at normal speed so that 100% of the creative was played.\n *\n * @event LinearEvents#complete\n */\nexport const complete = 'complete';\n\n/**\n * Fires when a user clicks the ad.\n *\n * @event LinearEvents#clickThrough\n */\nexport const clickThrough = 'clickThrough';\n\n/**\n * Fires when there was an error with the linear creative.\n *\n * @event LinearEvents#error\n */\nexport const error = 'error';\n\n/**\n * Fires when the creative played continuously for at least 25% of the total duration at normal speed.\n *\n * @event LinearEvents#firstQuartile\n */\nexport const firstQuartile = 'firstQuartile';\n\n/**\n * Fires when there was an impression of the linear creative.\n *\n * @event LinearEvents#impression\n */\nexport const impression = 'impression';\n\n/**\n * Fires when the creative played continuously for at least 50% of the total duration at normal speed.\n *\n * @event LinearEvents#midpoint\n */\nexport const midpoint = 'midpoint';\n\n/**\n * Fires when the user activated the mute control and muted the creative.\n *\n * @event LinearEvents#mute\n */\nexport const mute = 'mute';\n\n/**\n * Optional metric that can capture all other user interactions under one metric such a s hover-overs, or custom clicks. It should NOT replace clickthrough events or other existing events like mute, unmute, pause, etc.\n *\n * @event LinearEvents#otherAdInteraction\n */\nexport const otherAdInteraction = 'otherAdInteraction';\n\n/**\n * Fires when the user clicked the pause control and stopped the creative.\n *\n * @event LinearEvents#pause\n */\nexport const pause = 'pause';\n\n/**\n * Fires when the user activated a control to reduce player to a smaller size. This event replaces the exitFullscreen event per the 2014 Digital Video In-Stream Ad Metric Definitions.\n *\n * @event LinearEvents#playerCollapse\n */\nexport const playerCollapse = 'playerCollapse';\n\n/**\n * Fires when the user activated a control to reduce player to a smaller size.\n *\n * @event LinearEvents#exitFullscreen\n */\nexport const exitFullscreen = 'exitFullscreen';\n\n/**\n * Fires when the user activated a control to extend the player to a larger size. This event replaces the fullscreen event per the 2014 Digital Video In-Stream Ad Metric Definitions.\n *\n * @event LinearEvents#playerExpand\n */\nexport const playerExpand = 'playerExpand';\n\n/**\n * Fires when the user activated a control to extend the player to a larger size. Only for VAST 3.\n *\n * @event LinearEvents#fullscreen\n */\nexport const fullscreen = 'fullscreen';\n\n/**\n * Fires when the creative played for a duration at normal speed that is equal to or greater than the value provided in an additional offset attribute for the <Tracking> element under Linear ads. Values can be time in the format HH:MM:SS or HH:MM:SS.mmm or a percentage value in the format n%.\n *\n * @event LinearEvents#progress\n */\nexport const progress = 'progress';\n\n/**\n * Fires when the user activated the resume control after the creative had been stopped or paused.\n *\n * @event LinearEvents#resume\n */\nexport const resume = 'resume';\n\n/**\n * Fires when the user activated the rewind control to access a previous point in the creative timeline.\n *\n * @event LinearEvents#rewind\n */\nexport const rewind = 'rewind';\n\n/**\n * Fires when the user activated a skip control to skip the creative.\n *\n * @event LinearEvents#skip\n */\nexport const skip = 'skip';\n\n/**\n * This event is used to indicate that an individual creative within the ad was loaded and playback began. As with creativeView, this event is another way of tracking creative playback.\n *\n * @event LinearEvents#start\n */\nexport const start = 'start';\n\n/**\n * Fires when the creative played continuously for at least 75% of the duration at normal speed.\n *\n * @event LinearEvents#thirdQuartile\n */\nexport const thirdQuartile = 'thirdQuartile';\n\n/**\n * Amount of video viewed at normal speed in seconds or other appropriate time-based units. If a rewind event occurs during play, time spent viewing may be calculated on total amount of video viewed at normal speed, which may include additional amounts of video viewed after rewinding. The offset attribute for the <Tracking> element under Linear ads may be used to track when time spent viewing meets the threshold. Otherwise, a macro may be provided so that the player may return a time value. VAST does not provide a standard macro for this value, so the involved parties must establish these parameters if this metric is to be used.\n *\n * @event LinearEvents#timeSpentViewing\n */\nexport const timeSpentViewing = 'timeSpentViewing';\n\n/**\n * Fires when the user activated the mute control and unmuted the creative.\n *\n * @event LinearEvents#unmute\n */\nexport const unmute = 'unmute';\n\n/**\n * Fires when the user clicked the creative icon.\n *\n * @event LinearEvents#iconClick\n */\nexport const iconClick = 'iconClick';\n\n/**\n * Fires when the user viewed the creative icon.\n *\n * @event LinearEvents#iconView\n */\nexport const iconView = 'iconView';\n\n/**\n * The viewer has chosen to close the linear ad unit. This is currently inuse by some of the largest mobile SDKs to mark the dismissal of the end card companion that follows the video, as well as a close of the video itself, if applicable\n *\n * @event LinearEvents#closeLinear\n */\nexport const closeLinear = 'closeLinear';\n\nconst linearEvents = {\n  clickThrough,\n  closeLinear,\n  complete,\n  error,\n  exitFullscreen,\n  firstQuartile,\n  fullscreen,\n  iconClick,\n  iconView,\n  impression,\n  midpoint,\n  mute,\n  otherAdInteraction,\n  pause,\n  playerCollapse,\n  playerExpand,\n  progress,\n  resume,\n  rewind,\n  skip,\n  start,\n  thirdQuartile,\n  timeSpentViewing,\n  unmute\n};\n\nexport default linearEvents;\n","/**\n * Interface for classes that may emit non linear VAST events.\n *\n * @interface NonLinearEvents\n */\n\n/**\n * Fires when the user clicked or otherwise activated a control used to pause streaming content, which either expands the ad within the player’s viewable area or “takes-over” the streaming content area by launching an additional portion of the ad.\n *\n * @event NonLinearEvents#acceptInvitation\n */\nexport const acceptInvitation = 'acceptInvitation';\n\n/**\n * Fires when the user clicked or otherwise activated a control used to pause streaming content, which either expands the ad within the player’s viewable area or “takes-over” the streaming content area by launching an additional portion of the ad.\n *\n * @event NonLinearEvents#adCollapse\n */\nexport const adCollapse = 'adCollapse';\n\n/**\n * Not to be confused with an impression, this event indicates that an individual creative portion of the ad was viewed.\n *\n * @event NonLinearEvents#creativeView\n */\nexport const creativeView = 'creativeView';\n\n/**\n * Fires when the user clicked or otherwise activated a control for removing the ad.\n *\n * @event NonLinearEvents#close\n */\nexport const close = 'close';\n\nconst nonLinearEvents = {\n  acceptInvitation,\n  adCollapse,\n  close,\n  creativeView\n};\n\nexport default nonLinearEvents;\n","'use strict';\n\nvar innerXML = function (node) {\n    var s = new XMLSerializer();\n    return Array.prototype.map.call(node.childNodes, function (node) {\n        return s.serializeToString(node);\n    }).join('');\n};\n\nvar getParseError = function (doc) {\n    // Firefox\n    if (doc.documentElement.tagName === 'parsererror' &&\n        doc.documentElement.namespaceURI === 'http://www.mozilla.org/newlayout/xml/parsererror.xml') {\n        return doc.documentElement;\n    }\n\n    // Chrome, Safari\n    if ((doc.documentElement.tagName === 'xml' || doc.documentElement.tagName === 'html') &&\n        doc.documentElement.childNodes &&\n        doc.documentElement.childNodes.length > 0 &&\n        doc.documentElement.childNodes[0].nodeName === 'parsererror') {\n        return doc.documentElement.childNodes[0];\n    }\n\n    // PhantomJS\n    if (doc.documentElement.tagName === 'html' &&\n        doc.documentElement.childNodes &&\n        doc.documentElement.childNodes.length > 0 &&\n        doc.documentElement.childNodes[0].nodeName === 'body' &&\n        doc.documentElement.childNodes[0].childNodes &&\n        doc.documentElement.childNodes[0].childNodes.length &&\n        doc.documentElement.childNodes[0].childNodes[0].nodeName === 'parsererror') {\n        return doc.documentElement.childNodes[0].childNodes[0];\n    }\n\n    return undefined;\n};\n\nvar errorMessagePatterns = [\n    // Chrome, Safari, PhantomJS\n    new RegExp('^<h3[^>]*>This page contains the following errors:<\\/h3><div[^>]*>(.+?)\\n?<\\/div>'),\n    // Firefox\n    new RegExp('^(.+)\\n')\n];\n\nvar extractParseError = function (errorNode) {\n    var content = innerXML(errorNode);\n    var i, match;\n\n    for(i = 0; i < errorMessagePatterns.length; i++) {\n        match = errorMessagePatterns[i].exec(content);\n\n        if (match) {\n            return match[1];\n        }\n    }\n    return undefined;\n};\n\nvar failOnParseError = function (doc) {\n    var errorMessage;\n\n    if (doc === null) {\n        throw new Error('Parse error');\n    }\n\n    var parseError = getParseError(doc);\n    if (parseError !== undefined) {\n        errorMessage = extractParseError(parseError) || 'Parse error';\n        throw new Error(errorMessage);\n    }\n};\n\nexports.failOnParseError = function (doc) {\n    failOnParseError(doc);\n\n    return doc;\n};\n","const TYPE = {\n  CDATA: 'cdata',\n  DOCUMENT: 'document',\n  ELEMENT: 'element',\n  TEXT: 'text'\n};\n\nconst nodeType = (node) => {\n  if (node.nodeType === 1) {\n    return TYPE.ELEMENT;\n  }\n\n  if (node.nodeType === 3 || node.nodeType === 4) {\n    return TYPE.TEXT;\n  }\n\n  if (node.nodeType === 9) {\n    return TYPE.DOCUMENT;\n  }\n\n  throw new Error('Unsupported element type');\n};\n\nconst xmlToJson = (node) => {\n  const type = nodeType(node);\n\n  const obj = {\n    type\n  };\n\n  if (type === TYPE.ELEMENT) {\n    obj.name = node.nodeName.toLowerCase();\n\n    if (node.attributes.length > 0) {\n      obj.attributes = {};\n      for (const attribute of Array.from(node.attributes)) {\n        obj.attributes[attribute.nodeName] = attribute.nodeValue;\n      }\n    }\n  } else if (type === TYPE.TEXT) {\n    obj.text = node.nodeValue\n      .replace('<![CDATA[', '')\n      .replace(']]>', '')\n      .trim();\n  }\n\n  // do children\n  if (node.hasChildNodes()) {\n    const childNodes = Array.from(node.childNodes).filter((childNode) => [1, 3, 4].includes(childNode.nodeType));\n    const elements = [];\n\n    obj.elements = elements;\n\n    for (const childNode of childNodes) {\n      const childObj = xmlToJson(childNode);\n\n      if (childObj.type !== TYPE.TEXT || childObj.text.length > 0) {\n        elements.push(childObj);\n      }\n    }\n  }\n\n  return obj;\n};\n\nexport default xmlToJson;\n","const getChildren = ({elements = []} = {}) => elements;\n\nconst findChildByName = (element, childName) =>\n  getChildren(element).find(({name = ''}) => name.toUpperCase() === childName.toUpperCase());\n\nconst filterChildrenByName = (element, childrenName) =>\n  getChildren(element).filter(({name = ''}) => name.toUpperCase() === childrenName.toUpperCase());\n\n/**\n * Get the first child element from the passed parsed xml element.\n *\n * @memberof module:@mailonline/vast-xml2js\n * @param {Object} element - Parsed xml element object.\n * @param {string} childName - Child element name\n * @returns {Object|undefined} - the first child element with the passed name or undefined if not found.\n */\nexport const get = findChildByName;\n\n/**\n * Get all the children elements of the passed parsed xml element filtered by the passed child name if passed.\n *\n * @memberof module:@mailonline/vast-xml2js\n * @param {Object} element - Parsed xml element object.\n * @param {string} [childName] - Child element name.\n * @returns {Array} - Array of child elements or an empty array.\n */\nexport const getAll = (element, childName) => {\n  if (typeof childName === 'string') {\n    return filterChildrenByName(element, childName);\n  }\n\n  return getChildren(element);\n};\n\n/**\n * Get the first child element from the passed parsed xml element.\n *\n * @memberof module:@mailonline/vast-xml2js\n * @returns {Object|null} - the first child element or undefined if there are non.\n */\nexport const getFirstChild = (element) => getChildren(element)[0] || null;\n\n/**\n * Get the text value of the passed parsed xml element or null if there is non.\n *\n * @memberof module:@mailonline/vast-xml2js\n * @returns {string|null} - text of the element or null.\n */\nexport const getText = (element) => {\n  const firstChild = element && getFirstChild(element);\n\n  return firstChild && firstChild.text || null;\n};\n\n/**\n * Get all the attributes of the passed parsed xml element.\n *\n * @memberof module:@mailonline/vast-xml2js\n * @returns {Object} - Object with the element attributes.\n */\nexport const getAttributes = ({attributes = {}} = {}) => attributes;\n\n/**\n * Get the attribute with the passed name of the passed parsed xml element.\n *\n * @memberof module:@mailonline/vast-xml2js\n * @returns {number|string|undefined} - Attribute value or undefined.\n */\nexport const getAttribute = (element, attributeName) => getAttributes(element)[attributeName];\n","import xml2js from './helpers/xml2js';\nimport {\n  get,\n  getAll,\n  getFirstChild,\n  getText,\n  getAttributes,\n  getAttribute\n} from './helpers/xmlSelectors';\n\nconst parser = new DOMParser();\n\n/**\n * Parses the passed xml text.\n *\n * @global\n * @typedef parseXml\n * @throws if there is an error parsing the xml.\n * @param {string} xmlText - XML text to be parsed.\n * @returns {Object} - Returns the parsed xml document as a js object.\n * @static\n */\nconst parseXml = (xmlText) => xml2js(parser, xmlText);\n\nexport {\n  get,\n  getAll,\n  getFirstChild,\n  getText,\n  getAttributes,\n  getAttribute,\n  parseXml\n};\n","/* eslint-disable filenames/match-regex, id-match */\nimport saneError from 'sane-domparser-error';\nimport xmlToJson from './xmlToJson';\n\nconst xml2js = (parser, xmlText) => {\n  const xmlDom = parser.parseFromString(xmlText, 'application/xml');\n\n  saneError.failOnParseError(xmlDom);\n\n  return xmlToJson(xmlDom);\n};\n\nexport default xml2js;\n","const parseHoursToMs = (hourStr) => parseInt(hourStr, 10) * 60 * 60 * 1000;\nconst parseMinToMs = (minStr) => parseInt(minStr, 10) * 60 * 1000;\nconst parseSecToMs = (secStr) => parseInt(secStr, 10) * 1000;\nconst parseTime = (durationStr) => {\n  if (typeof durationStr === 'string') {\n    const durationRegex = /(\\d\\d):(\\d\\d):(\\d\\d)(\\.(\\d\\d\\d))?/;\n    const match = durationStr.match(durationRegex);\n\n    if (match) {\n      const durationInMs = parseHoursToMs(match[1]) + parseMinToMs(match[2]) + parseSecToMs(match[3]) + parseInt(match[5] || 0, 10);\n\n      if (!isNaN(durationInMs)) {\n        return durationInMs;\n      }\n    }\n  }\n\n  return null;\n};\n\nexport default parseTime;\n","import parseTime from './parseTime';\n\nconst isPercentage = (offset) => {\n  const percentageRegex = /^\\d+(\\.\\d+)?%$/g;\n\n  return percentageRegex.test(offset);\n};\n\nconst parseOffset = (offset) => {\n  if (isPercentage(offset)) {\n    return offset;\n  }\n\n  return parseTime(offset);\n};\n\nexport default parseOffset;\n","import {\n  get,\n  getAll,\n  getFirstChild\n} from '../../xml';\n\nconst getLinearCreative = (ad) => {\n  const adTypeElement = getFirstChild(ad);\n  const creativesElement = adTypeElement && get(adTypeElement, 'creatives');\n  const hasLinear = (creative) => get(creative, 'linear');\n\n  return creativesElement && getAll(creativesElement).find(hasLinear) || null;\n};\n\nexport default getLinearCreative;\n","import {\n  get,\n  getAll,\n  getText,\n  getAttributes\n} from '../xml';\nimport parseOffset from './helpers/parseOffset';\nimport getLinearCreative from './helpers/getLinearCreative';\n\nconst getLinearTrackingEvents = (ad, eventName) => {\n  const creativeElement = ad && getLinearCreative(ad);\n\n  if (creativeElement) {\n    const linearElement = get(creativeElement, 'Linear');\n    const trackingEventsElement = linearElement && get(linearElement, 'TrackingEvents');\n    const trackingEventElements = trackingEventsElement && getAll(trackingEventsElement, 'Tracking');\n\n    if (trackingEventElements && trackingEventElements.length > 0) {\n      const trackingEvents = trackingEventElements.map((trackingEventElement) => {\n        const {event, offset} = getAttributes(trackingEventElement);\n        const uri = getText(trackingEventElement);\n\n        return {\n          event,\n          offset: offset && parseOffset(offset),\n          uri\n        };\n      });\n\n      if (eventName) {\n        const filteredEvents = trackingEvents.filter(({event}) => event === eventName);\n\n        if (filteredEvents.length > 0) {\n          return filteredEvents;\n        }\n      } else {\n        return trackingEvents;\n      }\n    }\n  }\n\n  return null;\n};\n\nexport default getLinearTrackingEvents;\n","import {\n  get,\n  getAll,\n  getText,\n  getAttributes\n} from '../xml';\nimport getLinearCreative from './helpers/getLinearCreative';\n\nconst getNonLinearTrackingEvents = (ad, eventName) => {\n  const creativeElement = ad && getLinearCreative(ad);\n\n  if (creativeElement) {\n    const NonLinearAdsElement = get(creativeElement, 'NonLinearAds');\n    const trackingEventsElement = NonLinearAdsElement && get(NonLinearAdsElement, 'TrackingEvents');\n    const trackingEventElements = trackingEventsElement && getAll(trackingEventsElement, 'Tracking');\n\n    if (trackingEventElements && trackingEventElements.length > 0) {\n      const trackingEvents = trackingEventElements.map((trackingEventElement) => {\n        const {event} = getAttributes(trackingEventElement);\n        const uri = getText(trackingEventElement);\n\n        return {\n          event,\n          uri\n        };\n      });\n\n      if (eventName) {\n        const filteredEvents = trackingEvents.filter(({event}) => event === eventName);\n\n        if (filteredEvents.length > 0) {\n          return filteredEvents;\n        }\n      } else {\n        return trackingEvents;\n      }\n    }\n  }\n\n  return null;\n};\n\nexport default getNonLinearTrackingEvents;\n","import {\n  get,\n  getAll,\n  getText,\n  getAttributes\n} from '../xml';\nimport getLinearCreative from './helpers/getLinearCreative';\nimport parseTime from './helpers/parseTime';\n\nconst formatSize = (size) => {\n  const match = `${size}`.match(/\\d+/g);\n\n  return parseInt(match[0], 10);\n};\n\nconst formatPosition = (position) => {\n  const isNumberString = /\\d+/.test(position);\n\n  if (isNumberString) {\n    return formatSize(position);\n  }\n\n  return position;\n};\n\nconst getIconAttributes = (iconElement) => {\n  const {\n    duration,\n    height,\n    offset,\n    program,\n    pxratio,\n    width,\n    xPosition = 'right',\n    yPosition = 'top'\n  } = getAttributes(iconElement);\n\n  return {\n    duration: duration && parseTime(duration),\n    height: height && formatSize(height),\n    offset: offset && parseTime(offset),\n    program,\n    pxratio: pxratio && parseInt(pxratio, 10),\n    width: width && formatSize(width),\n    xPosition: xPosition && formatPosition(xPosition),\n    yPosition: yPosition && formatPosition(yPosition)\n  };\n};\n\nconst getIconResource = (iconElement) => {\n  const staticResourceElement = get(iconElement, 'StaticResource');\n  const htmlResourceElement = get(iconElement, 'HTMLResource');\n  const iFrameResourceElement = get(iconElement, 'IFrameResource');\n\n  if (staticResourceElement) {\n    return {staticResource: getText(staticResourceElement)};\n  }\n\n  if (htmlResourceElement) {\n    return {htmlResource: getText(htmlResourceElement)};\n  }\n\n  if (iFrameResourceElement) {\n    return {iFrameResource: getText(iFrameResourceElement)};\n  }\n\n  return {\n    staticResource: getText(iconElement)\n  };\n};\n\nconst getIconViewTracking = (iconElement) => {\n  const iconTrackingElements = getAll(iconElement, 'IconViewTracking')\n    .map((iconViewTrackingElement) => getText(iconViewTrackingElement));\n\n  if (iconTrackingElements.length === 0) {\n    return {};\n  }\n\n  return {\n    iconViewTracking: iconTrackingElements\n  };\n};\n\nconst getIconClicks = (iconElement) => {\n  const iconClicksElement = get(iconElement, 'IconClicks');\n  const iconClickThroughElement = iconClicksElement && get(iconClicksElement, 'IconClickThrough');\n  const iconClickTrackingElements = iconClicksElement && getAll(iconClicksElement, 'IconClickTracking')\n    .map((iconClickTrackingElement) => getText(iconClickTrackingElement));\n\n  return {\n    iconClickThrough: iconClickThroughElement && getText(iconClickThroughElement),\n    iconClickTracking: iconClickTrackingElements && iconClickTrackingElements.length > 0 ? iconClickTrackingElements : undefined\n  };\n};\n\nconst getIcons = (ad) => {\n  const linearCreativeElement = ad && getLinearCreative(ad);\n  const linearElement = linearCreativeElement && get(linearCreativeElement, 'linear');\n  const iconsElement = linearElement && get(linearElement, 'Icons');\n  const iconElements = iconsElement && getAll(iconsElement, 'Icon');\n\n  if (iconElements && iconElements.length > 0) {\n    return iconElements.map((iconElement) => ({\n      ...getIconAttributes(iconElement),\n      ...getIconResource(iconElement),\n      ...getIconViewTracking(iconElement),\n      ...getIconClicks(iconElement)\n    }));\n  }\n\n  return null;\n};\n\nexport default getIcons;\n","/**\n * @memberof module:@mailonline/video-ad-sdk\n * @description Published as part of {@link module:@mailonline/video-ad-sdk}\n * @module vastSelectors\n */\nimport {\n  get,\n  getAll,\n  getFirstChild,\n  getText,\n  getAttributes,\n  getAttribute\n} from '../xml';\nimport parseOffset from './helpers/parseOffset';\nimport getLinearCreative from './helpers/getLinearCreative';\nimport getLinearTrackingEvents from './getLinearTrackingEvents';\nimport getNonLinearTrackingEvents from './getNonLinearTrackingEvents';\nimport getIcons from './getIcons';\n\nconst getBooleanValue = (val) => {\n  if (typeof val === 'string') {\n    return val === 'true';\n  }\n\n  return Boolean(val);\n};\n\nconst compareBySequence = (itemA, itemB) => {\n  const itemASequence = parseInt(getAttribute(itemA, 'sequence'), 10);\n  const itemBSequence = parseInt(getAttribute(itemB, 'sequence'), 10);\n\n  if (itemASequence < itemBSequence) {\n    return -1;\n  }\n\n  if (itemASequence > itemBSequence) {\n    return 1;\n  }\n\n  return 0;\n};\n\n/**\n * Selects the ads of the passed VAST.\n *\n * @function\n * @param {ParsedVast} parsedVAST - Parsed VAST xml.\n * @returns {?Array} - Array of ads or empty array.\n * @static\n */\nexport const getAds = (parsedVAST) => {\n  const vastElement = parsedVAST && get(parsedVAST, 'VAST');\n  const ads = vastElement && getAll(vastElement, 'Ad');\n\n  if (ads && ads.length > 0) {\n    return ads;\n  }\n\n  return [];\n};\n\n/**\n * Gets the Error URI of the passed parsed VAST xml.\n *\n * @function\n * @param {ParsedVast} parsedVAST - Parsed VAST xml.\n * @returns {?VAST-macro} - Vast Error URI or `null` otherwise.\n * @static\n */\nexport const getVastErrorURI = (parsedVAST) => {\n  const vastElement = parsedVAST && get(parsedVAST, 'VAST');\n\n  if (vastElement) {\n    const error = get(vastElement, 'Error');\n\n    if (error) {\n      return getText(error);\n    }\n  }\n\n  return null;\n};\n\n/**\n * Gets the sequence of the pod ad.\n *\n * @function\n * @param {ParsedAd} ad - Parsed ad definition object.\n * @returns {?number} - The pod ad sequence number or `null`.\n * @static\n */\nexport const getPodAdSequence = (ad) => {\n  const sequence = parseInt(getAttribute(ad, 'sequence'), 10);\n\n  if (typeof sequence === 'number' && !isNaN(sequence)) {\n    return sequence;\n  }\n\n  return null;\n};\n\n/**\n * Checks if the passed ad definition is a pod ad.\n *\n * @function\n * @param {ParsedAd} ad - Parsed ad definition object.\n * @returns {?boolean} - Returns true if there the ad is a pod ad and false otherwise.\n * @static\n */\nexport const isPodAd = (ad) => Boolean(getPodAdSequence(ad));\n\n/**\n * Checks if the passed array of ads have an ad pod.\n *\n * @function\n * @param {ParsedVAST} parsedVAST - Parsed VAST xml.\n * @returns {?boolean} - Returns true if there is an ad pod in the array and false otherwise.\n * @static\n */\nexport const hasAdPod = (parsedVAST) => {\n  const ads = getAds(parsedVAST);\n\n  return Array.isArray(ads) && ads.filter(isPodAd).length > 1;\n};\n\n/**\n * Returns true if the passed VastChain has an ad pod or false otherwise.\n *\n * @function\n * @param {Array} VastChain - Array of VAST responses. See `load` or `requestAd` for more info.\n *\n * @returns {boolean} - True if the VastChain contains an ad pod and false otherwise.\n * @static\n */\nexport const isAdPod = (VastChain = []) => VastChain.map(({parsedXML}) => parsedXML).some(hasAdPod);\n\n/**\n * Selects the first ad of the passed VAST. If the passed VAST response contains an ad pod it will return the first ad in the ad pod sequence.\n *\n * @function\n * @param {ParsedVAST} parsedVAST - Parsed VAST xml.\n * @returns {?ParsedAd} - First ad of the VAST xml or `null`.\n * @static\n */\nexport const getFirstAd = (parsedVAST) => {\n  const ads = getAds(parsedVAST);\n\n  if (Array.isArray(ads) && ads.length > 0) {\n    if (hasAdPod(parsedVAST)) {\n      return ads.filter(isPodAd)\n        .sort(compareBySequence)[0];\n    }\n\n    return ads[0];\n  }\n\n  return null;\n};\n\n/**\n * Checks if the passed ad is a Wrapper.\n *\n * @function\n * @param {ParsedAd} ad - VAST ad object.\n * @returns {boolean} - `true` if the ad contains a wrapper and `false` otherwise.\n * @static\n */\nexport const isWrapper = (ad = {}) => Boolean(get(ad || {}, 'Wrapper'));\n\n/**\n * Checks if the passed ad is an Inline.\n *\n * @function\n * @param {ParsedAd} ad - VAST ad object.\n * @returns {boolean} - Returns `true` if the ad contains an Inline or `false` otherwise.\n * @static\n */\nexport const isInline = (ad) => Boolean(get(ad || {}, 'Inline'));\n\n/**\n * Returns the VASTAdTagURI from the wrapper ad.\n *\n * @function\n * @param {ParsedAd} ad - VAST ad object.\n * @returns {?string} - Returns the VASTAdTagURI from the wrapper ad or `null` otherwise.\n * @static\n */\nexport const getVASTAdTagURI = (ad) => {\n  const wrapperElement = get(ad, 'Wrapper');\n  const vastAdTagURIElement = wrapperElement && get(wrapperElement, 'VastAdTagUri');\n\n  if (vastAdTagURIElement) {\n    return getText(vastAdTagURIElement) || null;\n  }\n\n  return null;\n};\n\n/**\n * Returns the options from the wrapper ad.\n *\n * @function\n * @param {Object} ad - VAST ad object.\n * @returns {WrapperOptions} - Returns the options from the wrapper ad.\n * @static\n */\nexport const getWrapperOptions = (ad) => {\n  const {\n    allowMultipleAds,\n    fallbackOnNoAd,\n    followAdditionalWrappers\n  } = getAttributes(get(ad, 'Wrapper'));\n\n  const opts = {};\n\n  if (allowMultipleAds) {\n    opts.allowMultipleAds = getBooleanValue(allowMultipleAds);\n  }\n\n  if (fallbackOnNoAd) {\n    opts.fallbackOnNoAd = getBooleanValue(fallbackOnNoAd);\n  }\n\n  if (followAdditionalWrappers) {\n    opts.followAdditionalWrappers = getBooleanValue(followAdditionalWrappers);\n  }\n\n  return opts;\n};\n\n/**\n * Gets the Error URI of the passed ad.\n *\n * @function\n * @param {ParsedAd} ad - VAST ad object.\n * @returns {?string} - Vast ad Error URI or `null` otherwise.\n * @static\n */\nexport const getAdErrorURI = (ad) => {\n  const adTypeElement = ad && getFirstChild(ad);\n\n  if (adTypeElement) {\n    const error = get(adTypeElement, 'Error');\n\n    if (error) {\n      return getText(error);\n    }\n  }\n\n  return null;\n};\n\n/**\n * Gets the Impression URI of the passed ad.\n *\n * @function\n * @param {ParsedAd} ad - VAST ad object.\n * @returns {?string} - Vast ad Impression URI or `null` otherwise.\n * @static\n */\nexport const getImpressionUri = (ad) => {\n  const adTypeElement = ad && getFirstChild(ad);\n\n  if (adTypeElement) {\n    const impression = get(adTypeElement, 'Impression');\n\n    if (impression) {\n      return getText(impression);\n    }\n  }\n\n  return null;\n};\n\n/**\n * Gets the ad's MediaFiles.\n *\n * @function\n * @param {ParsedAd} ad - VAST ad object.\n * @returns {?Array.<MediaFile>} - array of media files or null\n * @static\n */\nexport const getMediaFiles = (ad) => {\n  const creativeElement = ad && getLinearCreative(ad);\n\n  if (creativeElement) {\n    const universalAdIdElement = get(creativeElement, 'UniversalAdId');\n    const universalAdId = universalAdIdElement && getText(universalAdIdElement) || null;\n    const linearElement = get(creativeElement, 'Linear');\n    const mediaFilesElement = get(linearElement, 'MediaFiles');\n    const mediaFileElements = mediaFilesElement && getAll(mediaFilesElement, 'MediaFile');\n\n    if (mediaFileElements && mediaFileElements.length > 0) {\n      return mediaFileElements.map((mediaFileElement) => {\n        const src = getText(mediaFileElement);\n        const {\n          apiFramework,\n          bitrate,\n          codec,\n          delivery,\n          height,\n          id,\n          maintainAspectRatio,\n          maxBitrate,\n          minBitrate,\n          scalable,\n          type,\n          width\n        } = getAttributes(mediaFileElement);\n\n        return {\n          apiFramework,\n          bitrate,\n          codec,\n          delivery,\n          height,\n          id,\n          maintainAspectRatio,\n          maxBitrate,\n          minBitrate,\n          scalable,\n          src,\n          type,\n          universalAdId,\n          width\n        };\n      });\n    }\n  }\n\n  return null;\n};\n\n/**\n * Gets the ad's InteractiveFiles. That were added with the `InteractiveCreativeFile` tag.\n *\n * @function\n * @param {ParsedAd} ad - VAST ad object.\n * @returns {?Array.<InteractiveFile>} - array of media files or null\n * @static\n */\nexport const getInteractiveCreativeFiles = (ad) => {\n  const creativeElement = ad && getLinearCreative(ad);\n\n  if (creativeElement) {\n    const linearElement = get(creativeElement, 'Linear');\n    const mediaFilesElement = get(linearElement, 'MediaFiles');\n    const interactiveElements = mediaFilesElement && getAll(mediaFilesElement, 'InteractiveCreativeFile');\n\n    if (interactiveElements && interactiveElements.length > 0) {\n      return interactiveElements.map((interactiveElement) => {\n        const {\n          apiFramework,\n          type\n        } = getAttributes(interactiveElement);\n        const src = getText(interactiveElement);\n\n        return {\n          apiFramework,\n          src,\n          type\n        };\n      });\n    }\n  }\n\n  return null;\n};\n\n/**\n * Gets all the ad's InteractiveFiles.\n *\n * @function\n * @param {ParsedAd} ad - VAST ad object.\n * @returns {?Array.<InteractiveFile>} - array of media files or null\n * @static\n */\nexport const getInteractiveFiles = (ad) => {\n  let interactiveFiles = getInteractiveCreativeFiles(ad);\n\n  if (interactiveFiles) {\n    return interactiveFiles;\n  }\n\n  const mediaFiles = getMediaFiles(ad);\n\n  if (mediaFiles) {\n    interactiveFiles = mediaFiles\n      .filter(({apiFramework = ''}) => apiFramework.toLowerCase() === 'vpaid')\n      .map(({apiFramework, src, type}) => ({\n        apiFramework,\n        src,\n        type\n      }));\n\n    if (interactiveFiles.length > 0) {\n      return interactiveFiles;\n    }\n  }\n\n  return null;\n};\n\nconst getVideoClicksElement = (ad) => {\n  const creativeElement = ad && getLinearCreative(ad);\n  const linearElement = creativeElement && get(creativeElement, 'Linear');\n  const videoClicksElement = linearElement && get(linearElement, 'VideoClicks');\n\n  if (videoClicksElement) {\n    return videoClicksElement;\n  }\n\n  return null;\n};\n\n/**\n * Gets the click through {@link VAST-macro}.\n *\n * @function\n * @param {ParsedAd} ad - VAST ad object.\n * @returns {?VAST-macro} - clickthrough macro\n * @static\n */\nexport const getClickThrough = (ad) => {\n  const videoClicksElement = getVideoClicksElement(ad);\n  const clickThroughElement = videoClicksElement && get(videoClicksElement, 'ClickThrough');\n\n  if (clickThroughElement) {\n    return getText(clickThroughElement);\n  }\n\n  return null;\n};\n\n/**\n * Gets the click through {@link VAST-macro}.\n *\n * @function\n * @param {ParsedAd} ad - VAST ad object.\n * @returns {?Array.<VAST-macro>} - click tracking macro\n * @static\n */\nexport const getClickTracking = (ad) => {\n  const videoClicksElement = getVideoClicksElement(ad);\n  const clickTrackingElements = videoClicksElement && getAll(videoClicksElement, 'ClickTracking');\n\n  if (clickTrackingElements && clickTrackingElements.length > 0) {\n    return clickTrackingElements.map((element) => getText(element));\n  }\n\n  return null;\n};\n\n/**\n * Gets the custom click {@link VAST-macro}.\n *\n * @function\n * @param {ParsedAd} ad - VAST ad object.\n * @returns {?Array.<VAST-macro>} - click tracking macro\n * @static\n */\nexport const getCustomClick = (ad) => {\n  const videoClicksElement = getVideoClicksElement(ad);\n  const customClickElements = videoClicksElement && getAll(videoClicksElement, 'CustomClick');\n\n  if (customClickElements && customClickElements.length > 0) {\n    return customClickElements.map((element) => getText(element));\n  }\n\n  return null;\n};\n\n/**\n * Gets the skipoffset.\n *\n * @function\n * @param {Object} ad - VAST ad object.\n * @returns {?ParsedOffset} - the time offset in milliseconds or a string with the percentage or null\n * @static\n */\nexport const getSkipOffset = (ad) => {\n  const creativeElement = ad && getLinearCreative(ad);\n  const linearElement = creativeElement && get(creativeElement, 'Linear');\n  const skipoffset = linearElement && getAttribute(linearElement, 'skipoffset');\n\n  if (skipoffset) {\n    return parseOffset(skipoffset);\n  }\n\n  return null;\n};\n\nconst getLinearContent = (xml) => {\n  const linearRegex = /<Linear([\\s\\S]*)<\\/Linear/gm;\n  const result = linearRegex.exec(xml);\n\n  return result && result[1];\n};\n\nconst getAdParametersContent = (xml) => {\n  const paramsRegex = /<AdParameters[\\s\\w=\"]*>([\\s\\S]*)<\\/AdParameters>/gm;\n  const result = paramsRegex.exec(xml);\n\n  return result && result[1].replace(/[\\n\\s]*<!\\[CDATA\\[[\\n\\s]*/, '')\n    .replace(/[\\n\\s]*\\]\\]>[\\n\\s]*$/, '')\n\n    // unescape nested CDATA\n    .replace(/\\]\\]\\]\\]><!\\[CDATA\\[>/, ']]>')\n    .trim();\n};\n\nconst getXmlEncodedValue = (xml) => {\n  const xmlEncodedRegex = /<AdParameters[\\s]*xmlEncoded=\"(.*?)\">/gmi;\n  const result = xmlEncodedRegex.exec(xml);\n\n  return Boolean(result) && result[1] === 'true';\n};\n\n/**\n * Gets the creative data.\n *\n * @function\n * @param {string} xml - VAST XML text.\n * @returns {Object} - with `AdParameters` as they come in the XML and a flag `xmlEncoded` to indicate if the ad parameters are xml encoded.\n * @static\n */\nexport const getCreativeData = (xml) => {\n  const linearContent = getLinearContent(xml);\n  const AdParameters = linearContent && getAdParametersContent(linearContent);\n  const xmlEncoded = linearContent && getXmlEncodedValue(linearContent);\n\n  return {\n    AdParameters,\n    xmlEncoded\n  };\n};\n\nexport {\n\n  /**\n   * Gets the Vast Icon definitions from the Vast Ad.\n   *\n   * @function\n   * @param {ParsedAd} ad - VAST ad object.\n   * @returns {?Array.<VastIcon>} - Array of VAST icon definitions\n   * @static\n   */\n  getIcons,\n\n  /**\n   * Gets the Linear tracking events from the Vast Ad\n   *\n   * @function\n   * @param {ParsedAd} ad - VAST ad object.\n   * @param {string} [eventName] - If provided it will filter-out the array events against it.\n   * @returns {?Array.<VastTrackingEvent>} - Array of Tracking event definitions\n   * @static\n   */\n  getLinearTrackingEvents,\n\n  /**\n   * Gets the Non Linear tracking events from the Vast Ad\n   *\n   * @function\n   * @param {ParsedAd} ad - VAST ad object.\n   * @param {string} [eventName] - If provided it will filter-out the array events against it.\n   * @returns {?Array.<VastTrackingEvent>} - Array of Tracking event definitions\n   * @static\n   */\n  getNonLinearTrackingEvents\n};\n","const toUpperKeys = (map) => {\n  const upperKeysMap = {};\n\n  Object.keys(map).forEach((key) => {\n    upperKeysMap[key.toUpperCase()] = map[key];\n  });\n\n  return upperKeysMap;\n};\n\n/**\n * Parses the passed macro with the passed data and returns the resulting parsed Macro.\n * If no CACHEBUSTING property is passed in the data it will generate a random one on its own.\n * If no TIMESTAMP property is passed in the data it will generate a one on its own.\n *\n * @ignore\n * @param {string} macro - The string macro to be parsed.\n * @param {Object} data - The data used by the macro.\n * @returns {string} - The parsed macro.\n * @static\n */\nconst parseMacro = (macro, data = {}) => {\n  let parsedMacro = macro;\n  const macroData = toUpperKeys(data);\n\n  if (!Boolean(macroData.CACHEBUSTING)) {\n    macroData.CACHEBUSTING = Math.round(Math.random() * 1.0e+10);\n  }\n\n  if (!Boolean(macroData.TIMESTAMP)) {\n    macroData.TIMESTAMP = new Date().toISOString();\n  }\n\n  Object.keys(macroData).forEach((key) => {\n    const value = encodeURIComponent(macroData[key]);\n\n    parsedMacro = parsedMacro.replace(new RegExp('\\\\[' + key + '\\\\]', 'gm'), value);\n  });\n\n  return parsedMacro;\n};\n\nexport default parseMacro;\n","import parseMacro from './parseMacro';\n\n/**\n * Creates a tracking image with the passed URL macro.\n *\n * @global\n * @typedef pixelTracker\n * @type TrackerFn\n * @name pixelTracker\n * @param {string} URLMacro - URL Macro that need to be tracked.\n * @param {Object} data - Data Object with the macros's variables.\n * @returns {HTMLImageElement} - Image element whose source is the parsed URL Macro.\n * @static\n */\nconst pixelTracker = (URLMacro, data) => {\n  const img = new Image();\n\n  img.src = parseMacro(URLMacro, data);\n\n  return img;\n};\n\nexport default pixelTracker;\n\n","import {\n  getAdErrorURI,\n  getVastErrorURI\n} from '../../vastSelectors';\nimport pixelTracker from './pixelTracker';\n\n/**\n * Tracks an error.\n *\n * @ignore\n * @param {VastChain} vastChain - the ad VAST Chain.\n * @param {Object} options - Options Map. The allowed properties are:\n * @param {Object} [options.logger] - Optional logger instance.\n *                                    Must comply to the [Console interface](https://developer.mozilla.org/es/docs/Web/API/Console).\n *                                    Defaults to console.\n * @param {tracker} [options.tracker] - optional tracker to use for the actual tracking. Defaults to the pixel tracker.\n * @param {string} [options.errorCode] - error code. Needed if we are tracking an error.\n */\nconst trackError = (vastChain, {errorCode, tracker = pixelTracker}) => {\n  vastChain.forEach(({ad, parsedXML}) => {\n    const errorURI = getAdErrorURI(ad) || getVastErrorURI(parsedXML);\n\n    if (Boolean(errorURI)) {\n      tracker(errorURI, {errorCode});\n    }\n  });\n};\n\nexport default trackError;\n","import pixelTracker from './pixelTracker';\n\nconst createVastEventTracker = (vastChainSelector) => (vastChain, {data, tracker = pixelTracker}) => {\n  vastChain.forEach(({ad}) => {\n    const value = vastChainSelector(ad);\n\n    if (Boolean(value)) {\n      switch (true) {\n      case typeof value === 'string': {\n        tracker(value, data);\n        break;\n      }\n      case Array.isArray(value): {\n        value.map(({uri}) => tracker(uri, data));\n        break;\n      }\n      }\n    }\n  });\n};\n\nexport default createVastEventTracker;\n","import {\n  getClickTracking,\n  getCustomClick,\n  getImpressionUri,\n  getLinearTrackingEvents\n} from '../vastSelectors';\nimport pixelTracker from './helpers/pixelTracker';\nimport trackError from './helpers/trackError';\nimport trackIconView from './helpers/trackIconView';\nimport trackIconClick from './helpers/trackIconClick';\nimport trackProgress from './helpers/trackProgress';\nimport createVastEventTracker from './helpers/createVastEventTracker';\nimport {\n  clickThrough,\n  closeLinear,\n  complete,\n  error,\n  exitFullscreen,\n  firstQuartile,\n  fullscreen,\n  iconClick,\n  iconView,\n  impression,\n  midpoint,\n  mute,\n  pause,\n  playerCollapse,\n  playerExpand,\n  progress,\n  resume,\n  rewind,\n  skip,\n  start,\n  thirdQuartile,\n  unmute\n} from './linearEvents';\n\nconst clickTrackingSelector = (ad) => {\n  const trackingURIs = [];\n  const clickTrackings = getClickTracking(ad);\n  const customClicks = getCustomClick(ad);\n\n  /* istanbul ignore else */\n  if (Array.isArray(clickTrackings) && clickTrackings.length > 0) {\n    trackingURIs.push(...clickTrackings.map((uri) => ({uri})));\n  }\n\n  /* istanbul ignore else */\n  if (Array.isArray(customClicks) && customClicks.length > 0) {\n    trackingURIs.push(...customClicks.map((uri) => ({uri})));\n  }\n\n  return trackingURIs;\n};\n\nconst linearTrackingEventSelector = (event) => (ad) => getLinearTrackingEvents(ad, event);\nconst linearTrackers = {\n  [clickThrough]: createVastEventTracker(clickTrackingSelector),\n  [closeLinear]: createVastEventTracker(linearTrackingEventSelector(closeLinear)),\n  [complete]: createVastEventTracker(linearTrackingEventSelector(complete)),\n  [error]: trackError,\n  [exitFullscreen]: createVastEventTracker(linearTrackingEventSelector(exitFullscreen)),\n  [firstQuartile]: createVastEventTracker(linearTrackingEventSelector(firstQuartile)),\n  [fullscreen]: createVastEventTracker(linearTrackingEventSelector(fullscreen)),\n  [iconClick]: trackIconClick,\n  [iconView]: trackIconView,\n  [impression]: createVastEventTracker(getImpressionUri),\n  [midpoint]: createVastEventTracker(linearTrackingEventSelector(midpoint)),\n  [mute]: createVastEventTracker(linearTrackingEventSelector(mute)),\n  [pause]: createVastEventTracker(linearTrackingEventSelector(pause)),\n  [playerCollapse]: createVastEventTracker(linearTrackingEventSelector(playerCollapse)),\n  [playerExpand]: createVastEventTracker(linearTrackingEventSelector(playerExpand)),\n  [progress]: trackProgress,\n  [resume]: createVastEventTracker(linearTrackingEventSelector(resume)),\n  [rewind]: createVastEventTracker(linearTrackingEventSelector(rewind)),\n  [skip]: createVastEventTracker(linearTrackingEventSelector(skip)),\n  [start]: createVastEventTracker(linearTrackingEventSelector(start)),\n  [thirdQuartile]: createVastEventTracker(linearTrackingEventSelector(thirdQuartile)),\n  [unmute]: createVastEventTracker(linearTrackingEventSelector(unmute))\n};\n\n/**\n * Tracks the passed linear event.\n *\n * @ignore\n * @param {string} event - name of the linear event we need to track. @see LinearEvents\n * @param {VastChain} vastChain - the ad VAST Chain.\n * @param {Object} options - Options Map. The allowed properties are:\n * @param {Object} [options.logger] - Optional logger instance.\n *                                    Must comply to the [Console interface](https://developer.mozilla.org/es/docs/Web/API/Console).\n *                                    Defaults to console.\n * @param {Object} [options.data] - additional data for the URL macro. See [VAST specification]{@link https://www.iab.com/guidelines/digital-video-ad-serving-template-vast-4-0/}\n * @param {tracker} [options.tracker] - optional tracker to use for the actual tracking. Defaults to the pixel tracker.\n * @param {string} [options.errorCode] - error code. Needed if we are tracking an error.\n */\nconst trackLinearEvent = (event, vastChain, {data, errorCode, tracker = pixelTracker, logger = console}) => {\n  const linearTracker = linearTrackers[event];\n\n  if (linearTracker) {\n    linearTracker(vastChain, {\n      data: {\n        ...data,\n        errorCode\n      },\n      errorCode,\n      tracker\n    });\n  } else {\n    logger.error(`Event '${event}' cannot be tracked`);\n  }\n};\n\nexport default trackLinearEvent;\n","import pixelTracker from './pixelTracker';\n\nconst trackIconClick = (vastChain, {data, tracker = pixelTracker}) => {\n  const {iconClickTracking} = data;\n\n  if (Array.isArray(iconClickTracking)) {\n    for (const trackUrl of iconClickTracking) {\n      tracker(trackUrl, {...data});\n    }\n  }\n};\n\nexport default trackIconClick;\n","import pixelTracker from './pixelTracker';\n\nconst trackIconView = (vastChain, {data, tracker = pixelTracker}) => {\n  const {iconViewTracking} = data;\n\n  if (Array.isArray(iconViewTracking)) {\n    for (const trackUrl of iconViewTracking) {\n      tracker(trackUrl, {...data});\n    }\n  }\n};\n\nexport default trackIconView;\n","import pixelTracker from './pixelTracker';\n\nconst trackProgress = (vastChain, {data, tracker = pixelTracker}) => {\n  const {progressUri} = data;\n\n  if (Boolean(progressUri)) {\n    tracker(progressUri, {...data});\n  }\n};\n\nexport default trackProgress;\n","import {getNonLinearTrackingEvents} from '../vastSelectors';\nimport createVastEventTracker from './helpers/createVastEventTracker';\nimport pixelTracker from './helpers/pixelTracker';\nimport {\n  acceptInvitation,\n  adCollapse,\n  close,\n  creativeView\n} from './nonLinearEvents';\n\nconst trackingEventSelector = (event) => (ad) => getNonLinearTrackingEvents(ad, event);\nconst linearTrackers = {\n  [acceptInvitation]: createVastEventTracker(trackingEventSelector(acceptInvitation)),\n  [adCollapse]: createVastEventTracker(trackingEventSelector(adCollapse)),\n  [close]: createVastEventTracker(trackingEventSelector(close)),\n  [creativeView]: createVastEventTracker(trackingEventSelector(creativeView))\n\n};\n\n/**\n * Tracks the passed non linear event.\n *\n * @ignore\n * @param {string} event - name of the linear event we need to track. @see LinearEvents\n * @param {VastChain} vastChain - the ad VAST Chain.\n * @param {Object} options - Options Map. The allowed properties are:\n * @param {Object} [options.logger] - Optional logger instance.\n *                                    Must comply to the [Console interface](https://developer.mozilla.org/es/docs/Web/API/Console).\n *                                    Defaults to console.\n * @param {Object} [options.data] - additional data for the URL macro. See [VAST specification]{@link https://www.iab.com/guidelines/digital-video-ad-serving-template-vast-4-0/}\n * @param {tracker} [options.tracker] - optional tracker to use for the actual tracking. Defaults to the pixel tracker.\n */\nconst trackNonLinearEvent = (event, vastChain, {data, tracker = pixelTracker, logger = console}) => {\n  const linearTracker = linearTrackers[event];\n\n  if (linearTracker) {\n    linearTracker(vastChain, {\n      data: {\n        ...data\n      },\n      tracker\n    });\n  } else {\n    logger.error(`Event '${event}' cannot be tracked`);\n  }\n};\n\nexport default trackNonLinearEvent;\n","/**\n * Loads the script source.\n *\n * @ignore\n * @param {string} src - The script source.\n * @param {Object} options - The allowed options are:\n *                           type: Defaults to 'text/javascript'.\n *                           async<Boolean> : if \"true\" the \"async\" attribute is added to the new script. Defaults to false.\n *                           defer<Boolean> : if \"true\" the \"defer\" attribute is added to the new script. Defaults to false.\n *                           placeholder: Element that should contain the script. Defaults to the parentNode of the currentScript or\n *                                        if missing to document.head .\n */\nconst loadScript = function (src, {async = false, defer = false, type = 'text/javascript', placeholder} = {}) {\n  if (!src) {\n    throw new TypeError('Missing required \"src\" parameter');\n  }\n\n  return new Promise((resolve, reject) => {\n    const script = document.createElement('script');\n    let scriptPlaceholder = placeholder;\n\n    script.type = type;\n    script.async = async;\n    script.defer = defer;\n    script.onerror = () => reject(new URIError(`The script ${src} is not accessible.`));\n    script.onload = () => resolve(script);\n\n    if (!scriptPlaceholder) {\n      scriptPlaceholder = document.currentScript ?\n        /* istanbul ignore next */\n        document.currentScript.parentNode :\n        document.head;\n    }\n\n    script.src = src;\n    scriptPlaceholder.appendChild(script);\n  });\n};\n\nexport default loadScript;\n","const createAdVideoElement = (contentDocument = document) => {\n  const video = contentDocument.createElement('VIDEO');\n\n  video.style.width = '100%';\n  video.style.height = '100%';\n\n  return video;\n};\n\nexport default createAdVideoElement;\n","const createAdContainer = () => {\n  const adContainer = document.createElement('DIV');\n\n  adContainer.classList.add('mol-video-ad-container');\n  adContainer.style.width = '100%';\n  adContainer.style.height = '100%';\n\n  return adContainer;\n};\n\nexport default createAdContainer;\n","const getContentDocument = (iframeElement) =>\n  iframeElement.contentDocument ||\n  /* istanbul ignore next */\n  iframeElement.contentWindow && iframeElement.contentWindow.document;\n\nexport default getContentDocument;\n","const supported = 'srcdoc' in document.createElement('iframe');\nconst supportsSrcdoc = () => supported;\n\nexport default supportsSrcdoc;\n","import getContentDocument from './getContentDocument';\nimport getOrigin from './getOrigin';\nimport supportsSrcdoc from './supportsSrcdoc';\n\nconst iframeContent = (id, targetOrigin) => `<!DOCTYPE html>\n<html>\n  <head><meta charset='UTF-8'></head>\n  <body style='margin:0;padding:0'>\n  <script type='text/javascript'>window.parent.postMessage('${id}_ready', '${targetOrigin}');</script>\n  </body>\n</html>`;\n\nconst createBaseIframe = () => {\n  const iframe = document.createElement('IFRAME');\n\n  iframe.sandbox = 'allow-forms allow-popups allow-scripts allow-same-origin';\n  iframe.style.margin = '0';\n  iframe.style.padding = '0';\n  iframe.style.border = 'none';\n  iframe.style.width = '0';\n  iframe.style.height = '0';\n  iframe.style.position = 'absolute';\n\n  return iframe;\n};\n\nconst createIframe = (placeholder, id) => new Promise((resolve, reject) => {\n  const content = iframeContent(id, getOrigin());\n  let iframe;\n\n  /*\n    NOTE: favor about:blank instead of srcdoc because some browsers\n  */\n  try {\n    iframe = createBaseIframe();\n    iframe.src = 'about:blank';\n    placeholder.appendChild(iframe);\n    getContentDocument(iframe).write(content);\n  } catch (error) {\n    placeholder.removeChild(iframe);\n\n    if (supportsSrcdoc()) {\n      iframe = createBaseIframe();\n      iframe.src = 'about:srcdoc';\n      iframe.srcdoc = content;\n      placeholder.appendChild(iframe);\n    } else {\n      reject(error);\n    }\n  }\n\n  const handleMessage = ({data}) => {\n    /* istanbul ignore else */\n    if (data === `${id}_ready`) {\n      window.removeEventListener('message', handleMessage);\n      resolve(iframe);\n    }\n  };\n\n  window.addEventListener('message', handleMessage, false);\n});\n\nexport default createIframe;\n","const getOrigin = () => {\n  const location = window.location;\n\n  /* istanbul ignore else */\n  if (location.origin) {\n    return location.origin;\n  } else {\n    return location.protocol + '//' +\n          location.hostname +\n          (location.port ? ':' + location.port : '');\n  }\n};\n\nexport default getOrigin;\n","/* eslint-disable promise/prefer-await-to-then */\nimport loadScript from './helpers/loadScript';\nimport createAdVideoElement from './helpers/createAdVideoElement';\nimport createAdContainer from './helpers/createAdContainer';\nimport createIframe from './helpers/createIframe';\nimport getContentDocument from './helpers/getContentDocument';\nimport unique from './helpers/unique';\n\nconst nextId = unique('videoAdContainer');\nconst hidden = Symbol('hidden');\n\n/**\n * @class\n * @alias VideoAdContainer\n * @description This class provides everything necessary to contain and create a video ad within a given placeholder Element.\n */\nclass VideoAdContainer {\n  [hidden] = {\n    destroyed: false,\n    iframe: null,\n    readyPromise: null\n  };\n\n  /**\n   * Creates a VideoAdContainer.\n   *\n   * @param {HTMLDivElement} placeholder - DIV that will contain the ad.\n   * @param {HTMLVideoElement} [videoElement] - optional videoElement that will be used to play the ad.\n   */\n  constructor (placeholder, videoElement = null) {\n    if (!(placeholder instanceof Element)) {\n      throw new TypeError('placeholder is not an Element');\n    }\n\n    this[hidden].id = nextId();\n    this.element = createAdContainer();\n    this.executionContext = null;\n\n    this.isOriginalVideoElement = Boolean(videoElement);\n\n    if (videoElement) {\n      this.videoElement = videoElement;\n    } else {\n      this.videoElement = createAdVideoElement();\n      this.element.appendChild(this.videoElement);\n    }\n\n    placeholder.appendChild(this.element);\n  }\n\n  /**\n   * Adds the passed script to the ad container.\n   *\n   * @param {string} src - script source uri.\n   * @param {Object} options - Options map.\n   * @param {string} options.type - Defaults to 'text/javascript'.\n   * @param {boolean} options.async - if \"true\" the \"async\" attribute is added to the new script. Defaults to false.\n   * @param {boolean} options.defer - if \"true\" the \"defer\" attribute is added to the new script. Defaults to true.\n   */\n  async addScript (src, options = {}) {\n    if (this.isDestroyed()) {\n      throw new Error('VideoAdContainer has been destroyed');\n    }\n\n    if (!this[hidden].iframe) {\n      this[hidden].iframe = await createIframe(this.element, this[hidden].id);\n      this.executionContext = this[hidden].iframe.contentWindow;\n    }\n\n    const placeholder = getContentDocument(this[hidden].iframe).body;\n\n    return loadScript(src, {\n      placeholder,\n      ...options\n    });\n  }\n\n  /**\n   * Destroys the VideoAdContainer.\n   */\n  destroy () {\n    this.element.parentNode.removeChild(this.element);\n    this[hidden].destroyed = true;\n  }\n\n  /**\n   * Checks if the container is destroyed.\n   *\n   * @returns {boolean} - true if the container is destroyed and false otherwise.\n   */\n  isDestroyed () {\n    return this[hidden].destroyed;\n  }\n}\n\nexport default VideoAdContainer;\n","import VideoAdContainer from './VideoAdContainer';\n\n/**\n * @function\n * @description VideoAdContainer factory method. Returns a VideoAdContainer instance that will contain the video ad.\n *\n * @ignore\n * @static\n * @param {HTMLElement} placeholder - Placeholder element that will contain the video ad.\n * @param {HTMLVideoElement} [videoElement] - optional videoElement that will be used to play the ad.\n *\n * @returns {VideoAdContainer} - Returns a `VideoAdContainer` instance.\n */\nconst createVideoAdContainer = (placeholder, videoElement) => {\n  if (!placeholder) {\n    throw new TypeError('placeholder is required');\n  }\n\n  return new VideoAdContainer(placeholder, videoElement);\n};\n\nexport default createVideoAdContainer;\n","import guessMimeType from './guessMimeType';\n\nconst canPlay = (videoElement, mediaFile) => {\n  const {\n    src,\n    type\n  } = mediaFile;\n\n  return videoElement.canPlayType(type || guessMimeType(src));\n};\n\nexport default canPlay;\n","/* eslint-disable id-match*/\nconst guessMimeType = function (src) {\n  const mimeMap = {\n    '3gp': 'video/3gpp',\n    avi: 'video/x-msvideo',\n    flv: 'video/x-flv',\n    m3u8: 'application/x-mpegURL',\n    m4v: 'video/mp4',\n    mov: 'video/quicktime',\n    mp4: 'video/mp4',\n    mpd: 'application/dash+xml',\n    ogv: 'video/ogg',\n    ts: 'video/MP2T',\n    webm: 'video/webm',\n    wmv: 'video/x-ms-wmv'\n  };\n  const match = src.match(/\\.([^./?]+)(\\?[^/]+)?$/i);\n  const ext = match && match[1];\n\n  return mimeMap[ext] || 'video/' + ext;\n};\n\nexport default guessMimeType;\n","import {getMediaFiles} from '../../../vastSelectors';\nimport canPlay from './canPlay';\nimport sortMediaByBestFit from './sortMediaByBestFit';\n\nconst findBestMedia = (inlineAd, videoElement, container) => {\n  const screenRect = container.getBoundingClientRect();\n  const mediaFiles = getMediaFiles(inlineAd);\n\n  if (mediaFiles) {\n    const supportedMediaFiles = mediaFiles.filter((mediaFile) => canPlay(videoElement, mediaFile));\n    const sortedMediaFiles = sortMediaByBestFit(supportedMediaFiles, screenRect);\n\n    return sortedMediaFiles[0];\n  }\n\n  return null;\n};\n\nexport default findBestMedia;\n","const sortMediaByBestFit = (mediaFiles, screenRect) => {\n  const screenWidth = screenRect.width;\n  const compareTo = (mediaFileA, mediaFileB) => {\n    const deltaA = Math.abs(screenWidth - (mediaFileA.width || 0));\n    const deltaB = Math.abs(screenWidth - (mediaFileB.width || 0));\n\n    return deltaA - deltaB;\n  };\n\n  return mediaFiles.slice(0).sort(compareTo);\n};\n\nexport default sortMediaByBestFit;\n","const once = (element, eventName, listener) => {\n  const handler = (...args) => {\n    element.removeEventListener(eventName, handler);\n\n    return listener(...args);\n  };\n\n  element.addEventListener(eventName, handler);\n\n  return () => {\n    element.removeEventListener(eventName, handler);\n  };\n};\n\nexport default once;\n\n","import {getLinearTrackingEvents} from '../../../vastSelectors';\nimport {linearEvents} from '../../../tracker';\n\nconst {\n  progress\n} = linearEvents;\n\nconst getProgressEvents = (vastChain) => vastChain.map(({ad}) => ad)\n  .reduce((accumulated, ad) => {\n    const events = getLinearTrackingEvents(ad, progress) || [];\n\n    return [\n      ...accumulated,\n      ...events\n    ];\n  }, [])\n  .map(({offset, uri}) => ({\n    offset,\n    uri\n  }));\n\nexport default getProgressEvents;\n","const safeCallback = (callback, logger) => (...args) => {\n  try {\n    // eslint-disable-next-line callback-return, promise/prefer-await-to-callbacks\n    callback(...args);\n  } catch (error) {\n    if (logger) {\n      logger.error(error);\n    }\n  }\n};\n\nexport default safeCallback;\n","/* eslint-disable promise/prefer-await-to-callbacks, callback-return */\nimport {linearEvents} from '../../../../tracker';\n\nconst fullscreenElement = () => document.fullscreenElement ||\ndocument.webkitFullscreenElement ||\ndocument.mozFullScreenElement ||\ndocument.msFullscreenElement || null;\n\nconst {\n  fullscreen,\n  exitFullscreen,\n  playerCollapse,\n  playerExpand\n} = linearEvents;\n\nconst onFullscreenChange = ({videoElement}, callback) => {\n  const fullscreenEvtNames = ['webkitfullscreenchange', 'mozfullscreenchange', 'fullscreenchange', 'MSFullscreenChange'];\n  let fullscreenOn = false;\n  const fullscreenchangeHandler = () => {\n    if (fullscreenElement() === videoElement) {\n      fullscreenOn = true;\n      callback(playerExpand);\n      callback(fullscreen);\n    } else if (fullscreenOn) {\n      fullscreenOn = false;\n      callback(playerCollapse);\n      callback(exitFullscreen);\n    }\n  };\n\n  for (const event of fullscreenEvtNames) {\n    document.addEventListener(event, fullscreenchangeHandler);\n  }\n\n  return () => {\n    for (const event of fullscreenEvtNames) {\n      document.removeEventListener(event, fullscreenchangeHandler);\n    }\n  };\n};\n\nexport default onFullscreenChange;\n","/* eslint-disable promise/prefer-await-to-callbacks, callback-return */\n\nimport {linearEvents} from '../../../../tracker';\n\nconst {\n  pause,\n  resume\n} = linearEvents;\n\nconst onPlayPause = ({videoElement}, callback) => {\n  let started = false;\n  let paused = true;\n\n  const playHandler = () => {\n    if (!started) {\n      started = true;\n      paused = false;\n    } else if (paused) {\n      paused = false;\n      callback(resume);\n    }\n  };\n\n  const pauseHandler = () => {\n    if (!paused) {\n      paused = true;\n      callback(pause);\n    }\n  };\n\n  videoElement.addEventListener('play', playHandler);\n  videoElement.addEventListener('pause', pauseHandler);\n\n  return () => {\n    videoElement.removeEventListener('play', playHandler);\n    videoElement.removeEventListener('pause', pauseHandler);\n  };\n};\n\nexport default onPlayPause;\n","/* eslint-disable promise/prefer-await-to-callbacks, callback-return */\nimport {linearEvents} from '../../../../tracker';\n\nconst {rewind} = linearEvents;\nconst onRewind = ({videoElement}, callback) => {\n  let currentTime = videoElement.currentTime;\n\n  const timeupdateHandler = () => {\n    const delta = videoElement.currentTime - currentTime;\n\n    if (delta < 0 && Math.abs(delta) >= 1) {\n      callback(rewind);\n    }\n\n    currentTime = videoElement.currentTime;\n  };\n\n  videoElement.addEventListener('timeupdate', timeupdateHandler);\n\n  return () => {\n    videoElement.removeEventListener('timeupdate', timeupdateHandler);\n  };\n};\n\nexport default onRewind;\n","/* eslint-disable callback-return, promise/prefer-await-to-callbacks */\nimport {linearEvents} from '../../../../tracker';\n\nconst {skip} = linearEvents;\nconst createDefaultSkipControl = () => {\n  const skipBtn = document.createElement('BUTTON');\n\n  skipBtn.classList.add('mol-vast-skip-control');\n  skipBtn.type = 'button';\n  skipBtn.innerHTML = 'skip';\n  skipBtn.style.position = 'absolute';\n  skipBtn.style.bottom = '15px';\n  skipBtn.style.right = '15px';\n\n  return skipBtn;\n};\n\nconst onSkip = (videoAdContainer, callback, {skipoffset, createSkipControl = createDefaultSkipControl} = {}) => {\n  if (!Boolean(skipoffset)) {\n    return () => {};\n  }\n\n  let skipControl;\n  const {\n    videoElement,\n    element\n  } = videoAdContainer;\n\n  const skipHandler = () => {\n    const currentTimeMs = videoElement.currentTime * 1000;\n\n    if (!Boolean(skipControl) && currentTimeMs >= skipoffset) {\n      skipControl = createSkipControl();\n\n      skipControl.onclick = (event) => {\n        if (Event.prototype.stopPropagation !== undefined) {\n          event.stopPropagation();\n        }\n\n        callback(skip);\n\n        return false;\n      };\n\n      element.appendChild(skipControl);\n      videoElement.removeEventListener('timeupdate', skipHandler);\n    }\n  };\n\n  videoElement.addEventListener('timeupdate', skipHandler);\n\n  return () => {\n    videoElement.removeEventListener('timeupdate', skipHandler);\n    if (Boolean(skipControl)) {\n      element.removeChild(skipControl);\n    }\n  };\n};\n\nexport default onSkip;\n","/* eslint-disable promise/prefer-await-to-callbacks, callback-return */\nimport {linearEvents} from '../../../../tracker';\n\nconst {error} = linearEvents;\n\nconst onError = ({videoElement}, callback) => {\n  const errorHandler = () => {\n    callback(error, videoElement.error);\n  };\n\n  videoElement.addEventListener('error', errorHandler);\n\n  return () => {\n    videoElement.removeEventListener('error', errorHandler);\n  };\n};\n\nexport default onError;\n","/**\n * Fires when the adUnit's volume has changed.\n *\n * @event VideoAdUnit#volumeChanged\n */\nexport const volumeChanged = 'volumeChanged';\n\n/**\n * Fires when the adUnit's has finished.\n *\n * @event VideoAdUnit#finish\n */\nexport const finish = 'finish';\n\n/**\n * fires on ad progress.\n *\n * @event VideoAdUnit#adProgress\n */\nexport const adProgress = 'adProgress';\n\nconst adUnitEvents = {\n  adProgress,\n  finish,\n  volumeChanged\n};\n\nexport default adUnitEvents;\n\n","/* eslint-disable promise/prefer-await-to-callbacks, callback-return */\nimport {linearEvents} from '../../../../tracker';\nimport {adProgress} from '../../../adUnitEvents';\n\nconst {\n  complete,\n  firstQuartile,\n  midpoint,\n  start,\n  thirdQuartile\n} = linearEvents;\nconst percentageProgress = (currentTime, duration) => currentTime * 100 / duration;\nconst isPassFirstQuartile = (currentTime, duration) => percentageProgress(currentTime, duration) >= 25;\nconst isPassMidPoint = (currentTime, duration) => percentageProgress(currentTime, duration) >= 50;\nconst isPassThirdQuartile = (currentTime, duration) => percentageProgress(currentTime, duration) >= 75;\nconst isCompleted = (currentTime, duration) => percentageProgress(currentTime, duration) >= 99;\n\n// TODO: implement logic to track `timeSpentViewing` linear event\n\nconst onTimeUpdate = ({videoElement}, callback) => {\n  let started = false;\n  let passFirstQuartile = false;\n  let passMidPoint = false;\n  let passThirdQuartile = false;\n  let completed = false;\n\n  // eslint-disable-next-line complexity\n  const timeupdateHandler = () => {\n    const duration = videoElement.duration;\n    const currentTime = videoElement.currentTime;\n\n    if (!started && currentTime > 0) {\n      started = true;\n      callback(start);\n    } else if (!passFirstQuartile) {\n      if (isPassFirstQuartile(currentTime, duration)) {\n        passFirstQuartile = true;\n        callback(firstQuartile);\n      }\n    } else if (!passMidPoint) {\n      if (isPassMidPoint(currentTime, duration)) {\n        passMidPoint = true;\n        callback(midpoint);\n      }\n    } else if (!passThirdQuartile) {\n      if (isPassThirdQuartile(currentTime, duration)) {\n        passThirdQuartile = true;\n        callback(thirdQuartile);\n      }\n    } else if (!completed) {\n      if (isCompleted(currentTime, duration)) {\n        completed = true;\n        callback(complete);\n      }\n    }\n\n    callback(adProgress);\n  };\n\n  const endedHandler = () => {\n    const duration = videoElement.duration;\n    const currentTime = videoElement.currentTime;\n\n    if (!completed && isCompleted(currentTime, duration)) {\n      completed = true;\n      callback(complete);\n    }\n\n    videoElement.removeEventListener('ended', endedHandler);\n    videoElement.removeEventListener('timeupdate', timeupdateHandler);\n  };\n\n  videoElement.addEventListener('timeupdate', timeupdateHandler);\n  videoElement.addEventListener('ended', endedHandler);\n\n  return () => {\n    videoElement.removeEventListener('timeupdate', timeupdateHandler);\n    videoElement.removeEventListener('ended', endedHandler);\n  };\n};\n\nexport default onTimeUpdate;\n","/* eslint-disable promise/prefer-await-to-callbacks, callback-return */\nimport {linearEvents} from '../../../../tracker';\nimport {volumeChanged} from '../../../adUnitEvents';\n\nconst {\n  mute,\n  unmute\n} = linearEvents;\nconst isMuted = (videoElement) => videoElement.muted || videoElement.volume === 0;\n\nconst onVolumeChange = ({videoElement}, callback) => {\n  let wasMuted = isMuted(videoElement);\n\n  const volumechangeHandler = () => {\n    callback(volumeChanged);\n\n    if (wasMuted && !isMuted(videoElement)) {\n      callback(unmute);\n    } else if (!wasMuted && isMuted(videoElement)) {\n      callback(mute);\n    }\n\n    wasMuted = isMuted(videoElement);\n  };\n\n  videoElement.addEventListener('volumechange', volumechangeHandler);\n\n  return () => {\n    videoElement.removeEventListener('volumechange', volumechangeHandler);\n  };\n};\n\nexport default onVolumeChange;\n","/* eslint-disable promise/prefer-await-to-callbacks, callback-return */\nimport {linearEvents} from '../../../../tracker';\n\nconst {impression} = linearEvents;\n\nconst onImpression = ({videoElement}, callback) => {\n  const impressionHandler = () => {\n    const currentTime = videoElement.currentTime;\n\n    if (currentTime >= 2) {\n      callback(impression);\n      videoElement.removeEventListener('timeupdate', impressionHandler);\n    }\n  };\n\n  videoElement.addEventListener('timeupdate', impressionHandler);\n\n  return () => {\n    videoElement.removeEventListener('timeupdate', impressionHandler);\n  };\n};\n\nexport default onImpression;\n","const toFixedDigits = (num, digits) => {\n  let formattedNum = String(num);\n\n  while (formattedNum.length < digits) {\n    formattedNum = '0' + formattedNum;\n  }\n\n  return formattedNum;\n};\n\nexport default toFixedDigits;\n","/* eslint-disable promise/prefer-await-to-callbacks, callback-return */\nimport {linearEvents} from '../../../../tracker';\nimport formatProgress from '../../progress/formatProgress';\n\nconst {progress} = linearEvents;\nconst secondsToMilliseconds = (seconds) => seconds * 1000;\nconst isPercentage = (offset) => {\n  const percentageRegex = /^\\d+(\\.\\d+)?%$/g;\n\n  return percentageRegex.test(offset) && !isNaN(parseFloat(offset));\n};\n\nconst isValid = ({offset, uri}) => {\n  const offsetIsValid = typeof offset === 'number' || isPercentage(offset);\n  const uriIsValid = typeof uri === 'string' && uri.length > 0;\n\n  return offsetIsValid && uriIsValid;\n};\n\nconst offsetToMs = (offset, durationInMs) => {\n  if (typeof offset === 'number') {\n    return offset;\n  }\n\n  return parseFloat(offset) / 100 * durationInMs;\n};\n\nconst onProgress = ({videoElement}, callback, {progressEvents = []} = {}) => {\n  const {duration} = videoElement;\n  const durationInMs = secondsToMilliseconds(duration);\n  let playedMs = 0;\n  let previousCurrentTime = secondsToMilliseconds(videoElement.currentTime);\n  let pendingEvents = progressEvents.filter(isValid)\n    .map(({offset, uri}) => ({\n      offset: offsetToMs(offset, durationInMs),\n      uri\n    }));\n\n  const progressHandler = () => {\n    const {currentTime} = videoElement;\n    const delta = Math.abs(currentTime - previousCurrentTime);\n\n    playedMs += secondsToMilliseconds(delta);\n    previousCurrentTime = currentTime;\n    const {\n      stillPending,\n      toCall\n    } = pendingEvents.reduce((accumulator, event) => {\n      const {offset} = event;\n\n      if (playedMs >= offset) {\n        accumulator.toCall.push(event);\n      } else {\n        accumulator.stillPending.push(event);\n      }\n\n      return accumulator;\n    }, {\n      stillPending: [],\n      toCall: []\n    });\n\n    pendingEvents = stillPending;\n    toCall.forEach(({uri}) => {\n      callback(progress, {\n        contentplayhead: formatProgress(playedMs),\n        progressUri: uri\n      });\n    });\n\n    if (pendingEvents.length === 0) {\n      videoElement.removeEventListener('timeupdate', progressHandler);\n    }\n  };\n\n  if (pendingEvents.length > 0) {\n    videoElement.addEventListener('timeupdate', progressHandler);\n  }\n\n  return () => {\n    videoElement.removeEventListener('timeupdate', progressHandler);\n  };\n};\n\nexport default onProgress;\n","/* eslint-disable callback-return, promise/prefer-await-to-callbacks */\nimport {linearEvents} from '../../../../tracker';\n\nconst {clickThrough} = linearEvents;\n\nconst onClickThrough = ({videoElement, element}, callback, {clickThroughUrl} = {}) => {\n  const placeholder = element || videoElement.parentNode;\n  const anchor = document.createElement('A');\n\n  anchor.classList.add('mol-vast-clickthrough');\n  anchor.style.width = '100%';\n  anchor.style.height = '100%';\n  anchor.style.position = 'absolute';\n  anchor.style.left = 0;\n  anchor.style.top = 0;\n\n  if (clickThroughUrl) {\n    anchor.href = clickThroughUrl;\n    anchor.target = '_blank';\n  }\n\n  anchor.onclick = (event) => {\n    if (Event.prototype.stopPropagation !== undefined) {\n      event.stopPropagation();\n    }\n\n    if (videoElement.paused) {\n      videoElement.play();\n    } else {\n      videoElement.pause();\n\n      callback(clickThrough);\n    }\n  };\n\n  placeholder.appendChild(anchor);\n\n  return () => placeholder.removeChild(anchor);\n};\n\nexport default onClickThrough;\n\n","/* eslint-disable import/max-dependencies */\nimport onFullscreenChange from './onFullscreenChange';\nimport onPlayPause from './onPlayPause';\nimport onRewind from './onRewind';\nimport onSkip from './onSkip';\nimport onError from './onError';\nimport onTimeUpdate from './onTimeUpdate';\nimport onVolumeChange from './onVolumeChange';\nimport onImpression from './onImpression';\nimport onProgress from './onProgress';\nimport onClickThrough from './onClickThrough';\n\nconst handlers = [\n  onClickThrough,\n  onError,\n  onFullscreenChange,\n  onImpression,\n  onPlayPause,\n  onProgress,\n  onRewind,\n  onSkip,\n  onTimeUpdate,\n  onVolumeChange\n];\n\nexport default handlers;\n","import toFixedDigits from './toFixedDigits';\n\nconst formatProgress = (progress) => {\n  const hours = Math.floor(progress / (60 * 60 * 1000));\n  const minutes = Math.floor(progress / (60 * 1000) % 60);\n  const seconds = Math.floor(progress / 1000 % 60);\n  const ms = progress % 1000;\n\n  return toFixedDigits(hours, 2) + ':' + toFixedDigits(minutes, 2) + ':' + toFixedDigits(seconds, 2) + '.' + toFixedDigits(ms, 3);\n};\n\nexport default formatProgress;\n","/* eslint-disable promise/prefer-await-to-callbacks */\nimport {\n  getClickThrough,\n  getSkipOffset\n} from '../../../vastSelectors';\nimport getProgressEvents from '../progress/getProgressEvents';\nimport safeCallback from '../safeCallback';\nimport metricHandlers from './handlers';\n\nconst setupMetricHandlers = ({vastChain, videoAdContainer, hooks}, callback) => {\n  const inlineAd = vastChain[0].ad;\n  const skipoffset = getSkipOffset(inlineAd);\n  const clickThroughUrl = getClickThrough(inlineAd);\n  const progressEvents = getProgressEvents(vastChain);\n  const data = {\n    clickThroughUrl,\n    progressEvents,\n    skipoffset,\n    ...hooks\n  };\n\n  const stopHandlersFns = metricHandlers.map((handler) => safeCallback(handler(videoAdContainer, callback, data)));\n\n  return () => stopHandlersFns.forEach((disconnect) => disconnect());\n};\n\nexport default setupMetricHandlers;\n","import once from '../dom/once';\n\nconst updateMedia = (videoElement, media) => new Promise((resolve) => {\n  const state = {\n    currentTime: videoElement.currentTime,\n    playing: !videoElement.paused\n  };\n\n  if (state.playing) {\n    videoElement.pause();\n  }\n\n  videoElement.src = media.src;\n  videoElement.load();\n\n  once(videoElement, 'loadeddata', () => {\n    videoElement.currentTime = state.currentTime;\n\n    if (state.playing) {\n      videoElement.play();\n    }\n\n    resolve();\n  });\n});\n\nexport default updateMedia;\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        result = wait - timeSinceLastCall;\n\n    return maxing ? nativeMin(result, maxWait - timeSinceLastInvoke) : result;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = debounce;\n","export default window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver;\n","/* eslint-disable promise/prefer-await-to-callbacks */\nimport debounce from 'lodash.debounce';\nimport MutationObserver from './helpers/MutationObserver';\n\nconst validate = (target, callback) => {\n  if (!(target instanceof Element)) {\n    throw new TypeError('Target is not an Element node');\n  }\n\n  if (!(callback instanceof Function)) {\n    throw new TypeError('Callback is not a function');\n  }\n};\nconst noop = () => {};\nconst sizeMutationAttrs = ['style', 'clientWidth', 'clientHeight'];\nconst createResizeMO = (target, callback) => {\n  const observer = new MutationObserver((mutations) => {\n    for (let index = 0; index < mutations.length; index++) {\n      const {attributeName} = mutations[index];\n\n      if (sizeMutationAttrs.includes(attributeName)) {\n      // eslint-disable-next-line callback-return\n        callback();\n      }\n    }\n  });\n\n  observer.observe(target, {\n    attributes: true,\n    characterData: false,\n    childList: true\n  });\n\n  return observer;\n};\nconst mutationHandlers = Symbol('mutationHandlers');\nconst observerKey = Symbol('mutationObserver');\nconst onMutation = (target, callback) => {\n  if (!target[mutationHandlers]) {\n    target[mutationHandlers] = [];\n\n    const execHandlers = (...args) => {\n      if (target[mutationHandlers]) {\n        target[mutationHandlers].forEach((handler) => handler(...args));\n      }\n    };\n\n    target[observerKey] = createResizeMO(target, execHandlers);\n  }\n\n  target[mutationHandlers].push(callback);\n\n  return () => {\n    target[mutationHandlers] = target[mutationHandlers].filter((handler) => handler !== callback);\n\n    if (target[mutationHandlers].length === 0) {\n      target[observerKey].disconnect();\n\n      delete target[mutationHandlers];\n      delete target[observerKey];\n    }\n  };\n};\n\nconst createResizeObjElement = (callback) => {\n  const obj = document.createElement('object');\n\n  // eslint-disable-next-line max-len\n  obj.setAttribute('style', 'display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; pointer-events: none; z-index: -1;');\n  obj.onload = function () {\n    if (this.contentWindow) {\n      this.contentWindow.addEventListener('resize', callback);\n    }\n  };\n  obj.type = 'text/html';\n  obj.data = 'about:blank';\n\n  return obj;\n};\nconst resizeHandlers = Symbol('resizeHandlers');\nconst resizeObject = Symbol('resizeObj');\n\n// Original code http://www.backalleycoder.com/2013/03/18/cross-browser-event-based-element-resize-detection/\nconst onResize = (target, callback) => {\n  if (!target[resizeHandlers]) {\n    target[resizeHandlers] = [];\n    const execHandlers = (...args) => {\n      if (target[resizeHandlers]) {\n        target[resizeHandlers].forEach((handler) => handler(...args));\n      }\n    };\n\n    target[resizeObject] = createResizeObjElement(execHandlers);\n\n    if (getComputedStyle(target).position === 'static') {\n      target.style.position = 'relative';\n    }\n\n    target.appendChild(target[resizeObject]);\n  }\n\n  target[resizeHandlers].push(callback);\n\n  return () => {\n    target[resizeHandlers] = target[resizeHandlers].filter((handler) => handler !== callback);\n\n    if (target[resizeHandlers].length === 0) {\n      target.removeChild(target[resizeObject]);\n      delete target[resizeHandlers];\n      delete target[resizeObject];\n    }\n  };\n};\n\nconst onElementResize = function (target, callback, {threshold = 20} = {}) {\n  validate(target, callback);\n\n  const makeSizeId = ({style, clientHeight, clientWidth}) => [style.width, style.height, clientWidth, clientHeight].join('.');\n  let lastSize = makeSizeId(target);\n  const checkElementSize = () => {\n    const currentSize = makeSizeId(target);\n\n    if (currentSize !== lastSize) {\n      lastSize = currentSize;\n      // eslint-disable-next-line callback-return\n      callback();\n    }\n  };\n\n  const checkElementHandler = debounce(checkElementSize, threshold);\n  const stopObservingMutations = Boolean(MutationObserver) ? onMutation(target, checkElementHandler) : noop;\n  const stopListeningToResize = onResize(target, checkElementHandler);\n\n  return () => {\n    stopObservingMutations();\n    stopListeningToResize();\n  };\n};\n\nexport default onElementResize;\n","/* eslint-disable promise/prefer-await-to-callbacks */\nimport debounce from 'lodash.debounce';\nimport isElementVisible from './helpers/isElementVisible';\n\nlet elementEntries = [];\n\nconst checkIsVisible = (entry) => {\n  const {element, callback, lastInViewport, viewportOffset} = entry;\n  const isInViewport = isElementVisible(element, viewportOffset);\n\n  if (isInViewport !== lastInViewport) {\n    entry.lastInViewport = isInViewport;\n\n    // eslint-disable-next-line callback-return\n    callback(isInViewport);\n  }\n};\n\nconst checkVisibility = () => {\n  for (const entry of elementEntries) {\n    checkIsVisible(entry);\n  }\n};\n\nconst validate = (target, callback) => {\n  if (!(target instanceof Element)) {\n    throw new TypeError('Target is not an Element node');\n  }\n\n  if (!(callback instanceof Function)) {\n    throw new TypeError('Callback is not a function');\n  }\n};\n\nconst onElementVisibilityChange = function (target, callback, {threshold = 100, scrollableElement = window, viewabilityOffset = 0.4} = {}) {\n  validate(target, callback);\n\n  const viewportEventHandler = threshold > 0 ? debounce(checkVisibility) : checkVisibility;\n\n  const entry = {\n    callback,\n    element: target,\n    lastInViewport: false,\n    scrollableElement,\n    viewabilityOffset\n  };\n\n  checkIsVisible(entry);\n  elementEntries.push(entry);\n\n  scrollableElement.addEventListener('scroll', viewportEventHandler);\n\n  if (elementEntries.length === 1) {\n    window.addEventListener('resize', viewportEventHandler);\n    window.addEventListener('orientationchange', viewportEventHandler);\n    document.addEventListener('visibilitychange', viewportEventHandler);\n  }\n\n  return () => {\n    elementEntries = elementEntries.filter((elementEntry) => elementEntry !== entry);\n\n    if (elementEntries.length === 0) {\n      window.removeEventListener('resize', viewportEventHandler);\n      window.removeEventListener('orientationchange', viewportEventHandler);\n      document.removeEventListener('visibilitychange', viewportEventHandler);\n    }\n\n    if (elementEntries.every((elementEntry) => elementEntry.scrollableElement !== scrollableElement)) {\n      scrollableElement.removeEventListener('scroll', viewportEventHandler);\n    }\n  };\n};\n\nexport default onElementVisibilityChange;\n","import document from './document';\nimport window from './window';\n\nconst isElementVisible = function (element, viewabilityOffsetFraction = 0) {\n  const {\n    height,\n    width,\n    top,\n    right,\n    bottom,\n    left\n  } = element.getBoundingClientRect();\n\n  if (!height || !width) {\n    return false;\n  }\n\n  const verticalOffset = height * (1 - viewabilityOffsetFraction);\n  const horizontalOffset = width * (1 - viewabilityOffsetFraction);\n  const viewportHeight = window.innerHeight || document.documentElement.clientHeight;\n  const viewportWidth = window.innerWidth || document.documentElement.clientWidth;\n\n  return !document.hidden &&\n    top + verticalOffset >= 0 &&\n    bottom - verticalOffset <= viewportHeight &&\n    left + horizontalOffset >= 0 &&\n    right - horizontalOffset <= viewportWidth;\n};\n\nexport default isElementVisible;\n","const preventManualProgress = (videoElement) => {\n  // IOS video clock is very unreliable and we need a 3 seconds threshold to ensure that the user forwarded/rewound the ad\n  const PROGRESS_THRESHOLD = 3;\n  let previousTime = 0;\n  let skipAttempts = 0;\n\n  const preventAdSkip = () => {\n    // Ignore ended event if the Ad time was not 'near' the end\n    // and revert time to the previous 'valid' time\n    if (videoElement.duration - previousTime > PROGRESS_THRESHOLD) {\n      // this reduces the video jitter if the IOS skip button is pressed\n      videoElement.pause();\n\n      // we need to trigger the play to put the video element back in a valid state\n      videoElement.play();\n      videoElement.currentTime = previousTime;\n    }\n  };\n\n  const preventAdSeek = () => {\n    const currentTime = videoElement.currentTime;\n    const progressDelta = Math.abs(currentTime - previousTime);\n\n    if (progressDelta > PROGRESS_THRESHOLD) {\n      skipAttempts += 1;\n      if (skipAttempts >= 2) {\n        videoElement.pause();\n      }\n      videoElement.currentTime = previousTime;\n    } else {\n      previousTime = currentTime;\n    }\n  };\n\n  videoElement.addEventListener('timeupdate', preventAdSeek);\n  videoElement.addEventListener('ended', preventAdSkip);\n\n  return () => {\n    videoElement.removeEventListener('timeupdate', preventAdSeek);\n    videoElement.removeEventListener('ended', preventAdSkip);\n  };\n};\n\nexport default preventManualProgress;\n","/* eslint-disable filenames/match-exported */\n/**\n * @class\n * @description Subset of  node's [Emitter class]{@link https://nodejs.org/api/events.html#events_class_eventemitter}\n * @param {Object} logger - Optional logger instance. Must comply to the [Console interface]{@link https://developer.mozilla.org/es/docs/Web/API/Console}.\n */\nclass Emitter {\n  constructor (logger) {\n    this.evts = {};\n    this.logger = logger || console;\n  }\n\n  /**\n   * Adds the listener function to the end of the listeners array for the event named eventName.\n   *\n   * @param {string} eventName - The name of the event.\n   * @param {Function} listener - Listener fn that handles the evt.\n   * @returns {Emitter} - The Emitter instance.\n   */\n  on (eventName, listener) {\n    const evts = this.evts;\n    const evtListeners = evts[eventName] || (evts[eventName] = []);\n\n    evtListeners.push(listener);\n\n    return this;\n  }\n\n  /**\n   * Removes the specified listener from the listener array for the event named eventName.\n   *\n   * @param {string} eventName - The name of the event.\n   * @param {Function} listener - Listener fn that handles the evt.\n   * @returns {Emitter} - The Emitter instance.\n   */\n  removeListener (eventName, listener) {\n    const evts = this.evts;\n    const evtListeners = evts[eventName] || (evts[eventName] = []);\n\n    evts[eventName] = evtListeners.filter((eListener) => eListener !== listener && eListener._ !== listener);\n\n    return this;\n  }\n\n  /**\n   * Removes all listeners, or those of the specified eventName.\n   *\n   * @param {string} eventName - The name of the event. Optional if omitted all listeners will be removed.\n   * @returns {Emitter} - The Emitter instance.\n   */\n  removeAllListeners (eventName) {\n    if (eventName) {\n      this.evts[eventName] = null;\n    } else {\n      this.evts = {};\n    }\n\n    return this;\n  }\n\n  /**\n   * Adds a one time listener function for the event named eventName. The next time eventName is triggered,\n   * this listener is removed and then invoked.\n   *\n   * @param {string} eventName - The name of the event.\n   * @param {Function} listener - Listener fn that handles the evt.\n   * @returns {Emitter} - The Emitter instance.\n   */\n  once (eventName, listener) {\n    const handler = (...args) => {\n      this.removeListener(eventName, handler);\n      listener(...args);\n    };\n\n    handler._ = listener;\n\n    return this.on(eventName, handler);\n  }\n\n  /**\n   * Synchronously calls each of the listeners registered for the event named eventName, in the order they were registered,\n   * passing the supplied arguments to each.\n   *\n   * @param {string} eventName - The name of the event.\n   * @returns {boolean} - Returns true if the event had listeners, false otherwise.\n   */\n  emit (eventName, ...args) {\n    const evts = this.evts;\n    const evtListeners = evts[eventName] || (evts[eventName] = []);\n    const hasListeners = evtListeners.length > 0;\n\n    evtListeners.forEach((handler) => {\n      try {\n        handler(...args);\n      } catch (error) {\n        this.logger.error(error, error.stack);\n      }\n    });\n\n    return hasListeners;\n  }\n}\n\nexport default Emitter;\n","const getResource = ({\n  staticResource,\n  htmlResource,\n  iFrameResource\n} = {}) => staticResource || htmlResource || iFrameResource;\n\nexport default getResource;\n","import {getIcons} from '../../../vastSelectors';\nimport getResource from '../resources/getResource';\n\nconst UNKNOWN = 'UNKNOWN';\nconst uniqBy = (array, uniqValue) => {\n  const seen = {};\n\n  return array.filter((item) => {\n    const key = uniqValue(item);\n\n    if (seen.hasOwnProperty(key)) {\n      return false;\n    }\n\n    seen[key] = true;\n\n    return true;\n  });\n};\n\nconst uniqByResource = (icons) => uniqBy(icons, getResource);\n\nconst groupIconsByProgram = (icons) => icons.reduce((accumulator, icon) => {\n  const {\n    program = UNKNOWN\n  } = icon;\n\n  if (!accumulator[program]) {\n    accumulator[program] = [];\n  }\n\n  accumulator[program].push(icon);\n\n  return accumulator;\n}, {});\n\nconst sortIconByBestPxratio = (icons) => {\n  const devicePixelRatio = window.devicePixelRatio || 0;\n\n  const compareTo = (iconA, iconB) => {\n    const deltaA = Math.abs(devicePixelRatio - (iconA.pxratio || 0));\n    const deltaB = Math.abs(devicePixelRatio - (iconB.pxratio || 0));\n\n    return deltaA - deltaB;\n  };\n\n  return icons.slice(0).sort(compareTo);\n};\n\nconst chooseByPxRatio = (icons) => {\n  if (icons.length === 1) {\n    return icons[0];\n  }\n\n  return sortIconByBestPxratio(icons)[0];\n};\n\nconst chooseIcons = (icons) => {\n  const byProgram = groupIconsByProgram(icons);\n  const programs = Object.keys(byProgram);\n\n  return programs.reduce((accumulator, program) => {\n    if (program === UNKNOWN) {\n      return [\n        ...accumulator,\n        ...byProgram[UNKNOWN]\n      ];\n    }\n\n    return [\n      ...accumulator,\n      chooseByPxRatio(byProgram[program])\n    ];\n  }, []);\n};\n\nconst retrieveIcons = (vastChain) => {\n  const ads = vastChain.map(({ad}) => ad);\n  const icons = ads.reduce((accumulator, ad) => [\n    ...accumulator,\n    ...getIcons(ad) || []\n  ], []);\n\n  if (icons.length > 0) {\n    const uniqIcons = uniqByResource(icons);\n\n    return chooseIcons(uniqIcons);\n  }\n\n  return null;\n};\n\nexport default retrieveIcons;\n","import once from './once';\n\nclass Deferred {\n  constructor () {\n    this.promise = new Promise((resolve, reject) => {\n      this.resolve = resolve;\n      this.reject = reject;\n    });\n  }\n}\n\nconst waitFor = (element, event) => {\n  let pending = true;\n  const {\n    promise,\n    reject,\n    resolve\n  } = new Deferred();\n  const cancelOnce = once(element, event, (...args) => {\n    pending = false;\n    resolve(args);\n  });\n  const cancel = () => {\n    if (pending) {\n      pending = false;\n      cancelOnce();\n      reject(new Error('waitFor was canceled'));\n    }\n  };\n\n  return {\n    cancel,\n    promise\n  };\n};\n\nexport default waitFor;\n","(function(self) {\n  'use strict';\n\n  if (self.fetch) {\n    return\n  }\n\n  var support = {\n    searchParams: 'URLSearchParams' in self,\n    iterable: 'Symbol' in self && 'iterator' in Symbol,\n    blob: 'FileReader' in self && 'Blob' in self && (function() {\n      try {\n        new Blob()\n        return true\n      } catch(e) {\n        return false\n      }\n    })(),\n    formData: 'FormData' in self,\n    arrayBuffer: 'ArrayBuffer' in self\n  }\n\n  if (support.arrayBuffer) {\n    var viewClasses = [\n      '[object Int8Array]',\n      '[object Uint8Array]',\n      '[object Uint8ClampedArray]',\n      '[object Int16Array]',\n      '[object Uint16Array]',\n      '[object Int32Array]',\n      '[object Uint32Array]',\n      '[object Float32Array]',\n      '[object Float64Array]'\n    ]\n\n    var isDataView = function(obj) {\n      return obj && DataView.prototype.isPrototypeOf(obj)\n    }\n\n    var isArrayBufferView = ArrayBuffer.isView || function(obj) {\n      return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n    }\n  }\n\n  function normalizeName(name) {\n    if (typeof name !== 'string') {\n      name = String(name)\n    }\n    if (/[^a-z0-9\\-#$%&'*+.\\^_`|~]/i.test(name)) {\n      throw new TypeError('Invalid character in header field name')\n    }\n    return name.toLowerCase()\n  }\n\n  function normalizeValue(value) {\n    if (typeof value !== 'string') {\n      value = String(value)\n    }\n    return value\n  }\n\n  // Build a destructive iterator for the value list\n  function iteratorFor(items) {\n    var iterator = {\n      next: function() {\n        var value = items.shift()\n        return {done: value === undefined, value: value}\n      }\n    }\n\n    if (support.iterable) {\n      iterator[Symbol.iterator] = function() {\n        return iterator\n      }\n    }\n\n    return iterator\n  }\n\n  function Headers(headers) {\n    this.map = {}\n\n    if (headers instanceof Headers) {\n      headers.forEach(function(value, name) {\n        this.append(name, value)\n      }, this)\n    } else if (Array.isArray(headers)) {\n      headers.forEach(function(header) {\n        this.append(header[0], header[1])\n      }, this)\n    } else if (headers) {\n      Object.getOwnPropertyNames(headers).forEach(function(name) {\n        this.append(name, headers[name])\n      }, this)\n    }\n  }\n\n  Headers.prototype.append = function(name, value) {\n    name = normalizeName(name)\n    value = normalizeValue(value)\n    var oldValue = this.map[name]\n    this.map[name] = oldValue ? oldValue+','+value : value\n  }\n\n  Headers.prototype['delete'] = function(name) {\n    delete this.map[normalizeName(name)]\n  }\n\n  Headers.prototype.get = function(name) {\n    name = normalizeName(name)\n    return this.has(name) ? this.map[name] : null\n  }\n\n  Headers.prototype.has = function(name) {\n    return this.map.hasOwnProperty(normalizeName(name))\n  }\n\n  Headers.prototype.set = function(name, value) {\n    this.map[normalizeName(name)] = normalizeValue(value)\n  }\n\n  Headers.prototype.forEach = function(callback, thisArg) {\n    for (var name in this.map) {\n      if (this.map.hasOwnProperty(name)) {\n        callback.call(thisArg, this.map[name], name, this)\n      }\n    }\n  }\n\n  Headers.prototype.keys = function() {\n    var items = []\n    this.forEach(function(value, name) { items.push(name) })\n    return iteratorFor(items)\n  }\n\n  Headers.prototype.values = function() {\n    var items = []\n    this.forEach(function(value) { items.push(value) })\n    return iteratorFor(items)\n  }\n\n  Headers.prototype.entries = function() {\n    var items = []\n    this.forEach(function(value, name) { items.push([name, value]) })\n    return iteratorFor(items)\n  }\n\n  if (support.iterable) {\n    Headers.prototype[Symbol.iterator] = Headers.prototype.entries\n  }\n\n  function consumed(body) {\n    if (body.bodyUsed) {\n      return Promise.reject(new TypeError('Already read'))\n    }\n    body.bodyUsed = true\n  }\n\n  function fileReaderReady(reader) {\n    return new Promise(function(resolve, reject) {\n      reader.onload = function() {\n        resolve(reader.result)\n      }\n      reader.onerror = function() {\n        reject(reader.error)\n      }\n    })\n  }\n\n  function readBlobAsArrayBuffer(blob) {\n    var reader = new FileReader()\n    var promise = fileReaderReady(reader)\n    reader.readAsArrayBuffer(blob)\n    return promise\n  }\n\n  function readBlobAsText(blob) {\n    var reader = new FileReader()\n    var promise = fileReaderReady(reader)\n    reader.readAsText(blob)\n    return promise\n  }\n\n  function readArrayBufferAsText(buf) {\n    var view = new Uint8Array(buf)\n    var chars = new Array(view.length)\n\n    for (var i = 0; i < view.length; i++) {\n      chars[i] = String.fromCharCode(view[i])\n    }\n    return chars.join('')\n  }\n\n  function bufferClone(buf) {\n    if (buf.slice) {\n      return buf.slice(0)\n    } else {\n      var view = new Uint8Array(buf.byteLength)\n      view.set(new Uint8Array(buf))\n      return view.buffer\n    }\n  }\n\n  function Body() {\n    this.bodyUsed = false\n\n    this._initBody = function(body) {\n      this._bodyInit = body\n      if (!body) {\n        this._bodyText = ''\n      } else if (typeof body === 'string') {\n        this._bodyText = body\n      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n        this._bodyBlob = body\n      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n        this._bodyFormData = body\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this._bodyText = body.toString()\n      } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n        this._bodyArrayBuffer = bufferClone(body.buffer)\n        // IE 10-11 can't handle a DataView body.\n        this._bodyInit = new Blob([this._bodyArrayBuffer])\n      } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n        this._bodyArrayBuffer = bufferClone(body)\n      } else {\n        throw new Error('unsupported BodyInit type')\n      }\n\n      if (!this.headers.get('content-type')) {\n        if (typeof body === 'string') {\n          this.headers.set('content-type', 'text/plain;charset=UTF-8')\n        } else if (this._bodyBlob && this._bodyBlob.type) {\n          this.headers.set('content-type', this._bodyBlob.type)\n        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8')\n        }\n      }\n    }\n\n    if (support.blob) {\n      this.blob = function() {\n        var rejected = consumed(this)\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return Promise.resolve(this._bodyBlob)\n        } else if (this._bodyArrayBuffer) {\n          return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as blob')\n        } else {\n          return Promise.resolve(new Blob([this._bodyText]))\n        }\n      }\n\n      this.arrayBuffer = function() {\n        if (this._bodyArrayBuffer) {\n          return consumed(this) || Promise.resolve(this._bodyArrayBuffer)\n        } else {\n          return this.blob().then(readBlobAsArrayBuffer)\n        }\n      }\n    }\n\n    this.text = function() {\n      var rejected = consumed(this)\n      if (rejected) {\n        return rejected\n      }\n\n      if (this._bodyBlob) {\n        return readBlobAsText(this._bodyBlob)\n      } else if (this._bodyArrayBuffer) {\n        return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n      } else if (this._bodyFormData) {\n        throw new Error('could not read FormData body as text')\n      } else {\n        return Promise.resolve(this._bodyText)\n      }\n    }\n\n    if (support.formData) {\n      this.formData = function() {\n        return this.text().then(decode)\n      }\n    }\n\n    this.json = function() {\n      return this.text().then(JSON.parse)\n    }\n\n    return this\n  }\n\n  // HTTP methods whose capitalization should be normalized\n  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\n\n  function normalizeMethod(method) {\n    var upcased = method.toUpperCase()\n    return (methods.indexOf(upcased) > -1) ? upcased : method\n  }\n\n  function Request(input, options) {\n    options = options || {}\n    var body = options.body\n\n    if (input instanceof Request) {\n      if (input.bodyUsed) {\n        throw new TypeError('Already read')\n      }\n      this.url = input.url\n      this.credentials = input.credentials\n      if (!options.headers) {\n        this.headers = new Headers(input.headers)\n      }\n      this.method = input.method\n      this.mode = input.mode\n      if (!body && input._bodyInit != null) {\n        body = input._bodyInit\n        input.bodyUsed = true\n      }\n    } else {\n      this.url = String(input)\n    }\n\n    this.credentials = options.credentials || this.credentials || 'omit'\n    if (options.headers || !this.headers) {\n      this.headers = new Headers(options.headers)\n    }\n    this.method = normalizeMethod(options.method || this.method || 'GET')\n    this.mode = options.mode || this.mode || null\n    this.referrer = null\n\n    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n      throw new TypeError('Body not allowed for GET or HEAD requests')\n    }\n    this._initBody(body)\n  }\n\n  Request.prototype.clone = function() {\n    return new Request(this, { body: this._bodyInit })\n  }\n\n  function decode(body) {\n    var form = new FormData()\n    body.trim().split('&').forEach(function(bytes) {\n      if (bytes) {\n        var split = bytes.split('=')\n        var name = split.shift().replace(/\\+/g, ' ')\n        var value = split.join('=').replace(/\\+/g, ' ')\n        form.append(decodeURIComponent(name), decodeURIComponent(value))\n      }\n    })\n    return form\n  }\n\n  function parseHeaders(rawHeaders) {\n    var headers = new Headers()\n    // Replace instances of \\r\\n and \\n followed by at least one space or horizontal tab with a space\n    // https://tools.ietf.org/html/rfc7230#section-3.2\n    var preProcessedHeaders = rawHeaders.replace(/\\r?\\n[\\t ]+/g, ' ')\n    preProcessedHeaders.split(/\\r?\\n/).forEach(function(line) {\n      var parts = line.split(':')\n      var key = parts.shift().trim()\n      if (key) {\n        var value = parts.join(':').trim()\n        headers.append(key, value)\n      }\n    })\n    return headers\n  }\n\n  Body.call(Request.prototype)\n\n  function Response(bodyInit, options) {\n    if (!options) {\n      options = {}\n    }\n\n    this.type = 'default'\n    this.status = options.status === undefined ? 200 : options.status\n    this.ok = this.status >= 200 && this.status < 300\n    this.statusText = 'statusText' in options ? options.statusText : 'OK'\n    this.headers = new Headers(options.headers)\n    this.url = options.url || ''\n    this._initBody(bodyInit)\n  }\n\n  Body.call(Response.prototype)\n\n  Response.prototype.clone = function() {\n    return new Response(this._bodyInit, {\n      status: this.status,\n      statusText: this.statusText,\n      headers: new Headers(this.headers),\n      url: this.url\n    })\n  }\n\n  Response.error = function() {\n    var response = new Response(null, {status: 0, statusText: ''})\n    response.type = 'error'\n    return response\n  }\n\n  var redirectStatuses = [301, 302, 303, 307, 308]\n\n  Response.redirect = function(url, status) {\n    if (redirectStatuses.indexOf(status) === -1) {\n      throw new RangeError('Invalid status code')\n    }\n\n    return new Response(null, {status: status, headers: {location: url}})\n  }\n\n  self.Headers = Headers\n  self.Request = Request\n  self.Response = Response\n\n  self.fetch = function(input, init) {\n    return new Promise(function(resolve, reject) {\n      var request = new Request(input, init)\n      var xhr = new XMLHttpRequest()\n\n      xhr.onload = function() {\n        var options = {\n          status: xhr.status,\n          statusText: xhr.statusText,\n          headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n        }\n        options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL')\n        var body = 'response' in xhr ? xhr.response : xhr.responseText\n        resolve(new Response(body, options))\n      }\n\n      xhr.onerror = function() {\n        reject(new TypeError('Network request failed'))\n      }\n\n      xhr.ontimeout = function() {\n        reject(new TypeError('Network request failed'))\n      }\n\n      xhr.open(request.method, request.url, true)\n\n      if (request.credentials === 'include') {\n        xhr.withCredentials = true\n      } else if (request.credentials === 'omit') {\n        xhr.withCredentials = false\n      }\n\n      if ('responseType' in xhr && support.blob) {\n        xhr.responseType = 'blob'\n      }\n\n      request.headers.forEach(function(value, name) {\n        xhr.setRequestHeader(name, value)\n      })\n\n      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)\n    })\n  }\n  self.fetch.polyfill = true\n})(typeof self !== 'undefined' ? self : this);\n","// eslint-disable-next-line import/no-unassigned-import\nimport 'whatwg-fetch';\n\nconst isValidContentType = (contentType) => {\n  const normalisedCT = contentType.toLowerCase();\n\n  return [\n    'text/plain',\n    'text/html'\n  ].some((allowedType) => normalisedCT.includes(allowedType));\n};\n\nconst fetchHtml = async (endpoint) => {\n  const response = await fetch(endpoint);\n  const contentType = response.headers.get('Content-Type');\n\n  if (response.status >= 400) {\n    const error = new Error(response.statusText);\n\n    error.response = response;\n    throw error;\n  }\n\n  if (!isValidContentType(contentType)) {\n    const error = new Error(`fetchHtml error, invalid Content-Type ${contentType}`);\n\n    error.response = response;\n    throw error;\n  }\n\n  return response.text();\n};\n\nexport default fetchHtml;\n","import createHtmlResource from './createHtmlResource';\nimport createIframeResource from './createIframeResource';\nimport createStaticResource from './createStaticResource';\n\nconst createResource = (document, data) => {\n  const {\n    staticResource,\n    htmlResource,\n    iFrameResource\n  } = data;\n\n  if (Boolean(staticResource)) {\n    return createStaticResource(staticResource, {\n      data,\n      document\n    });\n  }\n\n  if (Boolean(htmlResource)) {\n    return createHtmlResource(htmlResource, {\n      data,\n      document\n    });\n  }\n\n  return createIframeResource(iFrameResource, {\n    data,\n    document\n  });\n};\n\nexport default createResource;\n","const createStaticResource = (src, {document, data}) => {\n  const {\n    height,\n    width\n  } = data;\n  const img = document.createElement('IMG');\n\n  if (width) {\n    img.width = width;\n  }\n\n  if (height) {\n    img.height = height;\n  }\n\n  img.src = src;\n\n  return img;\n};\n\nexport default createStaticResource;\n","import fetchHtml from '../fetch/fetchHtml';\n\nconst createHtmlResource = (src, {document, data}) => {\n  const {\n    height,\n    width\n  } = data;\n  const divElement = document.createElement('DIV');\n\n  if (width) {\n    divElement.style.width = `${width}px`;\n  }\n\n  if (height) {\n    divElement.style.height = `${height}px`;\n  }\n\n  fetchHtml(src)\n    // eslint-disable-next-line promise/always-return, promise/prefer-await-to-then\n    .then((html) => {\n      divElement.innerHTML = html;\n\n      divElement.dispatchEvent(new CustomEvent('load'));\n    })\n    .catch(() => {\n      divElement.dispatchEvent(new CustomEvent('error'));\n    });\n\n  return divElement;\n};\n\nexport default createHtmlResource;\n","const createIframeResource = (src, {document, data}) => {\n  const {\n    height,\n    width\n  } = data;\n  const iframeElement = document.createElement('IFRAME');\n\n  iframeElement.src = src;\n  iframeElement.sandbox = 'allow-forms allow-popups allow-scripts';\n\n  if (width) {\n    iframeElement.width = width;\n  }\n\n  if (height) {\n    iframeElement.height = height;\n  }\n\n  iframeElement.src = src;\n\n  iframeElement.frameBorder = 0;\n  iframeElement.style.border = 'none';\n\n  return iframeElement;\n};\n\nexport default createIframeResource;\n\n","/* eslint-disable promise/prefer-await-to-then, promise/always-return */\nimport waitFor from '../dom/waitFor';\nimport createResource from './createResource';\n\nconst noop = () => {};\nconst loadResource = (icon, {document, placeholder}) => new Promise((resolve, reject) => {\n  try {\n    const resourceElement = createResource(document, icon);\n    const resourceErrorWait = waitFor(resourceElement, 'error');\n    const resourceLoadWait = waitFor(resourceElement, 'load');\n    const cleanUp = () => {\n      if (placeholder.contains(resourceElement)) {\n        placeholder.removeChild(resourceElement);\n        resourceElement.style.zIndex = 0;\n      }\n    };\n\n    resourceErrorWait.promise\n      .then(() => {\n        resourceLoadWait.cancel();\n        cleanUp();\n\n        reject(new Error('Error loading resource'));\n      })\n      .catch(noop);\n\n    resourceLoadWait.promise\n      .then(() => {\n        resourceErrorWait.cancel();\n        cleanUp();\n\n        resolve(resourceElement);\n      })\n      .catch(noop);\n\n    // Some browsers will not load the resource if they are not added to the DOM\n    resourceElement.style.zIndex = -9999;\n    placeholder.appendChild(resourceElement);\n  } catch (error) {\n    reject(error);\n  }\n});\n\nexport default loadResource;\n","const isCustomXposition = (xPosition) => !['left', 'right'].includes(String(xPosition).toLowerCase());\nconst isCustomYPosition = (yPosition) => !['top', 'bottom'].includes(String(yPosition).toLowerCase());\nconst calculateIconLeft = (dynamicPos, iconWidth, drawnIcons, phWidth) => {\n  const drawnIconsWidth = drawnIcons.reduce((accumulator, icon) => accumulator + icon.width + 1, 0);\n\n  if (dynamicPos === 'left') {\n    return drawnIconsWidth;\n  }\n\n  return phWidth - drawnIconsWidth - iconWidth;\n};\n\nconst calculateIconTop = (dynamicPos, iconHeight, phHeight) => {\n  if (dynamicPos === 'top') {\n    return 0;\n  }\n\n  return phHeight - iconHeight;\n};\n\nconst updateIcon = (icon, iconElement, {drawnIcons, placeholder}) => {\n  const oldSignature = icon.signature;\n  const rect = iconElement.getBoundingClientRect();\n  const phRect = placeholder.getBoundingClientRect();\n  const width = icon.width || rect.width;\n  const height = icon.height || rect.height;\n  const xPosition = icon.xPosition || 'right';\n  const yPosition = icon.yPosition || 'top';\n  let left;\n  let top;\n\n  if (isCustomXposition(xPosition)) {\n    left = xPosition;\n  } else {\n    const icons = drawnIcons.filter((dIcon) => dIcon.xPosition === xPosition && dIcon.yPosition === yPosition);\n\n    left = calculateIconLeft(xPosition, width, icons, phRect.width);\n  }\n  if (isCustomYPosition(yPosition)) {\n    top = yPosition;\n  } else {\n    top = calculateIconTop(yPosition, height, phRect.height);\n  }\n\n  const signature = `${left}-${top}_${width}x${height}`;\n\n  return Object.assign(icon, {\n    height,\n    left,\n    signature,\n    top,\n    updated: oldSignature !== signature,\n    width\n  });\n};\n\nexport default updateIcon;\n","/* eslint-disable no-shadow */\nconst calculateArea = ({height, width}) => height * width;\n\nexport const hasSpace = (newIcon, config) => {\n  const {\n    drawnIcons,\n    placeholder\n  } = config;\n  const placeholderArea = calculateArea(placeholder.getBoundingClientRect());\n  const iconArea = calculateArea(newIcon);\n  const usedIconsArea = drawnIcons.reduce((accumulator, icon) => accumulator + calculateArea(icon), 0);\n\n  return iconArea + usedIconsArea <= placeholderArea * 0.35;\n};\n\nexport const withinBoundaries = (newIcon, {placeholder}) => {\n  const phRect = placeholder.getBoundingClientRect();\n\n  return newIcon.left >= 0 &&\n    newIcon.left + newIcon.width <= phRect.width &&\n    newIcon.top >= 0 &&\n    newIcon.top + newIcon.height <= phRect.height;\n};\n\nconst right = ({left, width}) => left + width;\nconst left = ({left}) => left;\nconst top = ({top}) => top;\nconst bottom = ({top, height}) => top + height;\nconst overlap = (newIcon, drawnIcon) => {\n  if (left(newIcon) > right(drawnIcon) ||\n    right(newIcon) < left(drawnIcon) ||\n    bottom(newIcon) < top(drawnIcon) ||\n    top(newIcon) > bottom(drawnIcon)) {\n    return false;\n  }\n\n  return true;\n};\n\nexport const withoutOverlaps = (newIcon, {drawnIcons}) => !drawnIcons.some((drawnIcon) => overlap(newIcon, drawnIcon));\n\nconst canBeRendered = (newIcon, config) => {\n  const thereIsSpace = hasSpace(newIcon, config);\n  const isWithinTheContentArea = withinBoundaries(newIcon, config);\n  const doesNotOverlap = withoutOverlaps(newIcon, config);\n\n  return thereIsSpace && isWithinTheContentArea && doesNotOverlap;\n};\n\nexport default canBeRendered;\n","import loadResource from '../resources/loadResource';\nimport updateIcon from './updateIcon';\nimport canBeRendered from './canBeRendered';\n\nconst noop = () => {};\nconst wrapWithClickThrough = (iconElement, icon, {onIconClick = noop} = {}) => {\n  const anchor = document.createElement('A');\n\n  if (icon.iconClickthrough) {\n    anchor.href = icon.iconClickthrough;\n    anchor.target = '_blank';\n  }\n\n  // NOTE: if iframe icon disable pointer events so that clickThrough and click tracking work\n  if (Boolean(icon.iFrameResource)) {\n    iconElement.style.pointerEvents = 'none';\n  }\n\n  anchor.onclick = (event) => {\n    if (Event.prototype.stopPropagation !== undefined) {\n      event.stopPropagation();\n    }\n\n    onIconClick(icon);\n  };\n\n  anchor.appendChild(iconElement);\n\n  return anchor;\n};\n\nconst createIcon = async (icon, config) => {\n  if (!icon.element) {\n    const iconResource = await loadResource(icon, config);\n\n    iconResource.width = '100%';\n    iconResource.height = '100%';\n    iconResource.style.height = '100%';\n    iconResource.style.width = '100%';\n\n    icon.element = wrapWithClickThrough(iconResource, icon, config);\n  }\n\n  return icon.element;\n};\n\nconst updateIconElement = (iconElement, icon) => {\n  const {\n    height,\n    width,\n    left,\n    top,\n    yPosition\n  } = icon;\n\n  iconElement.height = height;\n  iconElement.width = width;\n  iconElement.style.position = 'absolute';\n  iconElement.style.left = `${left}px`;\n\n  // NOTE: This if is a bit odd but some browser don't calculate the placeholder height pixel perfect and,\n  //       setting the top of the icon will change the size of the icon's placeholder this if prevents that situation\n  if (yPosition === 'bottom') {\n    iconElement.style.bottom = '0';\n  } else {\n    iconElement.style.top = `${top}px`;\n  }\n  iconElement.style.height = `${height}px`;\n  iconElement.style.width = `${width}px`;\n\n  return iconElement;\n};\n\nconst renderIcon = async (icon, config) => {\n  const {placeholder} = config;\n  const iconElement = await createIcon(icon, config);\n  const updatedIcon = updateIcon(icon, iconElement, config);\n\n  if (canBeRendered(updatedIcon, config)) {\n    if (!iconElement.parentNode || icon.updated) {\n      placeholder.appendChild(updateIconElement(iconElement, updatedIcon));\n    }\n  } else {\n    if (iconElement.parentNode) {\n      iconElement.parentNode.removeChild(iconElement);\n    }\n    throw new Error('Icon can\\'t be rendered');\n  }\n\n  return updatedIcon;\n};\n\nexport default renderIcon;\n","/* eslint-disable promise/prefer-await-to-then */\nimport renderIcon from './renderIcon';\nimport canBeShown from './canBeShown';\n\nconst renderIcons = (icons, {onIconClick, videoAdContainer, logger}) => {\n  const {\n    element,\n    videoElement\n  } = videoAdContainer;\n  const drawnIcons = [];\n  const {\n    iconsToShow,\n    otherIcons\n  } = icons.reduce((accumulator, icon) => {\n    if (canBeShown(icon, videoElement)) {\n      accumulator.iconsToShow.push(icon);\n    } else {\n      accumulator.otherIcons.push(icon);\n    }\n\n    return accumulator;\n  }, {\n    iconsToShow: [],\n    otherIcons: []\n  });\n\n  otherIcons.forEach(({element: iconElement}) => {\n    if (iconElement && iconElement.parentNode) {\n      iconElement.parentNode.removeChild(iconElement);\n    }\n  });\n\n  return iconsToShow\n    .reduce((promise, icon) => promise\n      .then(() => renderIcon(icon, {\n        document,\n        drawnIcons,\n        onIconClick,\n        placeholder: element\n      }))\n      .then((renderedIcon) => drawnIcons.push(renderedIcon))\n      .catch((error) => logger.log(error))\n    , Promise.resolve(drawnIcons))\n    .then(() => drawnIcons);\n};\n\nexport default renderIcons;\n","const canBeShown = (icon, videoElement) => {\n  const currentTimeInMs = videoElement.currentTime * 1000;\n  const videoDurationInMs = videoElement.duration * 1000;\n  const offset = icon.offset || 0;\n  const duration = icon.duration || videoDurationInMs;\n\n  return offset <= currentTimeInMs && currentTimeInMs - offset <= duration;\n};\n\nexport default canBeShown;\n","import renderIcons from './renderIcons';\n\nconst firstRenderPending = Symbol('firstRenderPending');\nconst noop = () => {};\n\nconst hasPendingIconRedraws = (icons, videoElement) => {\n  const currentTimeInMs = videoElement.currentTime * 1000;\n  const videoDurationInMs = videoElement.duration * 1000;\n\n  const iconsPendingToRedraw = icons\n    .filter((icon) => !icon.offset || icon.offset < currentTimeInMs);\n  const iconsPendingToBeRemoved = icons\n    .filter((icon) => icon.duration && icon.duration < videoDurationInMs);\n\n  return iconsPendingToRedraw.length > 0 || iconsPendingToBeRemoved.length > 0;\n};\n\nconst removeDrawnIcons = (icons) => icons\n  .filter(({element}) => Boolean(element) && Boolean(element.parentNode))\n  .forEach(({element}) => element.parentNode.removeChild(element));\n\nconst addIcons = (icons, {videoAdContainer, onIconView = noop, onIconClick = noop, ...rest} = {}) => {\n  const {videoElement, element} = videoAdContainer;\n  const drawIcons = async () => {\n    const drawnIcons = await renderIcons(icons, {\n      onIconClick,\n      videoAdContainer,\n      ...rest\n    });\n\n    element.dispatchEvent(new CustomEvent('iconsDrawn'));\n\n    drawnIcons.forEach((icon) => {\n      if (icon[firstRenderPending]) {\n        onIconView(icon);\n        icon[firstRenderPending] = false;\n      }\n    });\n  };\n\n  icons.forEach((icon) => {\n    icon[firstRenderPending] = true;\n  });\n\n  return {\n    drawIcons,\n    hasPendingIconRedraws: () => hasPendingIconRedraws(icons, videoElement),\n    removeIcons: () => removeDrawnIcons(icons)\n  };\n};\n\nexport default addIcons;\n","const viewmode = (width, height) => {\n  const isFullscreen = width + 100 > innerWidth && height + 100 > innerHeight;\n\n  if (isFullscreen) {\n    return 'fullscreen';\n  }\n\n  if (width < 400) {\n    return 'thumbnail';\n  }\n\n  return 'normal';\n};\n\nexport default viewmode;\n","/* eslint-disable promise/prefer-await-to-callbacks */\nimport {linearEvents} from '../tracker';\nimport {finish} from './adUnitEvents';\nimport {\n  onElementVisibilityChange,\n  onElementResize\n} from './helpers/dom/elementObservers';\nimport preventManualProgress from './helpers/dom/preventManualProgress';\nimport Emitter from './helpers/Emitter';\nimport retrieveIcons from './helpers/icons/retrieveIcons';\nimport addIcons from './helpers/icons/addIcons';\nimport viewmode from './helpers/vpaid/viewmode';\nimport safeCallback from './helpers/safeCallback';\n\nconst {\n  start,\n  iconClick,\n  iconView\n} = linearEvents;\n\n// eslint-disable-next-line id-match\nexport const _protected = Symbol('_protected');\n\n/**\n * @class\n * @extends Emitter\n * @alias VideoAdUnit\n * @implements LinearEvents\n * @description This class provides shared logic among all the ad units.\n */\nclass VideoAdUnit extends Emitter {\n [_protected] = {\n   finish: () => {\n     this[_protected].finished = true;\n     this[_protected].onFinishCallbacks.forEach((callback) => callback());\n\n     this.emit(\n       finish,\n       {\n         adUnit: this,\n         type: finish\n       });\n   },\n   finished: false,\n   onErrorCallbacks: [],\n   onFinishCallbacks: [],\n   started: false,\n   throwIfCalled: () => {\n     throw new Error('VideoAdUnit method must be implemented on child class');\n   },\n   throwIfFinished: () => {\n     if (this.isFinished()) {\n       throw new Error('VideoAdUnit is finished');\n     }\n   }\n };\n\n   /** Ad unit type */\n   type=null;\n\n  /** If an error occurs it will contain the reference to the error otherwise it will be bull */\n  error = null;\n\n  /** If an error occurs it will contain the Vast Error code of the error */\n  errorCode = null;\n\n  /**\n   * Creates a {@link VideoAdUnit}.\n   *\n   * @param {VastChain} vastChain - The {@link VastChain} with all the {@link VastResponse}\n   * @param {VideoAdContainer} videoAdContainer - container instance to place the ad\n   * @param {Object} [options] - Options Map. The allowed properties are:\n   * @param {Console} [options.logger] - Optional logger instance. Must comply to the [Console interface]{@link https://developer.mozilla.org/es/docs/Web/API/Console}.\n   * Defaults to `window.console`\n   * @param {boolean} [options.viewability] - if true it will pause the ad whenever is not visible for the viewer.\n   * Defaults to `false`\n   * @param {boolean} [options.responsive] - if true it will resize the ad unit whenever the ad container changes sizes\n   * Defaults to `false`\n   */\n  constructor (vastChain, videoAdContainer, {viewability = false, responsive = false, logger = console} = {}) {\n    super(logger);\n\n    const {\n      onFinishCallbacks\n    } = this[_protected];\n\n    /** Reference to the {@link VastChain} used to load the ad. */\n    this.vastChain = vastChain;\n\n    /** Reference to the {@link VideoAdContainer} that contains the ad. */\n    this.videoAdContainer = videoAdContainer;\n\n    /** Array of {@link VastIcon} definitions to display from the passed {@link VastChain} or null if there are no icons.*/\n    this.icons = retrieveIcons(vastChain);\n\n    onFinishCallbacks.push(preventManualProgress(this.videoAdContainer.videoElement));\n\n    if (this.icons) {\n      const {\n        drawIcons,\n        hasPendingIconRedraws,\n        removeIcons\n      } = addIcons(this.icons, {\n        logger,\n        onIconClick: (icon) => this.emit(iconClick, {\n          adUnit: this,\n          data: icon,\n          type: iconClick\n        }),\n        onIconView: (icon) => this.emit(iconView, {\n          adUnit: this,\n          data: icon,\n          type: iconView\n        }),\n        videoAdContainer\n      });\n\n      this[_protected].drawIcons = drawIcons;\n      this[_protected].removeIcons = removeIcons;\n      this[_protected].hasPendingIconRedraws = hasPendingIconRedraws;\n\n      onFinishCallbacks.push(removeIcons);\n    }\n\n    if (viewability) {\n      this.once(start, () => {\n        const unsubscribe = onElementVisibilityChange(this.videoAdContainer.element, (visible) => {\n          if (this.isFinished()) {\n            return;\n          }\n\n          if (visible) {\n            this.resume();\n          } else {\n            this.pause();\n          }\n        });\n\n        onFinishCallbacks.push(unsubscribe);\n      });\n    }\n\n    if (responsive) {\n      this.once(start, () => {\n        const {element} = this.videoAdContainer;\n\n        this[_protected].size = {\n          height: element.clientHeight,\n          viewmode: viewmode(element.clientWidth, element.clientHeight),\n          width: element.clientWidth\n        };\n        const unsubscribe = onElementResize(element, () => {\n          if (this.isFinished()) {\n            return;\n          }\n\n          const prevSize = this[_protected].size;\n          const height = element.clientHeight;\n          const width = element.clientWidth;\n\n          if (height !== prevSize.height || width !== prevSize.width) {\n            this.resize(width, height, viewmode(width, height));\n          }\n        });\n\n        onFinishCallbacks.push(unsubscribe);\n      });\n    }\n  }\n\n  /*\n   * Starts the ad unit.\n   *\n   * @throws if called twice.\n   * @throws if ad unit is finished.\n   */\n  start () {\n    this[_protected].throwIfCalled();\n  }\n\n  /**\n   * Resumes a previously paused ad unit.\n   *\n   * @throws if ad unit is not started.\n   * @throws if ad unit is finished.\n   */\n  resume () {\n    this[_protected].throwIfCalled();\n  }\n\n  /**\n   * Pauses the ad unit.\n   *\n   * @throws if ad unit is not started.\n   * @throws if ad unit is finished.\n   */\n  pause () {\n    this[_protected].throwIfCalled();\n  }\n\n  /**\n   * Sets the volume of the ad unit.\n   *\n   * @throws if ad unit is not started.\n   * @throws if ad unit is finished.\n   *\n   * @param {number} volume - must be a value between 0 and 1;\n   */\n  // eslint-disable-next-line no-unused-vars\n  setVolume (volume) {\n    this[_protected].throwIfCalled();\n  }\n\n  /**\n   * Gets the volume of the ad unit.\n   *\n   * @throws if ad unit is not started.\n   * @throws if ad unit is finished.\n   *\n   * @returns {number} - the volume of the ad unit.\n   */\n  getVolume () {\n    this[_protected].throwIfCalled();\n  }\n\n  /**\n   * Cancels the ad unit.\n   *\n   * @throws if ad unit is finished.\n   */\n  cancel () {\n    this[_protected].throwIfCalled();\n  }\n\n  /**\n   * Returns the duration of the ad Creative or 0 if there is no creative.\n   *\n   * @returns {number} - the duration of the ad unit.\n   */\n  duration () {\n    this[_protected].throwIfCalled();\n  }\n\n  /**\n   * Returns true if the ad is paused and false otherwise\n   */\n  paused () {\n    this[_protected].throwIfCalled();\n  }\n\n  /**\n   * Returns the current time of the ad Creative or 0 if there is no creative.\n   *\n   * @returns {number} - the current time of the ad unit.\n   */\n  currentTime () {\n    this[_protected].throwIfCalled();\n  }\n\n  /**\n   * Register a callback function that will be called whenever the ad finishes. No matter if it was finished because de ad ended, or cancelled or there was an error playing the ad.\n   *\n   * @throws if ad unit is finished.\n   *\n   * @param {Function} callback - will be called once the ad unit finished\n   */\n  onFinish (callback) {\n    if (typeof callback !== 'function') {\n      throw new TypeError('Expected a callback function');\n    }\n\n    this[_protected].onFinishCallbacks.push(safeCallback(callback, this.logger));\n  }\n\n  /**\n   * Register a callback function that will be called if there is an error while running the ad.\n   *\n   * @throws if ad unit is finished.\n   *\n   * @param {Function} callback - will be called on ad unit error passing the Error instance  and an object with the adUnit and the  {@link VastChain}.\n   */\n  onError (callback) {\n    if (typeof callback !== 'function') {\n      throw new TypeError('Expected a callback function');\n    }\n\n    this[_protected].onErrorCallbacks.push(safeCallback(callback, this.logger));\n  }\n\n  /**\n   * @returns {boolean} - true if the ad unit is finished and false otherwise\n   */\n  isFinished () {\n    return this[_protected].finished;\n  }\n\n  /**\n   * @returns {boolean} - true if the ad unit has started and false otherwise\n   */\n  isStarted () {\n    return this[_protected].started;\n  }\n\n  /**\n   * This method resizes the ad unit to fit the available space in the passed {@link VideoAdContainer}\n   *\n   * @throws if ad unit is not started.\n   * @throws if ad unit is finished.\n   *\n   * @returns {Promise} - that resolves once the unit was resized\n   */\n  async resize (width, height, mode) {\n    this[_protected].size = {\n      height,\n      viewmode: mode,\n      width\n    };\n\n    if (this.isStarted() && !this.isFinished() && this.icons) {\n      await this[_protected].removeIcons();\n      await this[_protected].drawIcons();\n    }\n  }\n}\n\nexport default VideoAdUnit;\n","/* eslint-disable promise/prefer-await-to-callbacks */\nimport {linearEvents} from '../tracker';\nimport findBestMedia from './helpers/media/findBestMedia';\nimport once from './helpers/dom/once';\nimport setupMetricHandlers from './helpers/metrics/setupMetricHandlers';\nimport updateMedia from './helpers/media/updateMedia';\nimport VideoAdUnit, {_protected} from './VideoAdUnit';\n\nconst {\n  complete,\n  error: errorEvt,\n  skip\n} = linearEvents;\n\n// eslint-disable-next-line id-match\nconst _private = Symbol('_private');\n\n/**\n * @class\n * @extends VideoAdUnit\n * @alias VastAdUnit\n * @implements LinearEvents\n * @description This class provides everything necessary to run a Vast ad.\n */\nclass VastAdUnit extends VideoAdUnit {\n  [_private] = {\n    handleMetric: (event, data) => {\n      switch (event) {\n      case complete: {\n        this[_protected].finish();\n        break;\n      }\n      case errorEvt: {\n        this.error = data;\n        this.errorCode = this.error && this.error.code ? this.error.code : 405;\n        this[_protected].onErrorCallbacks.forEach((callback) => callback(this.error, {\n          adUnit: this,\n          vastChain: this.vastChain\n        }));\n        this[_protected].finish();\n        break;\n      }\n      case skip: {\n        this.cancel();\n        break;\n      }\n      }\n\n      this.emit(event, {\n        adUnit: this,\n        type: event\n      });\n    }\n  };\n\n  assetUri = null;\n\n  /** Ad unit type. Will be `VAST` for VastAdUnit */\n  type='VAST';\n\n  /**\n   * Creates a {VastAdUnit}.\n   *\n   * @param {VastChain} vastChain - The {@link VastChain} with all the {@link VastResponse}\n   * @param {VideoAdContainer} videoAdContainer - container instance to place the ad\n   * @param {Object} [options] - Options Map. The allowed properties are:\n   * @param {Console} [options.logger] - Optional logger instance. Must comply to the [Console interface]{@link https://developer.mozilla.org/es/docs/Web/API/Console}.\n   * Defaults to `window.console`\n   * @param {Object} [options.hooks] - Optional map with hooks to configure the behaviour of the ad.\n   * @param {Function} [options.hooks.createSkipControl] - If provided it will be called to generate the skip control. Must return a clickable [HTMLElement](https://developer.mozilla.org/es/docs/Web/API/HTMLElement) that is detached from the DOM.\n   * @param {boolean} [options.viewability] - if true it will pause the ad whenever is not visible for the viewer.\n   * Defaults to `false`\n   * @param {boolean} [options.responsive] - if true it will resize the ad unit whenever the ad container changes sizes.\n   * Defaults to `false`\n   */\n  constructor (vastChain, videoAdContainer, options = {}) {\n    super(vastChain, videoAdContainer, options);\n\n    const {onFinishCallbacks} = this[_protected];\n    const {handleMetric} = this[_private];\n\n    this.hooks = options.hooks || {};\n\n    const removeMetricHandlers = setupMetricHandlers({\n      hooks: this.hooks,\n      vastChain: this.vastChain,\n      videoAdContainer: this.videoAdContainer\n    }, handleMetric);\n\n    onFinishCallbacks.push(removeMetricHandlers);\n  }\n\n  /**\n   * Starts the ad unit.\n   *\n   * @throws if called twice.\n   * @throws if ad unit is finished.\n   */\n  async start () {\n    this[_protected].throwIfFinished();\n\n    if (this.isStarted()) {\n      throw new Error('VastAdUnit already started');\n    }\n\n    const inlineAd = this.vastChain[0].ad;\n    const {videoElement, element} = this.videoAdContainer;\n    const media = findBestMedia(inlineAd, videoElement, element);\n\n    if (Boolean(media)) {\n      if (this.icons) {\n        const drawIcons = async () => {\n          if (this.isFinished()) {\n            return;\n          }\n\n          await this[_protected].drawIcons();\n\n          if (this[_protected].hasPendingIconRedraws() && !this.isFinished()) {\n            once(videoElement, 'timeupdate', drawIcons);\n          }\n        };\n\n        await drawIcons();\n      }\n\n      videoElement.src = media.src;\n      this.assetUri = media.src;\n      videoElement.play();\n    } else {\n      const adUnitError = new Error('Can\\'t find a suitable media to play');\n\n      adUnitError.code = 403;\n      this[_private].handleMetric(errorEvt, adUnitError);\n    }\n\n    this[_protected].started = true;\n  }\n\n  /**\n   * Resumes a previously paused ad unit.\n   *\n   * @throws if ad unit is not started.\n   * @throws if ad unit is finished.\n   */\n  resume () {\n    this.videoAdContainer.videoElement.play();\n  }\n\n  /**\n   * Pauses the ad unit.\n   *\n   * @throws if ad unit is not started.\n   * @throws if ad unit is finished.\n   */\n  pause () {\n    this.videoAdContainer.videoElement.pause();\n  }\n\n  /**\n   * Returns true if the ad is paused and false otherwise\n   */\n  paused () {\n    return this.videoAdContainer.videoElement.paused;\n  }\n\n  /**\n   * Sets the volume of the ad unit.\n   *\n   * @throws if ad unit is not started.\n   * @throws if ad unit is finished.\n   *\n   * @param {number} volume - must be a value between 0 and 1;\n   */\n  setVolume (volume) {\n    this.videoAdContainer.videoElement.volume = volume;\n  }\n\n  /**\n   * Gets the volume of the ad unit.\n   *\n   * @throws if ad unit is not started.\n   * @throws if ad unit is finished.\n   *\n   * @returns {number} - the volume of the ad unit.\n   */\n  getVolume () {\n    return this.videoAdContainer.videoElement.volume;\n  }\n\n  /**\n   * Cancels the ad unit.\n   *\n   * @throws if ad unit is finished.\n   */\n  cancel () {\n    this[_protected].throwIfFinished();\n\n    this.videoAdContainer.videoElement.pause();\n\n    this[_protected].finish();\n  }\n\n  /**\n   * Returns the duration of the ad Creative or 0 if there is no creative.\n   *\n   * @returns {number} - the duration of the ad unit.\n   */\n  duration () {\n    if (!this.isStarted()) {\n      return 0;\n    }\n\n    return this.videoAdContainer.videoElement.duration;\n  }\n\n  /**\n   * Returns the current time of the ad Creative or 0 if there is no creative.\n   *\n   * @returns {number} - the current time of the ad unit.\n   */\n  currentTime () {\n    if (!this.isStarted()) {\n      return 0;\n    }\n\n    return this.videoAdContainer.videoElement.currentTime;\n  }\n\n  /**\n   * This method resizes the ad unit to fit the available space in the passed {@link VideoAdContainer}\n   *\n   * @param width {number} - the new width of the ad container.\n   * @param height {number} - the new height of the ad container.\n   * @param viewmode {string} - fullscreen | normal | thumbnail\n   * @returns {Promise} - that resolves once the unit was resized\n   */\n  async resize (width, height, viewmode) {\n    await super.resize(width, height, viewmode);\n\n    if (this.isStarted() && !this.isFinished()) {\n      const inlineAd = this.vastChain[0].ad;\n      const {videoElement, element} = this.videoAdContainer;\n      const media = findBestMedia(inlineAd, videoElement, element);\n\n      if (Boolean(media) && videoElement.src !== media.src) {\n        updateMedia(videoElement, media);\n      }\n    }\n  }\n}\n\nexport default VastAdUnit;\n","export const SUPPORTED_MIMETYPES = [\n  'text/javascript',\n  'text/javascript1.0',\n  'text/javascript1.2',\n  'text/javascript1.4',\n  'text/jscript',\n  'application/javascript',\n  'application/x-javascript',\n  'text/ecmascript',\n  'text/ecmascript1.0',\n  'text/ecmascript1.2',\n  'text/ecmascript1.4',\n  'text/livescript',\n  'application/ecmascript',\n  'application/x-ecmascript'\n];\n\nconst isSupported = ({type}) => SUPPORTED_MIMETYPES.some((mimetype) => mimetype === type);\n\nexport default isSupported;\n","import {getInteractiveFiles} from '../../../vastSelectors';\nimport isSupported from './isSupported';\n\nconst loadCreative = async (vastChain, videoAdContainer) => {\n  const creative = (getInteractiveFiles(vastChain[0].ad) || []).filter(isSupported)[0];\n\n  if (!creative) {\n    throw new TypeError('VastChain does not contain a supported vpaid creative');\n  }\n\n  const {src, type} = creative;\n\n  await videoAdContainer.addScript(src, {type});\n\n  const context = videoAdContainer.executionContext;\n\n  return context.getVPAIDAd();\n};\n\nexport default loadCreative;\n","export const handshakeVersion = 'handshakeVersion';\nexport const initAd = 'initAd';\nexport const resizeAd = 'resizeAd';\nexport const startAd = 'startAd';\nexport const stopAd = 'stopAd';\nexport const pauseAd = 'pauseAd';\nexport const resumeAd = 'resumeAd';\nexport const expandAd = 'expandAd';\nexport const collapseAd = 'collapseAd';\nexport const getAdLinear = 'getAdLinear';\nexport const getAdWidth = 'getAdWidth';\nexport const getAdHeight = 'getAdHeight';\nexport const getAdExpanded = 'getAdExpanded';\nexport const getAdSkippableState = 'getAdSkippableState';\nexport const getAdRemainingTime = 'getAdRemainingTime';\nexport const getAdDuration = 'getAdDuration';\nexport const getAdVolume = 'getAdVolume';\nexport const getAdCompanions = 'getAdCompanions';\nexport const getAdIcons = 'getAdIcons';\nexport const setAdVolume = 'setAdVolume';\nexport const adLoaded = 'AdLoaded';\nexport const adStarted = 'AdStarted';\nexport const adStopped = 'AdStopped';\nexport const adSkipped = 'AdSkipped';\nexport const adSkippableStateChange = 'AdSkippableStateChange';\nexport const adSizeChange = 'AdSizeChange';\nexport const adLinearChange = 'AdLinearChange';\nexport const adDurationChange = 'AdDurationChange';\nexport const adExpandedChange = 'AdExpandedChange';\nexport const adRemainingTimeChange = 'AdRemainingTimeChange';\nexport const adVolumeChange = 'AdVolumeChange';\nexport const adImpression = 'AdImpression';\nexport const adVideoStart = 'AdVideoStart';\nexport const adVideoFirstQuartile = 'AdVideoFirstQuartile';\nexport const adVideoMidpoint = 'AdVideoMidpoint';\nexport const adVideoThirdQuartile = 'AdVideoThirdQuartile';\nexport const adVideoComplete = 'AdVideoComplete';\nexport const adClickThru = 'AdClickThru';\nexport const adInteraction = 'AdInteraction';\nexport const adUserAcceptInvitation = 'AdUserAcceptInvitation';\nexport const adUserMinimize = 'AdUserMinimize';\nexport const adUserClose = 'AdUserClose';\nexport const adPaused = 'AdPaused';\nexport const adPlaying = 'AdPlaying';\nexport const adLog = 'AdLog';\nexport const adError = 'AdError';\n\nexport const EVENTS = [\n  adLoaded,\n  adStarted,\n  adStopped,\n  adSkipped,\n  adSkippableStateChange,\n  adSizeChange,\n  adLinearChange,\n  adDurationChange,\n  adExpandedChange,\n  adRemainingTimeChange,\n  adVolumeChange,\n  adImpression,\n  adVideoStart,\n  adVideoFirstQuartile,\n  adVideoMidpoint,\n  adVideoThirdQuartile,\n  adVideoComplete,\n  adClickThru,\n  adInteraction,\n  adUserAcceptInvitation,\n  adUserMinimize,\n  adUserClose,\n  adPaused,\n  adPlaying,\n  adLog,\n  adError\n];\n\n// NOTE: `skipAd` is not supported on VPAID 1.0 and since it is a convenient method that has proven problematic we have decided not to support custom skip control for vpaid creatives\n// otherwise we risk showing the button twice if the creative is badly written and tell the sdk to show a custom skip control while showing its own control.\nexport const METHODS = [\n  handshakeVersion,\n  initAd,\n  resizeAd,\n  startAd,\n  stopAd,\n  pauseAd,\n  resumeAd,\n  expandAd,\n  collapseAd\n];\n\nexport const GETTERS = [\n  getAdLinear,\n  getAdExpanded,\n  getAdRemainingTime,\n  getAdVolume,\n\n  // VPAID 2.0 new getters\n  getAdWidth,\n  getAdHeight,\n  getAdSkippableState,\n  getAdDuration,\n  getAdCompanions,\n  getAdIcons\n];\n\nexport const SETTERS = [\n  setAdVolume\n];\n\n","const waitFor = (creativeAd, event, timeout) => new Promise((resolve, reject) => {\n  // eslint-disable-next-line prefer-const\n  let timeoutId;\n  const handler = () => {\n    if (typeof timeout === 'number') {\n      clearTimeout(timeoutId);\n    }\n\n    creativeAd.unsubscribe(handler, event);\n    resolve();\n  };\n\n  if (typeof timeout === 'number') {\n    timeoutId = setTimeout(() => {\n      creativeAd.unsubscribe(handler, event);\n      reject(new Error(`Timeout waiting for event '${event}'`));\n    }, timeout);\n  }\n\n  creativeAd.subscribe(handler, event);\n});\n\nexport default waitFor;\n","import waitFor from './waitFor';\n\nconst callAndWait = (creativeAd, method, event, ...args) => {\n  const waitPromise = waitFor(creativeAd, event, 5000);\n\n  creativeAd[method](...args);\n\n  return waitPromise;\n};\n\nexport default callAndWait;\n","import {handshakeVersion} from './api';\n\nconst major = (version) => {\n  const parts = version.split('.');\n\n  return parseInt(parts[0], 10);\n};\n\nconst isSupported = (supportedVersion, creativeVersion) => {\n  const creativeMajorNum = major(creativeVersion);\n\n  if (creativeMajorNum < 1) {\n    return false;\n  }\n\n  return creativeMajorNum <= major(supportedVersion);\n};\n\nconst handshake = (creative, supportedVersion) => {\n  const creativeVersion = creative[handshakeVersion](supportedVersion);\n\n  if (!isSupported(supportedVersion, creativeVersion)) {\n    throw new Error(`Creative Version '${creativeVersion}' not supported`);\n  }\n\n  return creativeVersion;\n};\n\nexport default handshake;\n","import {getCreativeData} from '../../../vastSelectors';\nimport viewmode from './viewmode';\n\nconst createSlot = (placeholder, width, height) => {\n  const slot = document.createElement('DIV');\n\n  Object.assign(slot.style, {\n    border: '0px',\n    cursor: 'pointer',\n    height: `${height}px`,\n    left: '0px',\n    margin: '0px',\n    padding: '0px',\n    position: 'absolute',\n    top: '0px',\n    width: `${width}px`\n  });\n\n  placeholder.appendChild(slot);\n\n  return slot;\n};\nconst initAd = (creativeAd, videoAdContainer, vastChain) => {\n  const placeholder = videoAdContainer.element;\n  const {width, height} = placeholder.getBoundingClientRect();\n  const mode = viewmode(width, height);\n  const desiredBitrate = -1;\n  const environmentVars = {\n    slot: createSlot(placeholder, width, height),\n    videoSlot: videoAdContainer.videoElement,\n    videoSlotCanAutoPlay: videoAdContainer.isOriginalVideoElement\n  };\n  const creativeData = getCreativeData(vastChain[0].XML);\n\n  creativeAd.initAd(width, height, mode, desiredBitrate, creativeData, environmentVars);\n};\n\nexport default initAd;\n","/* eslint-disable promise/prefer-await-to-callbacks, class-methods-use-this, import/no-named-as-default-member */\nimport linearEvents from '../tracker/linearEvents';\nimport {\n  acceptInvitation,\n  creativeView,\n  adCollapse\n} from '../tracker/nonLinearEvents';\nimport {getClickThrough} from '../vastSelectors';\nimport {volumeChanged, adProgress} from './adUnitEvents';\nimport loadCreative from './helpers/vpaid/loadCreative';\nimport {\n  adLoaded,\n  adStarted,\n  adStopped,\n  adPlaying,\n  adPaused,\n  startAd,\n  stopAd,\n  resumeAd,\n  pauseAd,\n  setAdVolume,\n  getAdVolume,\n  getAdDuration,\n  resizeAd,\n  adSizeChange,\n  adError,\n  adVideoComplete,\n  adSkipped,\n  EVENTS,\n  adVolumeChange,\n  adImpression,\n  adVideoStart,\n  adVideoFirstQuartile,\n  adVideoMidpoint,\n  adVideoThirdQuartile,\n  adUserAcceptInvitation,\n  adUserMinimize,\n  adUserClose,\n  adDurationChange,\n  adRemainingTimeChange,\n  adClickThru,\n  getAdIcons,\n  getAdRemainingTime\n} from './helpers/vpaid/api';\nimport waitFor from './helpers/vpaid/waitFor';\nimport callAndWait from './helpers/vpaid/callAndWait';\nimport handshake from './helpers/vpaid/handshake';\nimport initAd from './helpers/vpaid/initAd';\nimport VideoAdUnit, {_protected} from './VideoAdUnit';\n\nconst {\n  complete,\n  mute,\n  unmute,\n  skip,\n  start,\n  firstQuartile,\n  pause,\n  resume,\n  impression,\n  midpoint,\n  thirdQuartile,\n  clickThrough,\n  error: errorEvt,\n  closeLinear\n} = linearEvents;\n\n// NOTE some ads only allow one handler per event and we need to subscribe to the adLoaded to know the creative is loaded.\nconst VPAID_EVENTS = EVENTS.filter((event) => event !== adLoaded);\n\n// eslint-disable-next-line id-match\nconst _private = Symbol('_private');\n\nconst vpaidGeneralError = (payload) => {\n  const error = payload instanceof Error ? payload : new Error('VPAID general error');\n\n  if (!error.code) {\n    error.code = 901;\n  }\n\n  return error;\n};\n\n/**\n * @class\n * @alias VpaidAdUnit\n * @extends VideoAdUnit\n * @implements NonLinearEvents\n * @implements LinearEvents\n * @description This class provides everything necessary to run a Vpaid ad.\n */\nclass VpaidAdUnit extends VideoAdUnit {\n  [_private] = {\n    evtHandler: {\n      [adClickThru]: (url, id, playerHandles) => {\n        if (playerHandles) {\n          if (this.paused()) {\n            this.resume();\n          } else {\n            const clickThroughUrl = typeof url === 'string' && url.length > 0 ? url : getClickThrough(this.vastChain[0].ad);\n\n            this.pause();\n            window.open(clickThroughUrl, '_blank');\n          }\n        }\n\n        this.emit(clickThrough, {\n          adUnit: this,\n          type: clickThrough\n        });\n      },\n      [adDurationChange]: () => {\n        this.emit(adProgress, {\n          adUnit: this,\n          type: adProgress\n        });\n      },\n      [adError]: (payload) => {\n        this.error = vpaidGeneralError(payload);\n        this.errorCode = this.error.code;\n\n        this[_protected].onErrorCallbacks.forEach((callback) => callback(this.error, {\n          adUnit: this,\n          vastChain: this.vastChain\n        }));\n\n        this[_protected].finish();\n\n        this.emit(errorEvt, {\n          adUnit: this,\n          type: errorEvt\n        });\n      },\n      [adImpression]: () => {\n        // NOTE: some ads forget to trigger the adVideoStart event. :(\n        if (!this[_private].videoStart) {\n          this[_private].handleVpaidEvt(adVideoStart);\n        }\n\n        this.emit(impression, {\n          adUnit: this,\n          type: impression\n        });\n      },\n      [adPaused]: () => {\n        this[_private].paused = true;\n        this.emit(pause, {\n          adUnit: this,\n          type: pause\n        });\n      },\n      [adPlaying]: () => {\n        this[_private].paused = false;\n        this.emit(resume, {\n          adUnit: this,\n          type: resume\n        });\n      },\n      [adRemainingTimeChange]: () => {\n        this.emit(adProgress, {\n          adUnit: this,\n          type: adProgress\n        });\n      },\n      [adSkipped]: () => {\n        this.cancel();\n        this.emit(skip, {\n          adUnit: this,\n          type: skip\n        });\n      },\n      [adStarted]: () => {\n        this.emit(creativeView, {\n          adUnit: this,\n          type: creativeView\n        });\n      },\n      [adStopped]: () => {\n        this.emit(adStopped, {\n          adUnit: this,\n          type: adStopped\n        });\n\n        this[_protected].finish();\n      },\n      [adUserAcceptInvitation]: () => {\n        this.emit(acceptInvitation, {\n          adUnit: this,\n          type: acceptInvitation\n        });\n      },\n      [adUserClose]: () => {\n        this.emit(closeLinear, {\n          adUnit: this,\n          type: closeLinear\n        });\n\n        this[_protected].finish();\n      },\n      [adUserMinimize]: () => {\n        this.emit(adCollapse, {\n          adUnit: this,\n          type: adCollapse\n        });\n      },\n      [adVideoComplete]: () => {\n        this.emit(complete, {\n          adUnit: this,\n          type: complete\n        });\n\n        this[_protected].finish();\n      },\n      [adVideoFirstQuartile]: () => {\n        this.emit(firstQuartile, {\n          adUnit: this,\n          type: firstQuartile\n        });\n      },\n      [adVideoMidpoint]: () => {\n        this.emit(midpoint, {\n          adUnit: this,\n          type: midpoint\n        });\n      },\n      [adVideoStart]: () => {\n        if (!this[_private].videoStart) {\n          this[_private].videoStart = true;\n          this[_private].paused = false;\n          this.emit(start, {\n            adUnit: this,\n            type: start\n          });\n        }\n      },\n      [adVideoThirdQuartile]: () => {\n        this.emit(thirdQuartile, {\n          adUnit: this,\n          type: thirdQuartile\n        });\n      },\n      [adVolumeChange]: () => {\n        const volume = this.getVolume();\n\n        this.emit(volumeChanged, {\n          adUnit: this,\n          type: volumeChanged\n        });\n\n        if (volume === 0 && !this[_private].muted) {\n          this[_private].muted = true;\n          this.emit(mute, {\n            adUnit: this,\n            type: mute\n          });\n        }\n\n        if (volume > 0 && this[_private].muted) {\n          this[_private].muted = false;\n          this.emit(unmute, {\n            adUnit: this,\n            type: unmute\n          });\n        }\n      }\n    },\n    handleVpaidEvt: (event, ...args) => {\n      const handler = this[_private].evtHandler[event];\n\n      if (handler) {\n        handler(...args);\n      }\n\n      this.emit(event, {\n        adUnit: this,\n        type: event\n      });\n    },\n    muted: false,\n    paused: true\n  };\n\n  /** Ad unit type. Will be `VPAID` for VpaidAdUnit */\n  type='VPAID';\n\n  /** Reference to the Vpaid Creative ad unit. Will be null before the ad unit starts. */\n  creativeAd = null;\n\n  /**\n   * Creates a {VpaidAdUnit}.\n   *\n   * @param {VastChain} vastChain - The {@link VastChain} with all the {@link VastResponse}\n   * @param {VideoAdContainer} videoAdContainer - container instance to place the ad\n   * @param {Object} [options] - Options Map. The allowed properties are:\n   * @param {Console} [options.logger] - Optional logger instance. Must comply to the [Console interface]{@link https://developer.mozilla.org/es/docs/Web/API/Console}.\n   * Defaults to `window.console`\n   * @param {boolean} [options.viewability] - if true it will pause the ad whenever is not visible for the viewer.\n   * Defaults to `false`\n   * @param {boolean} [options.responsive] - if true it will resize the ad unit whenever the ad container changes sizes\n   * Defaults to `false`\n   * Defaults to `window.console`\n   */\n  constructor (vastChain, videoAdContainer, options = {}) {\n    super(vastChain, videoAdContainer, options);\n\n    this[_private].loadCreativePromise = loadCreative(vastChain, videoAdContainer);\n  }\n\n  /**\n   * Starts the ad unit.\n   *\n   * @throws if called twice.\n   * @throws if ad unit is finished.\n   */\n  async start () {\n    this[_protected].throwIfFinished();\n\n    if (this.isStarted()) {\n      throw new Error('VpaidAdUnit already started');\n    }\n\n    try {\n      this.creativeAd = await this[_private].loadCreativePromise;\n      const adLoadedPromise = waitFor(this.creativeAd, adLoaded);\n\n      for (const creativeEvt of VPAID_EVENTS) {\n        this.creativeAd.subscribe(this[_private].handleVpaidEvt.bind(this, creativeEvt), creativeEvt);\n      }\n\n      if (this.creativeAd[getAdIcons] && !this.creativeAd[getAdIcons]()) {\n        this.icons = null;\n      }\n\n      handshake(this.creativeAd, '2.0');\n      initAd(this.creativeAd, this.videoAdContainer, this.vastChain);\n\n      await adLoadedPromise;\n\n      // if the ad timed out while trying to load the videoAdContainer will be destroyed\n      if (!this.videoAdContainer.isDestroyed()) {\n        try {\n          const {videoElement} = this.videoAdContainer;\n\n          if (videoElement.muted) {\n            this[_private].muted = true;\n            this.setVolume(0);\n          } else {\n            this.setVolume(videoElement.volume);\n          }\n\n          await callAndWait(this.creativeAd, startAd, adStarted);\n\n          if (this.icons) {\n            const drawIcons = async () => {\n              if (this.isFinished()) {\n                return;\n              }\n\n              await this[_protected].drawIcons();\n\n              if (this[_protected].hasPendingIconRedraws() && !this.isFinished()) {\n                setTimeout(drawIcons, 500);\n              }\n            };\n\n            await drawIcons();\n          }\n\n          this[_protected].started = true;\n        } catch (error) {\n          this.cancel();\n        }\n      }\n\n      return this;\n    } catch (error) {\n      this[_private].handleVpaidEvt(adError, error);\n      throw error;\n    }\n  }\n\n  /**\n   * Resumes a previously paused ad unit.\n   *\n   * @throws if ad unit is not started.\n   * @throws if ad unit is finished.\n   */\n  resume () {\n    this.creativeAd[resumeAd]();\n  }\n\n  /**\n   * Pauses the ad unit.\n   *\n   * @throws if ad unit is not started.\n   * @throws if ad unit is finished.\n   */\n  pause () {\n    this.creativeAd[pauseAd]();\n  }\n\n  /**\n   * Returns true if the ad is paused and false otherwise\n   */\n  paused () {\n    return this.isFinished() || this[_private].paused;\n  }\n\n  /**\n   * Sets the volume of the ad unit.\n   *\n   * @throws if ad unit is not started.\n   * @throws if ad unit is finished.\n   *\n   * @param {number} volume - must be a value between 0 and 1;\n   */\n  setVolume (volume) {\n    this.creativeAd[setAdVolume](volume);\n  }\n\n  /**\n   * Gets the volume of the ad unit.\n   *\n   * @throws if ad unit is not started.\n   * @throws if ad unit is finished.\n   *\n   * @returns {number} - the volume of the ad unit.\n   */\n  getVolume () {\n    return this.creativeAd[getAdVolume]();\n  }\n\n  /**\n   * Cancels the ad unit.\n   *\n   * @throws if ad unit is finished.\n   */\n  async cancel () {\n    this[_protected].throwIfFinished();\n\n    try {\n      const adStoppedPromise = waitFor(this.creativeAd, adStopped, 3000);\n\n      this.creativeAd[stopAd]();\n      await adStoppedPromise;\n    } catch (error) {\n      this[_protected].finish();\n    }\n  }\n\n  /**\n   * Returns the duration of the ad Creative or 0 if there is no creative.\n   *\n   * Note: if the user has engaged with the ad, the duration becomes unknown and it will return 0;\n   *\n   * @returns {number} - the duration of the ad unit.\n   */\n  duration () {\n    if (!this.creativeAd) {\n      return 0;\n    }\n\n    const duration = this.creativeAd[getAdDuration]();\n\n    if (duration < 0) {\n      return 0;\n    }\n\n    return duration;\n  }\n\n  /**\n   * Returns the current time of the ad Creative or 0 if there is no creative.\n   *\n   * Note: if the user has engaged with the ad, the currentTime becomes unknown and it will return 0;\n   *\n   * @returns {number} - the current time of the ad unit.\n   */\n  currentTime () {\n    if (!this.creativeAd) {\n      return 0;\n    }\n\n    const remainingTime = this.creativeAd[getAdRemainingTime]();\n\n    if (remainingTime < 0) {\n      return 0;\n    }\n\n    return this.duration() - remainingTime;\n  }\n\n  /**\n   * This method resizes the ad unit to fit the available space in the passed {@link VideoAdContainer}\n   *\n   * @throws if ad unit is not started.\n   * @throws if ad unit is finished.\n   *\n   * @returns {Promise} - that resolves once the unit was resized\n   */\n  async resize (width, height, viewmode) {\n    await super.resize(width, height, viewmode);\n\n    return callAndWait(this.creativeAd, resizeAd, adSizeChange, width, height, viewmode);\n  }\n}\n\nexport default VpaidAdUnit;\n","import {\n  linearEvents,\n  nonLinearEvents,\n  trackLinearEvent,\n  trackNonLinearEvent\n} from '../tracker';\nimport VastAdUnit from './VastAdUnit';\nimport VpaidAdUnit from './VpaidAdUnit';\n\nconst createVideoAdUnit = (vastChain, videoAdContainer, options) => {\n  const {\n    tracker,\n    type\n  } = options;\n  const adUnit = type === 'VPAID' ? new VpaidAdUnit(vastChain, videoAdContainer, options) : new VastAdUnit(vastChain, videoAdContainer, options);\n\n  Object.values(linearEvents).forEach((linearEvent) =>\n    adUnit.on(linearEvent, (event) => {\n      const {\n        type: evtType,\n        data\n      } = event;\n      const payload = {\n        data,\n        errorCode: adUnit.errorCode,\n        tracker\n      };\n\n      trackLinearEvent(evtType, vastChain, payload);\n    })\n  );\n\n  Object.values(nonLinearEvents).forEach((nonLinearEvent) =>\n    adUnit.on(nonLinearEvent, (event) => {\n      const payload = {\n        data: event.data,\n        tracker\n      };\n\n      trackNonLinearEvent(event.type, vastChain, payload);\n    })\n  );\n\n  return adUnit;\n};\n\nexport default createVideoAdUnit;\n\n","import createVideoAdUnit from '../../adUnit/createVideoAdUnit';\nimport VideoAdContainer from '../../adContainer/VideoAdContainer';\nimport {getInteractiveFiles, getMediaFiles} from '../../vastSelectors';\nimport canPlay from '../../adUnit/helpers/media/canPlay';\nimport {\n  start,\n  closeLinear\n} from '../../tracker/linearEvents';\nimport {\n  adStopped,\n  adUserClose\n} from '../../adUnit/helpers/vpaid/api';\n\nconst validate = (vastChain, videoAdContainer) => {\n  if (!Array.isArray(vastChain) || vastChain.length === 0) {\n    throw new TypeError('Invalid vastChain');\n  }\n\n  if (!(videoAdContainer instanceof VideoAdContainer)) {\n    throw new TypeError('Invalid VideoAdContainer');\n  }\n};\n\nconst hasVpaidCreative = (ad) => Boolean(getInteractiveFiles(ad));\n\nconst hasVastCreative = (ad, videoElement) => {\n  const mediaFiles = getMediaFiles(ad);\n\n  if (mediaFiles) {\n    return mediaFiles.some((mediaFile) => canPlay(videoElement, mediaFile));\n  }\n\n  return false;\n};\n\nconst startAdUnit = (adUnit, {onAdReady}) => new Promise((resolve, reject) => {\n  const createRejectHandler = (event) => () =>\n    reject(new Error(`Ad unit start rejected due to event '${event}'`));\n\n  adUnit.onError(reject);\n  adUnit.on(start, () => resolve(adUnit));\n  adUnit.on(adUserClose, createRejectHandler(adUserClose));\n  adUnit.on(closeLinear, createRejectHandler(closeLinear));\n  adUnit.on(adStopped, createRejectHandler(adStopped));\n\n  onAdReady(adUnit);\n  adUnit.start();\n});\n\nconst tryToStartVpaidAd = (vastChain, videoAdContainer, options) => {\n  if (!hasVpaidCreative(vastChain[0].ad)) {\n    throw new Error('No valid creative found in the passed VAST chain');\n  }\n\n  const adUnit = createVideoAdUnit(vastChain, videoAdContainer, {\n    ...options,\n    type: 'VPAID'\n  });\n\n  return startAdUnit(adUnit, options);\n};\n\nconst startVastAd = (vastChain, videoAdContainer, options) => {\n  const adUnit = createVideoAdUnit(vastChain, videoAdContainer, {\n    ...options,\n    type: 'VAST'\n  });\n\n  return startAdUnit(adUnit, options);\n};\n\nconst startVideoAd = async (vastChain, videoAdContainer, options) => {\n  validate(vastChain, videoAdContainer);\n  try {\n    return await tryToStartVpaidAd(vastChain, videoAdContainer, options);\n  } catch (error) {\n    if (hasVastCreative(vastChain[0].ad, videoAdContainer.videoElement)) {\n      return startVastAd(vastChain, videoAdContainer, options);\n    }\n\n    throw error;\n  }\n};\n\nexport default startVideoAd;\n","import {trackError} from '../tracker';\nimport createVideoAdContainer from '../adContainer/createVideoAdContainer';\nimport startVideoAd from './helpers/startVideoAd';\n\n/**\n * Will try to start video ad in the passed {@link VastChain} and return the started VideoAdUnit.\n *\n * @memberof module:@mailonline/video-ad-sdk\n * @static\n * @throws if there is an error starting the ad or it times out (by throw I mean that it will reject promise with the error).\n * @param {VastChain} vastChain - The {@link VastChain} with all the {@link VastResponse}s.\n * @param {HTMLElement} placeholder - placeholder element that will contain the video ad.\n * @param {Object} [options] - Options Map. The allowed properties are:\n * @param {runWaterfall~onAdReady} options.onAdReady - will be called once the ad is ready with the ad unit.\n * @param {HTMLVideoElement} [options.videoElement] - optional videoElement that will be used to play the ad.\n * @param {Console} [options.logger] - Optional logger instance. Must comply to the [Console interface]{@link https://developer.mozilla.org/es/docs/Web/API/Console}.\n * Defaults to `window.console`\n * @param {boolean} [options.viewability] - if true it will pause the ad whenever is not visible for the viewer.\n * Defaults to `false`\n * @param {boolean} [options.responsive] - if true it will resize the ad unit whenever the ad container changes sizes.\n * Defaults to `false`\n * @param {number} [options.timeout] - timeout number in milliseconds. If set, the video ad will time out if it doesn't start within the specified time.\n * @param {TrackerFn} [options.tracker] - If provided it will be used to track the VAST events instead of the default {@link pixelTracker}.\n * @param {Object} [options.hooks] - Optional map with hooks to configure the behaviour of the ad.\n * @param {Function} [options.hooks.createSkipControl] - If provided it will be called to generate the skip control. Must return a clickable [HTMLElement](https://developer.mozilla.org/es/docs/Web/API/HTMLElement) that is detached from the DOM.\n * @returns {Promise.<VastAdUnit|VpaidAdUnit>} - The video ad unit.\n */\nconst run = async (vastChain, placeholder, options) => {\n  let videoAdContainer;\n\n  try {\n    const {timeout} = options;\n\n    videoAdContainer = createVideoAdContainer(placeholder, options.videoElement);\n    let adUnitPromise = startVideoAd(vastChain, videoAdContainer, options);\n\n    if (typeof timeout === 'number') {\n      let timedOut = false;\n      let timeoutId;\n      const timeoutPromise = new Promise((resolve, reject) => {\n        timeoutId = setTimeout(() => {\n          const {tracker} = options;\n\n          trackError(vastChain, {\n            errorCode: 402,\n            tracker\n          });\n          timedOut = true;\n          reject(new Error('Timeout while starting the ad'));\n        }, options.timeout);\n      });\n\n      adUnitPromise = Promise.race([\n        // eslint-disable-next-line promise/prefer-await-to-then\n        adUnitPromise.then((newAdUnit) => {\n          if (timedOut) {\n            if (newAdUnit.isStarted()) {\n              newAdUnit.cancel();\n            }\n          } else {\n            clearTimeout(timeoutId);\n          }\n\n          return newAdUnit;\n        }),\n        timeoutPromise\n      ]);\n    }\n\n    const adUnit = await adUnitPromise;\n\n    adUnit.onFinish(() => {\n      videoAdContainer.destroy();\n    });\n\n    return adUnit;\n  } catch (error) {\n    if (videoAdContainer) {\n      videoAdContainer.destroy();\n    }\n\n    throw error;\n  }\n};\n\nexport default run;\n","/* eslint-disable filenames/match-exported, import/no-unassigned-import */\nimport 'whatwg-fetch';\n\nconst fetch = async (endpoint, options = {}) => {\n  const defaults = {\n    credentials: 'include'\n  };\n\n  const fetchOptions = Object.assign({}, defaults, options);\n\n  try {\n    const response = await window.fetch(endpoint, fetchOptions);\n\n    if (response.status >= 400) {\n      const error = new Error(response.statusText);\n\n      error.response = response;\n      throw error;\n    }\n\n    return response;\n  } catch (error) {\n    fetchOptions.credentials = 'omit';\n    const response = await window.fetch(endpoint, fetchOptions);\n\n    if (response.status >= 400) {\n      const errorWithCors = new Error(response.statusText);\n\n      errorWithCors.response = response;\n      throw errorWithCors;\n    }\n\n    return response;\n  }\n};\n\nexport default fetch;\n","const requested = Symbol('requested');\n\nexport const markAdAsRequested = (ad) => {\n  ad[requested] = true;\n};\n\nexport const unmarkAdAsRequested = (ad) => {\n  delete ad[requested];\n};\n\nexport const hasAdBeenRequested = (ad) => Boolean(ad[requested]);\n","/* eslint-disable no-console */\nimport {parseXml} from '../xml';\nimport {\n  getWrapperOptions,\n  getFirstAd,\n  getVASTAdTagURI,\n  hasAdPod,\n  isInline,\n  isWrapper\n} from '../vastSelectors';\nimport fetch from './helpers/fetch';\nimport {markAdAsRequested} from './helpers/adUtils';\n\nconst validateChain = (vastChain, {wrapperLimit = 5}) => {\n  if (vastChain.length > wrapperLimit) {\n    const error = new Error('Wrapper Limit reached');\n\n    error.code = 304;\n    throw error;\n  }\n};\n\nconst fetchAdXML = async (adTag, options) => {\n  try {\n    const response = await fetch(adTag, options);\n    const XML = await response.text();\n\n    return XML;\n  } catch (error) {\n    error.code = 502;\n\n    throw error;\n  }\n};\n\nconst parseVastXml = (xml) => {\n  try {\n    return parseXml(xml);\n  } catch (error) {\n    error.code = 100;\n    throw error;\n  }\n};\n\nconst getAd = (parsedXML) => {\n  try {\n    const ad = getFirstAd(parsedXML);\n\n    if (Boolean(ad)) {\n      markAdAsRequested(ad);\n\n      return ad;\n    }\n\n    throw new Error('No Ad');\n  } catch (error) {\n    error.code = 303;\n    throw error;\n  }\n};\n\nconst validateResponse = ({ad, parsedXML}, {allowMultipleAds = true, followAdditionalWrappers = true}) => {\n  if (!isWrapper(ad) && !isInline(ad)) {\n    const error = new Error('Invalid VAST, ad contains neither Wrapper nor Inline');\n\n    error.code = 101;\n    throw error;\n  }\n\n  if (hasAdPod(parsedXML) && !allowMultipleAds) {\n    const error = new Error('Multiple ads are not allowed');\n\n    error.code = 203;\n    throw error;\n  }\n\n  if (isWrapper(ad) && !followAdditionalWrappers) {\n    const error = new Error('To follow additional wrappers is not allowed');\n\n    error.code = 200;\n    throw error;\n  }\n};\n\nconst getOptions = (vastChain, options) => {\n  const parentAd = vastChain[0];\n  const parentAdIsWrapper = Boolean(parentAd) && isWrapper(parentAd.ad);\n  const wrapperOptions = parentAdIsWrapper ? getWrapperOptions(parentAd.ad) : {};\n\n  return {\n    ...wrapperOptions,\n    ...options\n  };\n};\n\n// eslint-disable-next-line jsdoc/check-tag-names\n/**\n * @function requestAd\n *\n * @memberof module:@mailonline/video-ad-sdk\n * @async\n * @static\n * @description Request the ad using the passed ad tag and returns an array with the [VAST responses]{@link VastResponse} needed to get an inline ad.\n *\n * @param {string} adTag - The VAST ad tag request url.\n * @param {Object} options - Options Map. The allowed properties are:\n * @param {number} [options.wrapperLimit] - Sets the maximum number of wrappers allowed in the {@link VastChain}.\n *  Defaults to `5`.\n * @param {boolean} [options.AllowMultipleAds] - Boolean to indicate whether adPods are allowed or not.\n *  Defaults to `true`.\n * @param {number} [options.timeout] - timeout number in milliseconds. If set, the request will timeout if it is not fulfilled before the specified time.\n * @param {VastChain} [vastChain] - Optional vastChain with the previous VAST responses.\n * @returns {Promise.<VastChain>} - Returns a Promise that will resolve with a VastChain with the newest VAST response at the beginning of the array.\n * If the {@link VastChain} had an error. The first VAST response of the array will contain an error and an errorCode entry.\n */\nconst requestAd = async (adTag, options, vastChain = [], rawXml = null) => {\n  const VASTAdResponse = {\n    ad: null,\n    errorCode: null,\n    parsedXML: null,\n    requestTag: adTag,\n    XML: rawXml\n  };\n  let opts;\n  let epoch;\n  let timeout;\n\n  try {\n    opts = getOptions(vastChain, options);\n    validateChain(vastChain, opts);\n\n    if (!VASTAdResponse.XML) {\n      let fetchPromise = fetchAdXML(adTag, opts);\n\n      if (typeof opts.timeout === 'number') {\n        timeout = opts.timeout;\n        epoch = Date.now();\n        fetchPromise = Promise.race([\n          fetchPromise,\n          new Promise((resolve, reject) => {\n            setTimeout(() => {\n              const error = new Error('RequestAd timeout');\n\n              error.code = 301;\n              reject(error);\n            }, timeout);\n          })\n        ]);\n      }\n\n      VASTAdResponse.XML = await fetchPromise;\n    }\n    VASTAdResponse.parsedXML = parseVastXml(VASTAdResponse.XML);\n    VASTAdResponse.ad = getAd(VASTAdResponse.parsedXML);\n\n    validateResponse(VASTAdResponse, opts);\n\n    if (isWrapper(VASTAdResponse.ad)) {\n      if (epoch) {\n        timeout -= Date.now() - epoch;\n      }\n\n      return requestAd(\n        getVASTAdTagURI(VASTAdResponse.ad),\n        {\n          ...opts,\n          timeout\n        },\n        [VASTAdResponse, ...vastChain]\n      );\n    }\n\n    return [VASTAdResponse, ...vastChain];\n  } catch (error) {\n    /* istanbul ignore if */\n    if (!Number.isInteger(error.code)) {\n      error.code = 900;\n    }\n\n    VASTAdResponse.errorCode = error.code;\n    VASTAdResponse.error = error;\n\n    return [VASTAdResponse, ...vastChain];\n  }\n};\n\nexport default requestAd;\n","import {\n  hasAdPod,\n  getAds,\n  getPodAdSequence,\n  isPodAd\n} from '../../vastSelectors';\nimport {hasAdBeenRequested} from './adUtils';\n\nconst getNextPod = (currentPod, ads) => {\n  const nextPodSequence = getPodAdSequence(currentPod) + 1;\n\n  return ads.find((ad) => getPodAdSequence(ad) === nextPodSequence) || null;\n};\n\nconst getNextAd = ({ad, parsedXML}, {fallbackOnNoAd = true, useAdBuffet = false}) => {\n  const ads = getAds(parsedXML);\n  const availableAds = ads.filter((adDefinition) => !hasAdBeenRequested(adDefinition));\n  let nextAd = null;\n\n  if (hasAdPod(parsedXML)) {\n    if (useAdBuffet) {\n      nextAd = availableAds.filter((adDefinition) => !isPodAd(adDefinition))[0];\n    }\n\n    if (!nextAd) {\n      nextAd = getNextPod(ad, availableAds);\n    }\n  } else if (availableAds.length > 0 && fallbackOnNoAd) {\n    nextAd = availableAds[0];\n  }\n\n  return nextAd;\n};\n\nexport default getNextAd;\n","import {\n  getVASTAdTagURI,\n  isWrapper\n} from '../vastSelectors';\nimport requestAd from './requestAd';\nimport getNextAd from './helpers/getNextAd';\nimport {markAdAsRequested} from './helpers/adUtils';\n\nconst validateChain = (VastChain) => {\n  if (!Array.isArray(VastChain)) {\n    throw new TypeError('Invalid VAST chain');\n  }\n\n  if (VastChain.length === 0) {\n    throw new Error('No next ad to request');\n  }\n};\n\n// eslint-disable-next-line jsdoc/check-tag-names\n/**\n * @function requestNextAd\n *\n * @memberof module:@mailonline/video-ad-sdk\n * @async\n * @static\n * @description Requests the next ad in the VAST Chain.\n *\n * @param {VastChain} VastChain - Array of {@link VastResponse}.\n * @param {Object} options - Options Map. The allowed properties are:\n * @param {number} [options.wrapperLimit] - Sets the maximum number of wrappers allowed in the vastChain.\n *  Defaults to `5`.\n * @param {boolean} [options.AllowMultipleAds] - Boolean to indicate whether adPods are allowed or not.\n *  Defaults to `true`.\n * @param {tracker} [options.track] - optional function to track whatever errors occur during the loading.\n *  Defaults to `@mailonline/video-ad-tracker` track method.\n * @param {boolean} [options.useAdBuffet] - Specifies whether to use buffet ads from an ad pod if possible.\n *    If no buffet ad is available it will return the next ad in ad pod sequence.\n *    Set it to true if an ad from an adPod failed and you want to replace it with an ad from the ad buffet.\n *    Defaults to `false`.\n * @param {boolean} [options.fallbackOnNoAd] - tells the video player to select an ad from any stand-alone ads available.\n *    Note: if the {@link VastChain} contains an adPod this property will be ignored.\n *    Defaults to `true`.\n * @param {number} [options.timeout] - timeout number in milliseconds. If set, the request will timeout if it is not fulfilled before the specified time.\n *\n * @returns {Promise.<VastChain>}  - Returns a Promise that will resolve with a VastChain with the newest VAST response at the beginning of the array.\n * If the {@link VastChain} had an error. The first VAST response of the array will contain an error and an errorCode entry.\n */\nconst requestNextAd = (VastChain, options) => {\n  validateChain(VastChain);\n\n  const vastResponse = VastChain[0];\n  const nextAd = getNextAd(vastResponse, options);\n\n  if (Boolean(nextAd)) {\n    const newVastResponse = Object.assign({}, vastResponse, {\n      ad: nextAd\n    });\n    const newVastChain = [newVastResponse, ...VastChain.slice(1)];\n\n    markAdAsRequested(nextAd);\n\n    if (isWrapper(nextAd)) {\n      return requestAd(getVASTAdTagURI(nextAd), options, newVastChain);\n    }\n\n    return Promise.resolve(newVastChain);\n  }\n\n  return requestNextAd(VastChain.slice(1), options);\n};\n\nexport default requestNextAd;\n","/* eslint-disable promise/prefer-await-to-callbacks, callback-return */\nimport {trackError} from '../tracker';\nimport requestAd from '../vastRequest/requestAd';\nimport requestNextAd from '../vastRequest/requestNextAd';\nimport {getInteractiveFiles} from '../vastSelectors';\nimport isIOS from '../utils/isIOS';\nimport run from './run';\n\nconst isVpaid = (vastChain) => Boolean(getInteractiveFiles(vastChain[0].ad));\nconst validateVastChain = (vastChain, options) => {\n  if (!vastChain || vastChain.length === 0) {\n    throw new Error('Invalid VastChain');\n  }\n\n  const lastVastResponse = vastChain[0];\n\n  if (!options.vpaidEnabled && isVpaid(vastChain)) {\n    const error = new Error('VPAID ads are not supported by the current player');\n\n    error.code = 200;\n    lastVastResponse.errorCode = 200;\n    lastVastResponse.error = error;\n  }\n\n  if (Boolean(lastVastResponse.error)) {\n    throw lastVastResponse.error;\n  }\n\n  if (options.hooks && typeof options.hooks.validateVastResponse === 'function') {\n    options.hooks.validateVastResponse(vastChain);\n  }\n};\n\nconst callbackHandler = (cb) => (...args) => {\n  if (typeof cb === 'function') {\n    cb(...args);\n  }\n};\n\nconst getErrorCode = (vastChain, error) => vastChain && vastChain[0] && vastChain[0].errorCode || error.code;\nconst transformVastResponse = (vastChain, {hooks}) => {\n  if (hooks && typeof hooks.transformVastResponse === 'function') {\n    return hooks.transformVastResponse(vastChain);\n  }\n\n  return vastChain;\n};\n\n// eslint-disable-next-line complexity\nconst waterfall = async (fetchVastChain, placeholder, options, isCanceled) => {\n  let vastChain;\n  let runEpoch;\n  let adUnit;\n  const opts = {...options};\n  const {\n    onAdStart,\n    onError,\n    onRunFinish\n  } = opts;\n\n  try {\n    if (typeof opts.timeout === 'number') {\n      runEpoch = Date.now();\n    }\n\n    vastChain = await fetchVastChain();\n\n    if (isCanceled()) {\n      onRunFinish();\n\n      return;\n    }\n\n    if (runEpoch) {\n      const newEpoch = Date.now();\n\n      opts.timeout -= newEpoch - runEpoch;\n      runEpoch = newEpoch;\n    }\n\n    validateVastChain(vastChain, opts);\n\n    adUnit = await run(transformVastResponse(vastChain, opts), placeholder, {...opts});\n\n    if (isCanceled()) {\n      adUnit.cancel();\n      onRunFinish();\n\n      return;\n    }\n\n    adUnit.onError(onError);\n    adUnit.onFinish(onRunFinish);\n    onAdStart(adUnit);\n  } catch (error) {\n    const errorCode = getErrorCode(vastChain, error);\n\n    if (Boolean(errorCode)) {\n      const {tracker} = options;\n\n      trackError(vastChain, {\n        errorCode,\n        tracker\n      });\n    }\n\n    onError(error, {\n      adUnit,\n      vastChain\n    });\n\n    if (vastChain && !isCanceled()) {\n      if (runEpoch) {\n        opts.timeout -= Date.now() - runEpoch;\n      }\n\n      if (!runEpoch || opts.timeout > 0) {\n        waterfall(\n          () => requestNextAd(vastChain, opts),\n          placeholder,\n          {...opts},\n          isCanceled\n        );\n\n        return;\n      }\n    }\n\n    onRunFinish();\n  }\n};\n\n/**\n * Will try to start one of the ads returned by the `adTag`. It will keep trying until it times out or it runs out of ads.\n *\n * @memberof module:@mailonline/video-ad-sdk\n * @static\n * @alias runWaterfall\n * @param {string} adTag - The VAST ad tag request url.\n * @param {HTMLElement} placeholder - placeholder element that will contain the video ad.\n * @param {Object} [options] - Options Map. The allowed properties are:\n * @param {HTMLVideoElement} [options.videoElement] - optional videoElement that will be used to play the ad.\n * @param {Console} [options.logger] - Optional logger instance. Must comply to the [Console interface]{@link https://developer.mozilla.org/es/docs/Web/API/Console}.\n * Defaults to `window.console`\n * @param {number} [options.wrapperLimit] - Sets the maximum number of wrappers allowed in the {@link VastChain}.\n *  Defaults to `5`.\n * @param {runWaterfall~onAdReady} [options.onAdReady] - will be called once the ad is ready with the ad unit.\n * @param {runWaterfall~onAdStart} [options.onAdStart] - will be called once the ad starts with the ad unit.\n * @param {runWaterfall~onError} [options.onError] - will be called if there is an error with the video ad with the error instance and an obj with the {@link VastChain} and the ad unit if it exists.\n * @param {runWaterfall~onRunFinish} [options.onRunFinish] - will be called whenever the ad run finishes.\n * @param {boolean} [options.viewability] - if true it will pause the ad whenever is not visible for the viewer.\n * Defaults to `false`\n * @param {boolean} [options.responsive] - if true it will resize the ad unit whenever the ad container changes sizes.\n * Defaults to `false`\n * @param {number} [options.timeout] - timeout number in milliseconds. If set, the video ad will time out if it doesn't start within the specified time.\n * @param {TrackerFn} [options.tracker] - If provided it will be used to track the VAST events instead of the default {@link pixelTracker}.\n * @param {boolean} [options.vpaidEnabled] - if false and it gets a VPAID ad, it will throw an error before starting the ad and continue down in the waterfall.\n * Defaults to `true`.\n * @param {Object} [options.hooks] - Optional map with hooks to configure the behaviour of the ad.\n * @param {Function} [options.hooks.createSkipControl] - If provided it will be called to generate the skip control. Must return a clickable [HTMLElement](https://developer.mozilla.org/es/docs/Web/API/HTMLElement) that is detached from the DOM.\n * @param {Function} [options.hooks.validateVastResponse] - If provided it will be called passing the current {@link VastChain} for each valid vast response. Must throw if there is a problem with the vast response. If the Error instance has an `code` number then it will be tracked using the error macros in the Vast response. It will also call {@link runWaterfall~onError} with the thrown error.\n * @param {Function} [options.hooks.transformVastResponse] - If provided it will be called with the current {@link VastChain} before building the adUnit allowing the modification of the vastResponse if needed.\n * @returns {Function} - Cancel function. If called it will cancel the ad run. {@link runWaterfall~onRunFinish} will still be called;\n */\nconst runWaterfall = (adTag, placeholder, options, rawXml) => {\n  let canceled = false;\n  let adUnit = null;\n  const isCanceled = () => canceled;\n  const onAdStartHandler = callbackHandler(options.onAdStart);\n  const onAdStart = (newAdUnit) => {\n    adUnit = newAdUnit;\n    onAdStartHandler(adUnit);\n  };\n\n  const opts = {\n    vpaidEnabled: true,\n    ...options,\n    // eslint-disable-next-line sort-keys\n    onAdReady: callbackHandler(options.onAdReady),\n    onAdStart,\n    onError: callbackHandler(options.onError),\n    onRunFinish: callbackHandler(options.onRunFinish)\n  };\n\n  if (options.videoElement && isIOS()) {\n    /*\n      It seems that if the video doesn't load synchronously inside a touchend or click event handler, the user gesture breaks on iOS and it won't allow a play.\n    */\n    options.videoElement.load();\n  }\n\n  waterfall(\n    () => requestAd(adTag, opts, [], rawXml),\n    placeholder,\n    opts,\n    isCanceled\n  );\n\n  return () => {\n    canceled = true;\n\n    if (adUnit && !adUnit.isFinished()) {\n      adUnit.cancel();\n    }\n  };\n};\n\nexport default runWaterfall;\n\n/**\n * Called once the ad starts.\n *\n * @callback RunWaterfall~onAdStart\n * @param {VastAdUnit | VideoAdUnit} adUnit - the ad unit instance.\n */\n\n/**\n * Called once the ad unit is created.\n *\n * @callback RunWaterfall~onAdReady\n * @param {VastAdUnit | VideoAdUnit} adUnit - the ad unit instance.\n */\n\n/**\n * Called whenever the an error occurs within the ad unit. It may be called several times with different errors\n *\n * @callback RunWaterfall~onError\n * @param {Error} error - the ad unit error.\n * @param {Object} [data] - Data object that will contain:\n * @param {VastChain} [data.vastChain] - The {@link VastChain} that caused the error.\n * @param {VideoAdUnit} [data.adUnit] - Ad unit instance it can be a {@link VastAdUnit} or a {@link VpaidAdUnit}. Will only be added if the vastChain had an ad.\n */\n\n/**\n * Called once the ad run is finished. It will be called no matter how the run was finished (due to an ad complete or an error). It can be used to know when to unmount the component.\n *\n * @callback RunWaterfall~onRunFinish\n */\n","import {\n  get,\n  getFirstChild,\n  getText,\n  getAttribute\n} from '../xml';\nimport getLinearCreative from '../vastSelectors/helpers/getLinearCreative';\nimport {\n  isInline,\n  getClickThrough,\n  getCreativeData,\n  isWrapper,\n  getMediaFiles,\n  getInteractiveFiles\n} from '../vastSelectors';\nimport parseTime from '../vastSelectors/helpers/parseTime';\n\nconst getAdSystem = (ad) => {\n  const adTypeElement = getFirstChild(ad);\n  const element = adTypeElement && get(adTypeElement, 'AdSystem');\n\n  if (element) {\n    return getText(element);\n  }\n\n  return undefined;\n};\n\nconst getSubElementValue = (parentElement, tagName) => {\n  const element = parentElement && get(parentElement, tagName);\n\n  if (element) {\n    return getText(element);\n  }\n\n  return undefined;\n};\n\nconst getPricingElement = (ad) => {\n  const adTypeElement = getFirstChild(ad);\n\n  return adTypeElement && get(adTypeElement, 'Pricing');\n};\n\nconst getPricing = (vastChain) => {\n  const {ad} = vastChain[0];\n  const pricingElement = getPricingElement(ad);\n\n  if (pricingElement) {\n    return {\n      pricing: getText(pricingElement),\n      pricingCurrency: getAttribute(pricingElement, 'currency'),\n      pricingModel: getAttribute(pricingElement, 'model')\n    };\n  }\n\n  if (vastChain.length > 1) {\n    return getPricing(vastChain.slice(1));\n  }\n\n  return {};\n};\n\nconst getCategory = (ad) => {\n  const inLineElement = get(ad, 'InLine');\n  const categoryElement = inLineElement && get(inLineElement, 'Category');\n\n  if (categoryElement) {\n    return {\n      category: getText(categoryElement),\n      categoryAuthority: getAttribute(categoryElement, 'authority')\n    };\n  }\n\n  return {};\n};\n\nconst getVastVersion = (parsedVast) => {\n  const vastElement = parsedVast && get(parsedVast, 'VAST');\n\n  if (vastElement) {\n    return getAttribute(vastElement, 'version');\n  }\n\n  return 'unknown';\n};\n\n/**\n * @function getDetails\n *\n * @memberof module:@mailonline/video-ad-sdk\n * @static\n * @description Returns a summary of the passed {@link VastChain}.\n *\n * @param {VastChain} vastChain - the {@link VastChain} from which we want the details.\n *\n * @returns {VastChainDetails} - Returns a {@link VastChainDetails} object from the passed {@link VastChain}.\n */\nconst getDetails = (vastChain) => {\n  const adIds = vastChain.map(({ad}) => getAttribute(ad, 'id'));\n  const adSystems = vastChain.map(({ad}) => getAdSystem(ad));\n  const creatives = vastChain.map(({ad}) => getLinearCreative(ad)).filter((creative) => Boolean(creative));\n  const creativeIds = creatives.map((creative) => getAttribute(creative, 'id'));\n  const creativeAdIds = creatives.map((creative) => getAttribute(creative, 'adId'));\n  const {\n    pricing,\n    pricingCurrency,\n    pricingModel\n  } = getPricing(vastChain);\n  const {\n    category,\n    categoryAuthority\n  } = getCategory(vastChain[0].ad);\n  const adTypeElement = getFirstChild(vastChain[0].ad);\n  const creativeElement = getLinearCreative(vastChain[0].ad);\n  const linearElement = creativeElement && get(creativeElement, 'Linear');\n  const adServingId = getSubElementValue(adTypeElement, 'AdServingId');\n  const vastVersion = getVastVersion(vastChain[0].parsedXML);\n  const advertiser = getSubElementValue(adTypeElement, 'Advertiser');\n  const adTitle = getSubElementValue(adTypeElement, 'AdTitle');\n  const description = getSubElementValue(adTypeElement, 'Description');\n  const duration = getSubElementValue(linearElement, 'Duration');\n  const durationInMs = duration && parseTime(duration);\n  let adId;\n  let adWrapperIds = [];\n  let adSystem;\n  let adWrapperSystems = [];\n  let creativeId;\n  let adWrapperCreativeIds = [];\n  let creativeAdId;\n  let adWrapperCreativeAdIds = [];\n  let clickThroughUrl;\n  let creativeData;\n  let universalAdId;\n  let universalAdIdRegistry;\n  let mediaFiles = [];\n  let vpaid;\n  let skippable;\n  let skipOffset;\n  let skipOffsetInMs;\n\n  if (isInline(vastChain[0].ad)) {\n    [\n      adId,\n      ...adWrapperIds\n    ] = adIds;\n\n    [\n      adSystem,\n      ...adWrapperSystems\n    ] = adSystems;\n\n    [\n      creativeId,\n      ...adWrapperCreativeIds\n    ] = creativeIds;\n\n    [\n      creativeAdId,\n      ...adWrapperCreativeAdIds\n    ] = creativeAdIds;\n\n    clickThroughUrl = getClickThrough(vastChain[0].ad);\n    creativeData = getCreativeData(vastChain[0].XML);\n    const universalIdElement = get(creativeElement, 'UniversalAdId');\n\n    universalAdId = getText(universalIdElement);\n    universalAdIdRegistry = getAttribute(universalIdElement, 'idRegistry');\n    mediaFiles = getMediaFiles(vastChain[0].ad);\n    vpaid = Boolean(getInteractiveFiles(vastChain[0].ad));\n    skipOffset = getAttribute(linearElement, 'skipoffset');\n    skipOffsetInMs = parseTime(skipOffset);\n    skippable = Boolean(skipOffset);\n  } else if (isWrapper(vastChain[0].ad)) {\n    adWrapperIds = adIds;\n    adWrapperSystems = adSystems;\n    adWrapperCreativeIds = creativeIds;\n    adWrapperCreativeAdIds = creativeAdIds;\n  }\n\n  return {\n    adId,\n    adServingId,\n    adSystem,\n    adTitle,\n    advertiser,\n    adWrapperCreativeAdIds,\n    adWrapperCreativeIds,\n    adWrapperIds,\n    adWrapperSystems,\n    category,\n    categoryAuthority,\n    clickThroughUrl,\n    creativeAdId,\n    creativeData,\n    creativeId,\n    description,\n    duration,\n    durationInMs,\n    mediaFiles,\n    pricing,\n    pricingCurrency,\n    pricingModel,\n    skipOffset,\n    skipOffsetInMs,\n    skippable,\n    universalAdId,\n    universalAdIdRegistry,\n    vastVersion,\n    vpaid\n  };\n};\n\nexport default getDetails;\n","/* eslint-disable filenames/match-regex */\nconst isIOS = () => /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\n\nexport default isIOS;\n"],"names":["global","undefined","Op","Object","prototype","hasOwn","hasOwnProperty","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","runtime","regeneratorRuntime","module","exports","wrap","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","IteratorPrototype","this","getProto","getPrototypeOf","NativeIteratorPrototype","values","call","Gp","GeneratorFunctionPrototype","Generator","create","GeneratorFunction","constructor","displayName","isGeneratorFunction","genFun","ctor","name","mark","setPrototypeOf","__proto__","awrap","arg","__await","defineIteratorMethods","AsyncIterator","async","innerFn","outerFn","self","tryLocsList","iter","next","then","result","done","value","toString","keys","object","key","push","reverse","length","pop","Context","reset","skipTempReset","prev","sent","_sent","delegate","method","tryEntries","forEach","resetTryEntry","charAt","isNaN","slice","stop","rootRecord","completion","type","rval","dispatchException","exception","context","handle","loc","caught","record","i","entry","tryLoc","hasCatch","hasFinally","catchLoc","finallyLoc","Error","abrupt","finallyEntry","complete","afterLoc","finish","catch","thrown","delegateYield","iterable","resultName","nextLoc","protoGenerator","generator","_invoke","state","doneResult","delegateResult","maybeInvokeDelegate","tryCatch","makeInvokeMethod","fn","obj","err","previousPromise","callInvokeWithMethodAndArg","Promise","resolve","reject","invoke","unwrapped","return","TypeError","info","pushTryEntry","locs","iteratorMethod","Function","g","hadRuntime","getOwnPropertyNames","indexOf","oldRuntime","require$$0","e","namespace","count","linearEvents","acceptInvitation","adCollapse","creativeView","nonLinearEvents","errorMessagePatterns","RegExp","extractParseError","errorNode","node","s","match","content","XMLSerializer","Array","map","childNodes","serializeToString","join","exec","doc","errorMessage","parseError","documentElement","tagName","namespaceURI","nodeName","getParseError","failOnParseError","TYPE","xmlToJson","nodeType","toLowerCase","attributes","from","attribute","nodeValue","text","replace","trim","hasChildNodes","filter","childNode","includes","elements","childObj","getChildren","get","element","childName","find","toUpperCase","getAll","childrenName","filterChildrenByName","getFirstChild","getText","firstChild","getAttributes","getAttribute","attributeName","parser","DOMParser","parseXml","xmlText","xmlDom","parseFromString","xml2js","parseTime","durationStr","durationInMs","hourStr","parseInt","minStr","secStr","parseOffset","offset","test","isPercentage","getLinearCreative","ad","adTypeElement","creativesElement","creative","getLinearTrackingEvents","eventName","creativeElement","linearElement","trackingEventsElement","trackingEventElements","trackingEvents","trackingEventElement","event","uri","filteredEvents","getNonLinearTrackingEvents","NonLinearAdsElement","formatSize","size","formatPosition","position","getIcons","linearCreativeElement","iconsElement","iconElements","iconElement","duration","height","program","pxratio","width","xPosition","yPosition","getIconAttributes","staticResourceElement","htmlResourceElement","iFrameResourceElement","staticResource","htmlResource","iFrameResource","getIconResource","iconTrackingElements","iconViewTrackingElement","getIconViewTracking","iconClicksElement","iconClickThroughElement","iconClickTrackingElements","iconClickTrackingElement","getIconClicks","getBooleanValue","val","Boolean","compareBySequence","itemA","itemB","itemASequence","itemBSequence","getAds","parsedVAST","vastElement","ads","getVastErrorURI","error","getPodAdSequence","sequence","isPodAd","hasAdPod","isArray","getFirstAd","sort","isWrapper","isInline","getVASTAdTagURI","wrapperElement","vastAdTagURIElement","getWrapperOptions","allowMultipleAds","fallbackOnNoAd","followAdditionalWrappers","opts","getAdErrorURI","getImpressionUri","impression","getMediaFiles","universalAdIdElement","universalAdId","mediaFilesElement","mediaFileElements","mediaFileElement","src","apiFramework","bitrate","codec","delivery","id","maintainAspectRatio","maxBitrate","minBitrate","scalable","getInteractiveCreativeFiles","interactiveElements","interactiveElement","getInteractiveFiles","interactiveFiles","mediaFiles","getVideoClicksElement","videoClicksElement","getClickThrough","clickThroughElement","getClickTracking","clickTrackingElements","getCustomClick","customClickElements","getSkipOffset","skipoffset","getCreativeData","xml","linearContent","getLinearContent","getAdParametersContent","getXmlEncodedValue","parsedXML","some","parseMacro","macro","upperKeysMap","data","parsedMacro","macroData","CACHEBUSTING","Math","round","random","TIMESTAMP","Date","toISOString","encodeURIComponent","pixelTracker","URLMacro","img","Image","trackError","vastChain","errorCode","tracker","errorURI","createVastEventTracker","vastChainSelector","linearTrackingEventSelector","linearTrackers","trackingURIs","clickTrackings","customClicks","iconClickTracking","iconViewTracking","progressUri","trackingEventSelector","loadScript","defer","placeholder","script","document","createElement","scriptPlaceholder","onerror","URIError","onload","currentScript","parentNode","head","appendChild","createAdVideoElement","video","style","createAdContainer","adContainer","classList","add","getContentDocument","iframeElement","contentDocument","contentWindow","supported","createBaseIframe","iframe","sandbox","margin","padding","border","createIframe","location","targetOrigin","iframeContent","window","origin","protocol","hostname","port","write","removeChild","srcdoc","addEventListener","handleMessage","removeEventListener","nextId","hidden","VideoAdContainer","videoElement","Element","executionContext","isOriginalVideoElement","options","isDestroyed","body","destroyed","createVideoAdContainer","canPlay","mediaFile","canPlayType","ext","guessMimeType","findBestMedia","inlineAd","container","screenRect","getBoundingClientRect","screenWidth","mediaFileA","mediaFileB","abs","sortMediaByBestFit","once","listener","handler","progress","safeCallback","callback","logger","fullscreen","exitFullscreen","playerCollapse","playerExpand","pause","resume","rewind","skip","createDefaultSkipControl","skipBtn","innerHTML","bottom","right","volumeChanged","adProgress","firstQuartile","midpoint","start","thirdQuartile","percentageProgress","currentTime","isCompleted","mute","unmute","isMuted","muted","volume","toFixedDigits","num","digits","formattedNum","String","secondsToMilliseconds","seconds","isValid","offsetIsValid","parseFloat","uriIsValid","offsetToMs","clickThrough","handlers","clickThroughUrl","anchor","left","top","href","target","onclick","Event","stopPropagation","paused","play","errorHandler","fullscreenEvtNames","fullscreenOn","fullscreenchangeHandler","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","impressionHandler","started","playHandler","pauseHandler","progressEvents","playedMs","previousCurrentTime","pendingEvents","progressHandler","delta","reduce","accumulator","toCall","stillPending","hours","minutes","ms","floor","timeupdateHandler","videoAdContainer","createSkipControl","skipControl","skipHandler","currentTimeMs","passFirstQuartile","passMidPoint","passThirdQuartile","completed","isPassThirdQuartile","isPassMidPoint","isPassFirstQuartile","endedHandler","wasMuted","volumechangeHandler","setupMetricHandlers","hooks","accumulated","events","getProgressEvents","stopHandlersFns","metricHandlers","disconnect","updateMedia","media","playing","load","FUNC_ERROR_TEXT","NAN","symbolTag","reTrim","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","freeGlobal","freeSelf","root","objectToString","nativeMax","max","nativeMin","min","now","isObject","toNumber","isObjectLike","isSymbol","other","valueOf","isBinary","func","wait","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","invokeFunc","time","args","thisArg","apply","shouldInvoke","timeSinceLastCall","timerExpired","trailingEdge","setTimeout","remainingWait","debounced","isInvoking","arguments","leadingEdge","cancel","clearTimeout","flush","MutationObserver","WebKitMutationObserver","MozMutationObserver","noop","sizeMutationAttrs","mutationHandlers","observerKey","onMutation","observer","mutations","index","observe","createResizeMO","resizeHandlers","resizeObject","onResize","setAttribute","createResizeObjElement","getComputedStyle","onElementResize","threshold","makeSizeId","clientHeight","clientWidth","lastSize","checkElementHandler","debounce","currentSize","stopObservingMutations","stopListeningToResize","elementEntries","checkIsVisible","lastInViewport","isInViewport","viewabilityOffsetFraction","verticalOffset","horizontalOffset","viewportHeight","innerHeight","viewportWidth","innerWidth","isElementVisible","viewportOffset","checkVisibility","onElementVisibilityChange","scrollableElement","viewabilityOffset","viewportEventHandler","elementEntry","every","preventManualProgress","previousTime","skipAttempts","preventAdSkip","preventAdSeek","Emitter","evts","console","evtListeners","eListener","_","removeListener","on","hasListeners","stack","getResource","chooseByPxRatio","icons","devicePixelRatio","iconA","iconB","sortIconByBestPxratio","retrieveIcons","byProgram","icon","groupIconsByProgram","chooseIcons","uniqValue","seen","item","uniqByResource","Deferred","promise","waitFor","pending","cancelOnce","fetch","support","searchParams","blob","Blob","formData","arrayBuffer","viewClasses","isDataView","DataView","isPrototypeOf","isArrayBufferView","ArrayBuffer","isView","Headers","append","normalizeName","normalizeValue","oldValue","has","set","items","iteratorFor","entries","methods","Request","clone","_bodyInit","Body","Response","status","statusText","headers","url","response","redirectStatuses","redirect","RangeError","input","init","request","xhr","XMLHttpRequest","rawHeaders","getAllResponseHeaders","split","line","parts","shift","responseURL","responseText","ontimeout","open","credentials","withCredentials","responseType","setRequestHeader","send","polyfill","header","consumed","bodyUsed","fileReaderReady","reader","readBlobAsArrayBuffer","FileReader","readAsArrayBuffer","bufferClone","buf","view","Uint8Array","byteLength","buffer","_initBody","_bodyText","_bodyBlob","FormData","_bodyFormData","URLSearchParams","_bodyArrayBuffer","rejected","readAsText","chars","fromCharCode","readArrayBufferAsText","decode","json","JSON","parse","upcased","mode","referrer","form","bytes","decodeURIComponent","bodyInit","ok","isValidContentType","contentType","normalisedCT","allowedType","fetchHtml","endpoint","createResource","createStaticResource","divElement","html","dispatchEvent","CustomEvent","createHtmlResource","frameBorder","createIframeResource","loadResource","resourceElement","resourceErrorWait","resourceLoadWait","cleanUp","contains","zIndex","updateIcon","dynamicPos","iconHeight","phHeight","drawnIcons","oldSignature","signature","rect","phRect","isCustomXposition","dIcon","iconWidth","phWidth","drawnIconsWidth","calculateIconLeft","isCustomYPosition","assign","calculateArea","withoutOverlaps","newIcon","drawnIcon","overlap","canBeRendered","config","thereIsSpace","placeholderArea","hasSpace","isWithinTheContentArea","withinBoundaries","doesNotOverlap","wrapWithClickThrough","onIconClick","iconClickthrough","pointerEvents","createIcon","iconResource","updateIconElement","renderIcon","updatedIcon","updated","renderIcons","currentTimeInMs","videoDurationInMs","canBeShown","otherIcons","iconsToShow","renderedIcon","log","firstRenderPending","addIcons","onIconView","rest","drawIcons","iconsPendingToRedraw","iconsPendingToBeRemoved","hasPendingIconRedraws","removeDrawnIcons","viewmode","iconClick","iconView","_protected","VideoAdUnit","viewability","responsive","finished","onFinishCallbacks","emit","_this","isFinished","removeIcons","unsubscribe","visible","prevSize","resize","throwIfCalled","onErrorCallbacks","isStarted","errorEvt","_private","VastAdUnit","code","assetUri","handleMetric","removeMetricHandlers","throwIfFinished","_this2","adUnitError","SUPPORTED_MIMETYPES","isSupported","mimetype","loadCreative","addScript","getVPAIDAd","adStarted","adStopped","adSkipped","adDurationChange","adRemainingTimeChange","adVolumeChange","adImpression","adVideoStart","adVideoFirstQuartile","adVideoMidpoint","adVideoThirdQuartile","adVideoComplete","adClickThru","adUserAcceptInvitation","adUserMinimize","adUserClose","adPaused","adPlaying","adError","creativeAd","timeout","timeoutId","subscribe","callAndWait","waitPromise","major","version","handshake","supportedVersion","creativeVersion","creativeMajorNum","createSlot","slot","closeLinear","VPAID_EVENTS","vpaidGeneralError","payload","VpaidAdUnit","playerHandles","videoStart","handleVpaidEvt","getVolume","evtHandler","loadCreativePromise","bind","creativeEvt","environmentVars","creativeData","XML","initAd","adLoadedPromise","setVolume","adStoppedPromise","remainingTime","createVideoAdUnit","adUnit","linearEvent","evtType","linearTracker","nonLinearEvent","validate","hasVastCreative","startAdUnit","onAdReady","createRejectHandler","onError","tryToStartVpaidAd","startVastAd","startVideoAd","run","race","newAdUnit","timedOut","timeoutPromise","adUnitPromise","onFinish","destroy","defaults","fetchOptions","errorWithCors","requested","markAdAsRequested","validateChain","wrapperLimit","fetchAdXML","adTag","parseVastXml","getAd","validateResponse","getOptions","parentAd","wrapperOptions","requestAd","rawXml","VASTAdResponse","fetchPromise","epoch","Number","isInteger","_context2","getNextAd","useAdBuffet","availableAds","adDefinition","nextAd","currentPod","nextPodSequence","getNextPod","requestNextAd","VastChain","vastResponse","newVastChain","validateVastChain","lastVastResponse","vpaidEnabled","isVpaid","validateVastResponse","callbackHandler","cb","getErrorCode","transformVastResponse","waterfall","fetchVastChain","isCanceled","onAdStart","onRunFinish","runEpoch","newEpoch","getSubElementValue","parentElement","getPricing","pricingElement","getPricingElement","inLineElement","categoryElement","parsedVast","adIds","adSystems","getAdSystem","creatives","creativeIds","creativeAdIds","pricing","pricingCurrency","pricingModel","category","categoryAuthority","adServingId","vastVersion","advertiser","adTitle","description","adId","adWrapperIds","adSystem","adWrapperSystems","creativeId","adWrapperCreativeIds","creativeAdId","adWrapperCreativeAdIds","universalAdIdRegistry","vpaid","skippable","skipOffset","skipOffsetInMs","universalIdElement","canceled","onAdStartHandler","navigator","userAgent","MSStream"],"mappings":"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"}